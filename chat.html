<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Gemini Multi-View</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #94a3b8;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes typingDots {
            0%, 20% { content: "."; }
            40% { content: ".."; }
            60%, 100% { content: "..."; }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .message-enter {
            animation: fadeIn 0.3s ease-out;
        }

        .typing-indicator::after {
            content: "...";
            animation: typingDots 1.5s infinite;
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        .chat-container {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .message-bubble {
            border-radius: 1.125rem 1.125rem 1.125rem 0;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
            transition: all 0.3s ease;
        }

        .message-bubble.user {
            border-radius: 1.125rem 1.125rem 0 1.125rem;
        }

        .message-bubble:hover {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15));
        }

        .input-field {
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
        }

        .input-field:focus {
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
        }

        .send-button {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .send-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .send-button:active {
            transform: translateY(0);
        }

        .modal-content {
            animation: fadeIn 0.3s ease-out;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            background-color: var(--primary);
        }

        .bot-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--secondary);
            color: white;
        }

        .markdown-content p {
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .markdown-content ul, .markdown-content ol {
            margin-left: 1.25rem;
            margin-bottom: 0.75rem;
        }

        .markdown-content li {
            margin-bottom: 0.25rem;
        }

        .markdown-content code {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--danger);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9em;
        }

        .markdown-content pre {
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 0.375rem;
            padding: 0.75rem;
            overflow-x: auto;
            margin-bottom: 0.75rem;
        }

        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }

        .markdown-content a {
            color: var(--primary);
            text-decoration: underline;
        }

        .markdown-content a:hover {
            color: var(--primary-dark);
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @media (max-width: 640px) {
            .mobile-flex-col {
                flex-direction: column;
            }
            
            .mobile-w-full {
                width: 100% !important;
            }
            
            .mobile-mt-2 {
                margin-top: 0.5rem;
            }
        }
        @media (max-width: 768px) {
            .messages-container {
                width: 100%;
                max-width: 100%;
                padding: 10px;
                margin: 0 auto;
                box-sizing: border-box;
            }

            .message-bubble {
                margin: 8px 0;
                padding: 12px 15px;
                font-size: 16px;
                line-height: 1.5;
                background-color: #f5f5f5;
                border-radius: 10px;
                word-wrap: break-word;
            }

            .message-header,
            .message-footer {
                display: none;
            }

            #chat-messages {
                padding: 10px !important;
            }

            .user-avatar,
            .bot-avatar {
                width: 28px;
                height: 28px;
                font-size: 0.875rem;
            }

            .mobile-flex-col {
                flex-direction: column !important;
            }
            

            .mobile-w-full {
                width: 100% !important;
            }
        }

        /* Adicione estes estilos para controlar o menu móvel */
        @media (max-width: 768px) {
            .controls-container {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                padding: 10px;
                border-top: 1px solid #e5e7eb;
                transform: translateY(100%);
                transition: transform 0.3s ease-in-out;
                z-index: 40;
                box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            }

            .controls-container.active {
                transform: translateY(0);
            }

            .toggle-controls {
                position: fixed;
                bottom: 70px;
                right: 20px;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: var(--primary);
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 41;
                transition: transform 0.3s ease;
            }

            .toggle-controls.active {
                transform: rotate(180deg);
            }

            /* Ajuste o espaçamento do container de mensagens */
            .chat-container {
                padding-bottom: 70px;
            }
        }

        @media (max-width: 768px) {
            /* Ajusta o container principal para considerar o teclado móvel */
            .chat-container {
                height: calc(100vh - 80px);
                padding-bottom: 60px; /* Espaço para o form fixo */
            }

            /* Form de input fixo na parte inferior */
            .message-form-container {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: #f9fafb;
                padding: 10px;
                border-top: 1px solid #e5e7eb;
                z-index: 40;
            }

            /* Status e contagem de mensagens */
            .message-info {
                position: fixed;
                top: 80px; /* Logo abaixo do header */
                left: 0;
                right: 0;
                background: rgba(249, 250, 251, 0.95);
                padding: 5px 10px;
                font-size: 0.75rem;
                border-bottom: 1px solid #e5e7eb;
                z-index: 39; /* Abaixo do botão toggle mas acima do conteúdo */
            }

            /* Botão toggle reposicionado para abaixo do header */
            .toggle-controls {
                position: fixed;
                top: 80px; /* Ajustado para ficar abaixo do header */
                right: 15px;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: var(--primary);
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                z-index: 41;
                transition: transform 0.3s ease;
            }

            /* Ajusta o padding do conteúdo */
            .controls-container {
                padding-top: 40px; /* Reduzido para compensar nova posição do botão */
            }

            /* Ajusta margem superior do container de mensagens */
            .chat-container {
                margin-top: 30px; /* Espaço para a message-info */
            }

            /* Garante que o header não seja sobreposto */
            header {
                z-index: 42;
            }
        }

        .loading-indicator {
            text-align: center;
            padding: 10px;
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans antialiased">

<!-- Welcome Modal -->
<div id="welcome-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="modal-content bg-white rounded-xl p-6 max-w-md w-full mx-4 transform transition-all">
        <div class="flex justify-center mb-4">
            <div class="gradient-bg text-white p-3 rounded-full animate-float">
                <i class="fas fa-robot text-2xl"></i>
            </div>
        </div>
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">Bem-vindo ao Chat Gemini!</h2>
        <p class="text-gray-600 text-center mb-4">Escolha um nome de usuário para começar</p>
        
        <div class="mb-4">
            <input type="text" id="username-input" placeholder="Seu nome de usuário" 
                   class="username-input input-field w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <p id="username-error" class="text-sm text-red-500 mt-2 h-4"></p>
        </div>
        
        <button id="save-username-btn" class="w-full gradient-bg text-white px-4 py-3 rounded-lg font-semibold transition-all hover:opacity-90 active:scale-95">
            <i class="fas fa-sign-in-alt mr-2"></i> Entrar no Chat
        </button>
        
        <p class="text-xs text-gray-500 mt-4 text-center">Seu nome será visível para outros usuários</p>
    </div>
</div>

<!-- Main Chat Container -->
<div class="container mx-auto max-w-4xl h-screen flex flex-col p-2 sm:p-4">
    <!-- Header -->
    <header class="gradient-bg text-white rounded-xl shadow-md p-3 mb-3 sm:mb-4 flex items-center justify-between">
        <div class="flex items-center space-x-3">
            <div class="bot-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div>
                <h1 class="text-lg sm:text-xl font-bold">Chat Gemini</h1>
                <p class="text-xs opacity-80">Conecte-se e converse com IA</p>
            </div>
        </div>
        
        <div class="flex items-center space-x-3">
            <div id="user-info" class="flex items-center space-x-2">
                <div id="user-avatar" class="user-avatar hidden"></div>
                <div class="hidden sm:block">
                    <span id="username-display" class="text-sm font-medium">...</span>
                    <span class="text-xs opacity-70 block">ID: <span id="device-id-display">...</span></span>
                </div>
            </div>
            
            <div id="user-status" class="flex items-center space-x-1 bg-white bg-opacity-20 px-2 py-1 rounded-full">
                <span id="status-indicator" class="h-2 w-2 rounded-full bg-gray-300"></span>
                <span id="status-text" class="text-xs">Offline</span>
            </div>
        </div>
    </header>

    <!-- Botão toggle para controles móveis -->
    <button class="toggle-controls hidden md:hidden">
        <i class="fas fa-cog"></i>
    </button>

    <!-- Wrap os controles existentes em um container -->
    <div class="controls-container">
        <!-- Controls -->
        <div class="mb-3 sm:mb-4 bg-white rounded-xl shadow-sm p-3 flex flex-col md:flex-row gap-4 mobile-flex-col">
            <div class="w-full md:w-auto mobile-w-full">
                <label for="model-select" class="block text-sm font-medium text-gray-700 mb-1">Modelo de IA:</label>
                <select id="model-select" class="block w-full pl-3 pr-10 py-2 text-sm border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent input-field">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            
            <div class="flex-grow mobile-w-full">
                <label class="block text-sm font-medium text-gray-700 mb-1">Visualização:</label>
                <div class="flex flex-wrap gap-2 items-center mobile-flex-col mobile-items-stretch">
                    <button id="btn-general-chat" class="chat-view-button chat-view-button-active px-4 py-2 rounded-lg text-sm font-medium transition-all">
                        <i class="fas fa-users mr-2"></i> Geral
                    </button>
                    <button id="btn-my-chat" class="chat-view-button px-4 py-2 rounded-lg text-sm font-medium transition-all">
                        <i class="fas fa-user mr-2"></i> Meu Chat
                    </button>
                    <div class="flex items-center gap-2 flex-grow mobile-w-full mobile-mt-2">
                        <input type="text" id="user-search-input" placeholder="Buscar usuário..." 
                               class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500 input-field">
                        <button id="btn-other-chat" class="chat-view-button px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap">
                            <i class="fas fa-search mr-2"></i> Buscar
                        </button>
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-2" id="current-chat-info">Visualizando: Chat Geral</p>
            </div>
        </div>
    </div>

    <!-- Chat Messages -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden flex flex-col flex-grow min-h-0 chat-container">
        <div id="chat-messages" class="p-3 sm:p-4 space-y-4 overflow-y-auto flex-grow min-h-0 scrollbar-hide">
            <div class="loading-indicator">
                <div class="typing-dots flex space-x-1 justify-center">
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 150ms"></div>
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 300ms"></div>
                </div>
                <span class="text-sm text-gray-500">Carregando mensagens antigas...</span>
            </div>
            <div class="text-center text-gray-500 py-10 initial-message">
                <div class="gradient-bg text-white p-4 rounded-full inline-block mb-3 animate-float">
                    <i class="fas fa-comments text-2xl"></i>
                </div>
                <p class="text-sm sm:text-base font-medium">Carregando conversas...</p>
                <p class="text-xs mt-2">Aguarde enquanto carregamos as mensagens</p>
            </div>
        </div>
        
        <div id="typing-indicator" class="hidden bg-gray-50 px-4 py-3 text-gray-500 text-sm flex items-center">
            <div class="typing-dots flex space-x-1 mr-3">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0ms"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 150ms"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 300ms"></div>
            </div>
            <span class="typing-indicator">Gemini está digitando</span>
        </div>
        
        <div class="message-form-container">
            <form id="message-form" class="flex space-x-2">
                <input id="message-input" type="text" placeholder="Digite sua mensagem..." 
                       class="flex-1 px-4 py-3 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base input-field" 
                       autocomplete="off" disabled>
                <button type="submit" aria-label="Enviar mensagem" 
                        class="gradient-bg text-white px-4 py-3 rounded-full transition-all send-button flex items-center justify-center" disabled>
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
            <div class="message-info flex justify-between items-center mt-2">
                <span id="connection-status" class="text-xs text-gray-500 flex items-center">
                    <i class="fas fa-circle mr-1 text-gray-400"></i> Conectando...
                </span>
                <span id="message-count" class="text-xs text-gray-500">0 mensagens</span>
            </div>
        </div>
    </div>
</div>

<script type="module">
    const _0x2198df=_0x22b1;(function(_0x3261ef,_0xf8ef54){const _0xa70c56=_0x22b1,_0x1772ca=_0x3261ef();while(!![]){try{const _0x364e10=-parseInt(_0xa70c56(0x1ed))/0x1*(parseInt(_0xa70c56(0x199))/0x2)+parseInt(_0xa70c56(0x19e))/0x3*(parseInt(_0xa70c56(0x149))/0x4)+parseInt(_0xa70c56(0xb4))/0x5*(-parseInt(_0xa70c56(0xda))/0x6)+-parseInt(_0xa70c56(0x1d5))/0x7*(-parseInt(_0xa70c56(0x141))/0x8)+-parseInt(_0xa70c56(0x1ff))/0x9*(-parseInt(_0xa70c56(0xed))/0xa)+-parseInt(_0xa70c56(0x1f5))/0xb+parseInt(_0xa70c56(0x138))/0xc;if(_0x364e10===_0xf8ef54)break;else _0x1772ca['push'](_0x1772ca['shift']());}catch(_0x6bf3ce){_0x1772ca['push'](_0x1772ca['shift']());}}}(_0x3378,0x61f34));const _0x32b417=_0x292f;(function(_0x35025d,_0xce263c){const _0x156289=_0x22b1,_0x4cba0f=_0x292f,_0x22f15f=_0x35025d();while(!![]){try{const _0x241fb1=parseInt(_0x4cba0f(0x26a))/0x1+-parseInt(_0x4cba0f(0x13c))/0x2+-parseInt(_0x4cba0f(0x1ba))/0x3+-parseInt(_0x4cba0f(0x265))/0x4+-parseInt(_0x4cba0f(0x10f))/0x5*(-parseInt(_0x4cba0f(0x12a))/0x6)+parseInt(_0x4cba0f(0x1a7))/0x7*(-parseInt(_0x4cba0f(0x1a1))/0x8)+parseInt(_0x4cba0f(0x180))/0x9;if(_0x241fb1===_0xce263c)break;else _0x22f15f['push'](_0x22f15f[_0x156289(0x162)]());}catch(_0x40d0b4){_0x22f15f[_0x156289(0x17a)](_0x22f15f[_0x156289(0x162)]());}}}(_0x3db1,0x226b2));import{GoogleGenerativeAI}from'https://esm.run/@google/generative-ai';function _0x3378(){const _0x2d76a4=['text-indigo-200','154191KFPFMc','Falha\x20ao\x20inicializar\x20chat\x20(','</code></pre>','Chat\x20de\x20','key','flex','não\x20foi\x20possível\x20processar','Erro\x20ao\x20verificar\x20existência\x20do\x20usuário\x20','\x20px-4\x20py-3\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20mb-1\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-slash\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Usuário\x20não\x20existe.</p></div>','Mensagem\x20inválida\x20ou\x20sem\x20timestamp\x20encontrada\x20no\x20histórico:','bg-red-500','Buscando\x20usuário:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22','<p>','Erro\x20ao\x20atualizar\x20status\x20de\x20atividade:','style','toLowerCase','charAt','Não\x20foi\x20possível\x20identificar\x20o\x20usuário\x20\x27','Nenhum\x20nome\x20de\x20usuário\x20local\x20encontrado.\x20Mostrando\x20modal.','<em>$1</em>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Erro\x20ao\x20carregar\x20mais\x20mensagens:','trim','AIzaSyDF5wOFJPEuhrlD9s0m1ZjYLg-IIPWsCRg','text-gray-700','forEach','isError','text-blue-600','Falha\x20(','timestamp','test',')\x20inicializado\x20com\x20','join',',\x20Nome=','75198mWUebd','Digite\x20um\x20nome\x20ou\x20ID\x20de\x20usuário\x20para\x20buscar.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20','firstChild','animate-pulse','own','insertBefore','remove','users/','Resposta\x20recebida\x20de\x20Gemini\x20(','div','focus','success','Este\x20nome\x20já\x20está\x20em\x20uso!','scrollHeight','ID\x20\x27','2371272iIASCg','selected','scrollTop','disabled','\x27\x20(encontrado\x20ou\x20digitado)\x20não\x20existe\x20no\x20nó\x20/users.','btn-other-chat','</p></div>','Erro:\x20ID\x20do\x20dispositivo\x20não\x20definido.','<strong>$1</strong>','8pOVgos','Você\x20não\x20pode\x20enviar\x20mensagens\x20no\x20chat\x20de\x20outro\x20usuário.','Erro\x20ao\x20verificar/salvar\x20nome\x20de\x20usuário:','gaamini-teste-api.firebaseapp.com','justify-end','sendMessage','userDeviceId','preventDefault','104252OcfJyC','Inicializando\x20chat\x20(','Erro\x20interno\x20ao\x20salvar\x20a\x20resposta.','<i\x20class=\x22fas\x20fa-sign-in-alt\x20mr-2\x22></i>\x20Entrar\x20no\x20Chat','404','<br>','connection-status','...\x27\x20não\x20encontrado\x20no\x20banco\x20de\x20dados.','<code>','Erro\x20interno\x20ao\x20preparar\x20para\x20salvar\x20resposta.','toUpperCase','typing-indicator','appendChild','Objeto\x20\x27chat\x27\x20não\x20inicializado\x20em\x20getGeminiResponse.','Gemini\x201.5\x20Flash','&#039;','generalChat/','message-input','Erro\x20ao\x20enviar\x20sua\x20mensagem.\x20Verifique\x20sua\x20conexão\x20e\x20tente\x20novamente.','add','Erro\x20crítico:\x20','__CB_','Inicializando\x20chat...','response','includes','shift','message','warn','Quota','Não\x20é\x20possível\x20enviar\x20mensagens\x20nesta\x20visualização.','Desconectado\x20do\x20Firebase...','pronto','DOMContentLoaded','<div\x20class=\x22user-avatar\x22>','general','limitToLast','Nome\x20de\x20usuário\x20\x27','startChat','):\x20Chave\x20da\x20API\x20Gemini\x20inválida\x20ou\x20expirada.\x20Verifique\x20a\x20chave\x20no\x20código.','random','log','ServerValue','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x20mr-2\x22></i>\x20Verificando...','update','API\x20key\x20not\x20valid','&quot;','.chat-view-button','classList','2-digit','push','length','split','addEventListener','exclamation-circle','user-','AIzaSyBL7oI8tr3rseMyQW6ouPVwbfZKGUfwJ1s','g1.5-','gemini-1.5-','RESOURCE_EXHAUSTED','Mensagem\x20bloqueada\x20por\x20','Listener\x20Firebase\x20anexado\x20em\x20','message-enter','Esse\x20nome\x20não\x20é\x20permitido.','Nova\x20mensagem\x20recebida\x20via\x20listener\x20(','.\x20Verifique\x20sua\x20conexão.','#message-form\x20button[type=\x22submit\x22]','startsWith','Por\x20favor,\x20insira\x20um\x20nome\x20de\x20usuário\x20ou\x20ID\x20para\x20buscar.','Não\x20foi\x20possível\x20determinar\x20o\x20caminho\x20para\x20salvar\x20a\x20resposta\x20do\x20Gemini.','Termo\x20\x27','gemini-','setItem','<ol>','\x27\x20parece\x20ser\x20um\x20ID.\x20Verificando\x20existência...','Erro\x20(','Enviando\x20para\x20Gemini\x20(','target','message-count','model','permission_denied','2LtTNzC','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-clock\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Por\x20favor,\x20defina\x20seu\x20nome\x20de\x20usuário\x20primeiro.</p></div>','number','Histórico\x20inicial\x20carregado\x20para\x20','Usuário\x20com\x20ID\x20\x27','39gkdSyg','</div>','current-chat-info','SDK\x20Gemini\x20não\x20inicializado.','Mensagem\x20do\x20usuário\x20(','ref','\x20mensagens\x20no\x20histórico.','btn-my-chat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble\x20user\x20','Erro\x20ao\x20inicializar\x20Firebase:','Novo\x20ID\x20de\x20dispositivo\x20criado:','400','button[type=\x22submit\x22]','info-circle','getFullYear','Digite\x20sua\x20mensagem...','973104hcWcZr','justify-center','opacity\x200.5s\x20ease-out','Listener\x20recebeu\x20snapshot\x20nulo:','Listener:','Definida\x20nova\x20referência\x20Firebase\x20para:\x20','Erro\x20ao\x20inicializar\x20Gemini\x20Chat\x20(','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x22><p>Erro\x20ao\x20carregar\x20dados!\x20Verifique\x20as\x20permissões\x20ou\x20o\x20console\x20para\x20detalhes.</p></div>','\x20do\x20usuário\x20','Erro\x20interno:\x20ID\x20do\x20modelo\x20não\x20especificado.','\x27\x20encontrado.\x20ID:\x20','):\x20Requisição\x20inválida\x20(400).\x20Pode\x20ser\x20um\x20problema\x20no\x20histórico\x20ou\x20configuração.','scroll','\x27\x20definido\x20e\x20salvo.','getElementById','Erro\x20de\x20Permissão\x20ao\x20acessar\x20','Erro\x20ao\x20processar\x20sua\x20mensagem\x20com\x20','toggle','user-search-input','my-2','Erro\x20grave\x20ao\x20carregar\x20o\x20histórico\x20do\x20chat.','Enter','Erro:\x20O\x20objeto\x20de\x20chat\x20não\x20está\x20inicializado.','message-form','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Salvando/Atualizando\x20usuário\x20no\x20Firebase:\x20ID=','status-text','Iniciando\x20atualizações\x20de\x20status\x20de\x20atividade','Erro\x20crítico:\x20ID\x20do\x20modelo\x20inválido\x20após\x20sanitização.','O\x20chat\x20não\x20pôde\x20ser\x20iniciado\x20corretamente.\x20O\x20envio\x20de\x20mensagens\x20está\x20deshabilitado.','innerHTML','initializeApp','Meu','username','fetch','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Carregando\x20mensagens...</p></div>','Reconectado\x20ao\x20Firebase.','&amp;','string','2797438AAUYqx','\x20rounded-xl\x20px-4\x20py-2\x20max-w-[90%]\x20sm:max-w-md\x20lg:max-w-lg\x20text-sm\x20text-center\x20system-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','1080485760423','gaamini-teste-api.appspot.com','contains','toString','</code>','child_added','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x22><p>','name','-latest','Resposta\x20do\x20Gemini\x20salva\x20no\x20Firebase:','getMonth','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-search\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Digite\x20um\x20nome\x20ou\x20ID\x20acima\x20para\x20ver\x20o\x20chat.</p></div>','userChats/','Erro\x20crítico:\x20SDK\x20Gemini\x20não\x20disponível.','.info/connected','Aguardando\x20configuração\x20inicial\x20do\x20usuário\x20antes\x20de\x20carregar\x20o\x20chat.','status-indicator','replace','Erro\x20CRÍTICO\x20ao\x20carregar\x20histórico\x20ou\x20anexar\x20listener\x20para\x20','Erro\x20formatar\x20hora:','\x27\x20não\x20encontrado.\x20Verifique\x20o\x20nome\x20ou\x20ID.','274900YCFILn','<li>','getTime','gradient-bg','info','hidden','keypress','.\x20A\x20funcionalidade\x20de\x20IA\x20pode\x20não\x20funcionar.','7475633OZjxqC','cursor-not-allowed','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','once','...','keys','bg-red-100\x20text-red-800','filter','.\x20Verifique\x20as\x20Regras\x20de\x20Segurança\x20do\x20Firebase\x20Database.','Erro\x20desconhecido\x20na\x20API\x20Gemini.','6437493vOjmGJ','Erro\x20crítico:\x20SDK\x20Gemini\x20não\x20disponível\x20para\x20enviar\x20mensagem.','bloqueado','\x27\x20não\x20encontrado.</p></div>','Tentativa\x20de\x20chamar\x20getGeminiResponse\x20em\x20view\x20inválida:','map','Modal\x20de\x20boas-vindas\x20não\x20encontrado\x20no\x20DOM.','):\x20','528IhdBCL','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-slash\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Usuário\x20\x27','device-id-display','bg-gray-100','bg-blue-100\x20text-blue-900','sistema','text-white','Dados\x20do\x20usuário\x20salvos\x20no\x20Firebase\x20com\x20sucesso.','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','placeholder','...</span>','chat-messages','username-display','Mensagem\x20com\x20texto\x20vazio\x20encontrada\x20no\x20histórico,\x20pulando\x20para\x20Gemini:','querySelector','<i\x20class=\x22fas\x20fa-circle\x20mr-1\x20text-red-500\x22></i>\x20Desconectado','gaamini-teste-api','bg-green-500','getGenerativeModel','Erro\x20ao\x20comunicar\x20com\x20Gemini\x20ou\x20salvar\x20resposta\x20(','substring','Erro\x20de\x20rede\x20ao\x20tentar\x20contatar\x20','Status\x20Conexão\x20Firebase:',',\x20view:\x20','textContent','Erro\x20crítico:\x20Não\x20foi\x20possível\x20conectar\x20ao\x20Firebase.','set','createElement','15ekzHZJ','\x27\x20não\x20encontrado\x20no\x20índice.','\x27,\x20Target=\x27','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-comments\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Nenhuma\x20mensagem\x20neste\x20chat\x20ainda.</p></div>','database','opacity-50','other','click','146841BxRuQV','val','&lt;','erro','check-circle','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-question-circle\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Não\x20foi\x20possível\x20encontrar\x20o\x20usuário.</p></div>','Interface\x20inicializada.','Geral','Meu\x20Chat\x20Pessoal','msg-','transition',')\x20pronto.','Inicializando\x20chat','user','Inicialização\x20do\x20Gemini\x20falhou\x20ou\x20referência\x20Firebase\x20inválida.\x20Listener\x20não\x20anexado.','Mensagem\x20de\x20erro\x20do\x20Gemini\x20salva\x20no\x20Firebase:','model-select','sender','Iniciando\x20modelo:\x20','\x20mensagens\x20(','Aguardando\x20resposta\x20do\x20Gemini...','value','\x20Detalhes:\x20','DOM\x20Carregado.\x20Iniciando\x20aplicação...','Online','chat-view-button-active','AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXX','Usuário\x20\x27','getItem','error','591258RZmQWl','Usuário','toISOString','Erro\x20ao\x20inicializar\x20SDK\x20Gemini:','Erro:\x20O\x20chat\x20não\x20está\x20pronto\x20para\x20receber\x20mensagens.','\x20mr-2\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','Erro\x20ao\x20verificar\x20usuário.\x20Tente\x20novamente.','\x20começando\x20em\x20','<pre><code>','gradient-bg\x20text-white','Liberando\x20nome\x20inativo\x20','Desanexando\x20listener\x20Firebase\x20anterior\x20da\x20Ref:','now','quota','\x20mensagens.','username-input','toLocaleTimeString','active','Carregando\x20ou\x20indisponível...','10LvLvdS','Não\x20foi\x20possível\x20determinar\x20o\x20caminho\x20del\x20chat\x20no\x20Firebase.','promptFeedback','\x20devido\x20a:\x20','match','):\x20Cota\x20da\x20API\x20excedida.\x20Não\x20é\x20possível\x20processar\x20mais\x20mensagens\x20no\x20momento.','change','\x20-\x20','username-error','Network\x20Error','Não\x20há\x20mais\x20mensagens\x20para\x20carregar','2819691RIMmSt','orderByChild','Chat','Erro\x20ao\x20buscar\x20username\x20no\x20Firebase:','exists','Offline','btn-general-chat','184sUGqfK','text','Desconhecido','Visualizando\x20chat\x20para\x20ID:\x20'];_0x3378=function(){return _0x2d76a4;};return _0x3378();}const firebaseConfig={'apiKey':_0x2198df(0x180),'authDomain':_0x32b417(0x276),'projectId':_0x32b417(0x223),'storageBucket':_0x2198df(0x1d9),'messagingSenderId':_0x32b417(0x221),'appId':_0x32b417(0x215),'measurementId':_0x32b417(0x115)},GEMINI_API_KEY=_0x32b417(0x190),AVAILABLE_MODELS=[{'id':'gemini-1.5-flash-latest','name':_0x2198df(0x157)}];let currentModelId=AVAILABLE_MODELS[0x0]['id'],currentChatView=_0x2198df(0x16b),targetChatId=null,USER_DEVICE_ID=null,USERNAME=null,genAI,chat=null,currentFirebaseListener=null,currentMessagesRef=null,isGeminiTyping=![],messageCounter=0x0,initialLoadComplete=![],isLoadingMore=![],firstMessageTimestamp=null;const MESSAGES_PER_PAGE=0x32;try{firebase[_0x32b417(0x1f1)](firebaseConfig);}catch(_0x34ce73){console[_0x32b417(0x238)](_0x32b417(0x267),_0x34ce73),alert(_0x32b417(0x194));}const database=firebase[_0x32b417(0x1fb)](),connectedRef=database[_0x32b417(0x1b0)](_0x2198df(0x1e6));try{if(!GEMINI_API_KEY||GEMINI_API_KEY===_0x32b417(0x20e))throw new Error(_0x32b417(0x25f));genAI=new GoogleGenerativeAI(GEMINI_API_KEY);}catch(_0x2f1b33){console[_0x32b417(0x238)](_0x32b417(0x21d),_0x2f1b33),alert(_0x32b417(0x119)+_0x2f1b33[_0x32b417(0x1e7)]+_0x32b417(0x121)),document['getElementById'](_0x32b417(0x117))['disabled']=!![],document[_0x32b417(0x1ea)](_0x2198df(0x18a))[_0x32b417(0x1c5)]=!![];}const messageForm=document['getElementById'](_0x2198df(0x1c5)),messageInput=document[_0x32b417(0x235)](_0x32b417(0x117)),messageSubmitButton=messageForm[_0x32b417(0x1ea)](_0x32b417(0x1bc)),chatMessages=document[_0x2198df(0x1bc)](_0x32b417(0x1d4)),typingIndicator=document[_0x32b417(0x235)](_0x32b417(0x16e)),statusIndicator=document[_0x32b417(0x235)](_0x32b417(0x19c)),statusText=document[_0x32b417(0x235)](_0x32b417(0x19e)),connectionStatus=document[_0x32b417(0x235)](_0x2198df(0x14f)),messageCount=document[_0x2198df(0x1bc)](_0x2198df(0x196)),modelSelect=document[_0x32b417(0x235)](_0x32b417(0x1de)),deviceIdDisplay=document[_0x32b417(0x235)](_0x32b417(0x175)),btnGeneralChat=document[_0x32b417(0x235)](_0x32b417(0x13b)),btnMyChat=document[_0x32b417(0x235)](_0x32b417(0x1b8)),btnOtherChat=document[_0x2198df(0x1bc)](_0x2198df(0x13d)),userSearchInput=document[_0x2198df(0x1bc)](_0x2198df(0x1c0)),currentChatInfo=document[_0x2198df(0x1bc)](_0x32b417(0x23f)),welcomeModal=document[_0x32b417(0x235)]('welcome-modal'),usernameInput=document['getElementById'](_0x2198df(0xe9)),saveUsernameBtn=document[_0x2198df(0x1bc)](_0x32b417(0x160)),usernameDisplay=document[_0x2198df(0x1bc)](_0x32b417(0x173)),usernameError=document['getElementById'](_0x32b417(0x1f7)),userAvatar=document[_0x32b417(0x235)]('user-avatar');function sanitizeForFirebasePath(_0x31083f){const _0x3b7a5c=_0x32b417;if(!_0x31083f)return'';return _0x31083f[_0x3b7a5c(0x146)](/[.#$[\]/]/g,'_');}function escapeHtml(_0x269ec0){const _0x50d2d3=_0x2198df,_0x4eab12=_0x32b417;if(typeof _0x269ec0!==_0x4eab12(0x23a))return'';return _0x269ec0[_0x4eab12(0x146)](/&/g,_0x4eab12(0x1e6))[_0x4eab12(0x146)](/</g,_0x50d2d3(0xbe))[_0x50d2d3(0x1e9)](/>/g,_0x4eab12(0x128))[_0x50d2d3(0x1e9)](/"/g,_0x4eab12(0x152))[_0x4eab12(0x146)](/'/g,_0x4eab12(0x112));}function _0x3db1(){const _0x215e6c=_0x2198df,_0x1dd0dc=[_0x215e6c(0x10a),_0x215e6c(0x114),'\x20/\x20','Erro:\x20ID\x20do\x20dispositivo\x20do\x20usuário\x20não\x20definido\x20para\x20carregar\x20\x27Meu\x20Chat\x27.','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>','Nenhum\x20histórico\x20encontrado\x20para\x20',_0x215e6c(0x110),_0x215e6c(0x1de),_0x215e6c(0x201),_0x215e6c(0xd6),_0x215e6c(0x10c),'Erro\x20ao\x20tentar\x20desanexar\x20listener\x20Firebase:',_0x215e6c(0x126),_0x215e6c(0x1c3),_0x215e6c(0xd5),_0x215e6c(0xdc),'1:1080485760423:web:8e4befd62dbf6106ff7a82','Erro\x20ao\x20salvar\x20mensagem\x20do\x20usuário\x20no\x20Firebase:',_0x215e6c(0x1ea),_0x215e6c(0x120),'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20','.toggle-controls',_0x215e6c(0x1a8),'blockReason',_0x215e6c(0xdd),_0x215e6c(0xaf),_0x215e6c(0x1cc),_0x215e6c(0x17c),_0x215e6c(0x1d8),_0x215e6c(0x10e),_0x215e6c(0xa8),_0x215e6c(0xfa),_0x215e6c(0x156),_0x215e6c(0x16c),_0x215e6c(0x1d2),'<div\x20class=\x22user-avatar\x22>',_0x215e6c(0x204),'admin',_0x215e6c(0x13a),_0x215e6c(0x127),_0x215e6c(0xb9),_0x215e6c(0xcb),_0x215e6c(0x12f),'submit',_0x215e6c(0x206),_0x215e6c(0x1ee),_0x215e6c(0x115),_0x215e6c(0x13e),_0x215e6c(0x1bc),_0x215e6c(0x103),_0x215e6c(0x1ad),'error',_0x215e6c(0x192),_0x215e6c(0x1d4),_0x215e6c(0x1b1),_0x215e6c(0x1e0),_0x215e6c(0x1f0),_0x215e6c(0x1e7),_0x215e6c(0x1a0),_0x215e6c(0x12c),_0x215e6c(0xc8),'bg-gray-100\x20text-gray-800','hidden',_0x215e6c(0x140),_0x215e6c(0x193),'.initial-message','ID\x20do\x20modelo\x20inválido\x20após\x20sanitização\x20para\x20salvar\x20resposta.',_0x215e6c(0x17d),_0x215e6c(0xd2),_0x215e6c(0x1a1),_0x215e6c(0x145),'Erro\x20Gemini\x20(','ID\x20do\x20modelo\x20não\x20fornecido\x20para\x20initGeminiChat.',_0x215e6c(0x9f),'⚠️\x20Lembre-se:\x20Para\x20ver\x20o\x20chat\x20de\x20outro\x20usuário,\x20as\x20Regras\x20de\x20Segurança\x20do\x20Firebase\x20devem\x20permitir\x20leitura\x20em\x20\x27userChats/',_0x215e6c(0x135),'lastActive','Visualizando\x20chat\x20de\x20outro\x20usuário...','Erro:\x20ID\x20do\x20modelo\x20inválido\x20ao\x20tentar\x20salvar\x20mensagem.',_0x215e6c(0xb7),_0x215e6c(0x1ba),_0x215e6c(0x175),_0x215e6c(0x11f),_0x215e6c(0x181),_0x215e6c(0x151),_0x215e6c(0x190),_0x215e6c(0x203),_0x215e6c(0x173),_0x215e6c(0x186),'Você','Chave\x20da\x20API\x20Gemini\x20não\x20configurada!','geral','toString','Tentativa\x20de\x20salvar\x20usuário\x20no\x20Firebase\x20sem\x20ID\x20ou\x20Nome.',_0x215e6c(0x187),_0x215e6c(0x1cf),_0x215e6c(0x1ae),_0x215e6c(0x170),_0x215e6c(0x1a7),_0x215e6c(0x17f),_0x215e6c(0xa9),_0x215e6c(0xbc),'<a\x20href=\x22$2\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22\x20class=\x22text-indigo-600\x20hover:underline\x22>$1</a>',_0x215e6c(0x1ef),_0x215e6c(0xc1),_0x215e6c(0x122),_0x215e6c(0xaa),'createElement',_0x215e6c(0xf0),_0x215e6c(0x18e),_0x215e6c(0x1fc),_0x215e6c(0x108),_0x215e6c(0x9e),_0x215e6c(0x144),_0x215e6c(0x17a),_0x215e6c(0xd1),_0x215e6c(0x109),_0x215e6c(0x191),_0x215e6c(0xf4),'<ul>',_0x215e6c(0x1fd),'\x20mt-2\x20text-right\x22>',_0x215e6c(0x183),')\x20salva\x20em\x20',_0x215e6c(0x1b8),_0x215e6c(0xd8),_0x215e6c(0xce),_0x215e6c(0x13f),'...)',_0x215e6c(0x1df),'\x20px-4\x20py-3\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20mb-1\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>Gemini</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22markdown-content\x22>','3220pbrPKc',_0x215e6c(0x9d),'trim',_0x215e6c(0x158),'\x20Para\x20ver\x20o\x20chat\x20de\x20outro\x20usuário,\x20as\x20regras\x20para\x20\x27/userChats/$userId\x27\x20devem\x20permitir\x20leitura.',_0x215e6c(0x1dc),'G-VD9JE84V5N',_0x215e6c(0xf9),_0x215e6c(0x15a),'Erro:\x20Usuário\x20não\x20configurado\x20corretamente.',_0x215e6c(0x15d),_0x215e6c(0x11b),_0x215e6c(0xfb),'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-start\x20mb-2\x20items-end\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bot-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-robot\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble\x20',_0x215e6c(0x146),'getFullYear',_0x215e6c(0xc7),_0x215e6c(0x1b0),_0x215e6c(0x1f4),_0x215e6c(0x106),_0x215e6c(0x165),_0x215e6c(0x152),_0x215e6c(0x184),_0x215e6c(0x18c),_0x215e6c(0x134),'&gt;',_0x215e6c(0x155),_0x215e6c(0x207),_0x215e6c(0xf6),'opacity',_0x215e6c(0x1e2),'endBefore',_0x215e6c(0xe8),_0x215e6c(0x1d7),'Modelo\x20selecionado:\x20',_0x215e6c(0xa1),_0x215e6c(0x1a6),_0x215e6c(0x15c),_0x215e6c(0xeb),_0x215e6c(0x188),_0x215e6c(0x1b3),_0x215e6c(0x1dd),'Usando\x20ID\x20de\x20dispositivo\x20existente:',_0x215e6c(0x1bd),_0x215e6c(0xfe),_0x215e6c(0x128),_0x215e6c(0xb2),_0x215e6c(0xb0),_0x215e6c(0x205),'getDate',_0x215e6c(0x1f7),')\x20com\x20','</p>','generalChat/',_0x215e6c(0xec),'replace','Não\x20inicializando\x20objeto\x20\x27chat\x27\x20para\x20a\x20view:',_0x215e6c(0xb6),_0x215e6c(0xbd),_0x215e6c(0x1f9),_0x215e6c(0x107),_0x215e6c(0x197),_0x215e6c(0x174),_0x215e6c(0xc0),_0x215e6c(0x19a),_0x215e6c(0xc5),'sort',_0x215e6c(0x176),_0x215e6c(0xea),_0x215e6c(0xba),_0x215e6c(0xdb),_0x215e6c(0x14e),'\x27,\x20Model=\x27',_0x215e6c(0x208),_0x215e6c(0xf7),_0x215e6c(0x130),_0x215e6c(0xc9),_0x215e6c(0x178),_0x215e6c(0x1b7),_0x215e6c(0x198),_0x215e6c(0x13c),'save-username-btn',_0x215e6c(0x15f),'Erro\x20ao\x20verificar.\x20Tente\x20novamente.',_0x215e6c(0x18b),_0x215e6c(0xac),_0x215e6c(0x1b5),'gemini',_0x215e6c(0xf1),_0x215e6c(0x1ec),'querySelectorAll',_0x215e6c(0x100),_0x215e6c(0x1b2),'Nome\x20de\x20usuário\x20\x27',_0x215e6c(0xae),_0x215e6c(0x154),_0x215e6c(0x1c7),_0x215e6c(0x167),'includes',_0x215e6c(0x14d),_0x215e6c(0xa4),_0x215e6c(0x19b),_0x215e6c(0x209),_0x215e6c(0x171),_0x215e6c(0xe5),_0x215e6c(0x1e5),'Chat\x20(',_0x215e6c(0x129),'</li>','<i\x20class=\x22fas\x20fa-circle\x20mr-1\x20text-green-500\x22></i>\x20Conectado','code',_0x215e6c(0xca),'bg-green-100\x20text-green-800',_0x215e6c(0xf8),_0x215e6c(0x1e3),_0x215e6c(0x11e),_0x215e6c(0x142),_0x215e6c(0x1c2),_0x215e6c(0x189),_0x215e6c(0xfc),_0x215e6c(0x1ca),'Outro\x20(','preventDefault','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>',_0x215e6c(0x1bb),'Nome\x20deve\x20ter\x20entre\x203\x20e\x2015\x20caracteres.','):\x20Erro\x20de\x20rede\x20ao\x20contatar\x20a\x20API\x20Gemini.\x20Verifique\x20sua\x20conexão.',_0x215e6c(0x1fb),_0x215e6c(0x137),_0x215e6c(0x11d),_0x215e6c(0xc2),'general',_0x215e6c(0x1f1),_0x215e6c(0xb1),_0x215e6c(0x1cb),_0x215e6c(0x168),_0x215e6c(0x200),_0x215e6c(0x177),_0x215e6c(0x164),_0x215e6c(0xfd),_0x215e6c(0x16f),_0x215e6c(0x1e8),'toUpperCase',_0x215e6c(0x1c8),_0x215e6c(0xd7),'bg-gray-100',_0x215e6c(0xff),_0x215e6c(0x132),_0x215e6c(0x119),_0x215e6c(0x9c),_0x215e6c(0xee),_0x215e6c(0xc4),'13258vRceqM',_0x215e6c(0x12e),_0x215e6c(0xe7),_0x215e6c(0xe4),_0x215e6c(0xe3),'Visualizando:\x20',_0x215e6c(0x10b),'hover:bg-gray-200',_0x215e6c(0x1b6),_0x215e6c(0x1a3),_0x215e6c(0xe6),_0x215e6c(0x124),_0x215e6c(0xf3),_0x215e6c(0x1c1),'focus','Listener\x20Firebase\x20desanexado\x20com\x20sucesso.',_0x215e6c(0xb5),_0x215e6c(0x1a5),_0x215e6c(0x179),_0x215e6c(0x104),_0x215e6c(0x1fa),_0x215e6c(0x1aa),'bg-yellow-100\x20text-yellow-800',_0x215e6c(0x160),_0x215e6c(0x12d),_0x215e6c(0x1c4),_0x215e6c(0x12a),_0x215e6c(0xc3),_0x215e6c(0x1bf),'Iniciando\x20carregamento:\x20View=\x27',_0x215e6c(0x13b),'.controls-container',_0x215e6c(0x1fe),'usernames/',_0x215e6c(0x1b4),'):\x20Chave\x20da\x20API\x20inválida.\x20Verifique\x20a\x20configuração.',_0x215e6c(0x105),_0x215e6c(0x116),'<i\x20class=\x22fas\x20fa-sign-in-alt\x20mr-2\x22></i>\x20Entrar\x20no\x20Chat',_0x215e6c(0xa7),_0x215e6c(0x117),'length','TIMESTAMP',_0x215e6c(0x1be),'Nome\x20de\x20usuário\x20encontrado\x20localmente:\x20',_0x215e6c(0xa3),_0x215e6c(0x15b),_0x215e6c(0x123),_0x215e6c(0xef),_0x215e6c(0xde),_0x215e6c(0xe1),_0x215e6c(0x1c6),_0x215e6c(0x1ce),_0x215e6c(0x202),_0x215e6c(0x111),_0x215e6c(0xcc),'Erro\x20interno:\x20Não\x20foi\x20possível\x20determinar\x20onde\x20salvar\x20sua\x20mensagem.','target',_0x215e6c(0x1d0),_0x215e6c(0x147),_0x215e6c(0x1a2),_0x215e6c(0xa0),'falha',_0x215e6c(0x1d3),_0x215e6c(0x163),_0x215e6c(0xcd),_0x215e6c(0x15e),_0x215e6c(0xa6),'Nenhum\x20listener/ref\x20Firebase\x20anterior\x20para\x20desanexar\x20(ou\x20um\x20deles\x20era\x20null).\x20Ref:',_0x215e6c(0x13d),_0x215e6c(0x121),'startAt',_0x215e6c(0x1f8),_0x215e6c(0x1af),_0x215e6c(0x1cd),'Não\x20inicializando\x20objeto\x20de\x20chat\x20Gemini\x20para\x20view\x20\x27other\x27.',_0x215e6c(0xbb),_0x215e6c(0x1f6),_0x215e6c(0xdf),_0x215e6c(0xbf),_0x215e6c(0xf5),_0x215e6c(0x19c),_0x215e6c(0x19f),_0x215e6c(0x1da),_0x215e6c(0xb8),_0x215e6c(0xd0),_0x215e6c(0xd4),_0x215e6c(0x185),_0x215e6c(0x1e4),_0x215e6c(0x10d),_0x215e6c(0xe2),'Use\x20apenas\x20letras,\x20números,\x20_\x20ou\x20-.\x20Sem\x20espaços.',_0x215e6c(0x136),_0x215e6c(0x172)];return _0x3db1=function(){return _0x1dd0dc;},_0x3db1();}function formatMarkdown(_0xcfabb9){const _0x2b2873=_0x2198df,_0x2f1d06=_0x32b417;if(typeof _0xcfabb9!==_0x2f1d06(0x23a))return'';const _0xd28886={};let _0x5e293b=0x0,_0x4eb540=_0xcfabb9[_0x2f1d06(0x146)](/```([\s\S]*?)```/gs,(_0x3e2f68,_0x38d3cd)=>{const _0x2149f1=_0x2f1d06,_0x34b0f8=_0x2149f1(0x1e9)+_0x5e293b++ +'__';return _0xd28886[_0x34b0f8]=_0x2149f1(0x201)+escapeHtml(_0x38d3cd)+_0x2149f1(0x122),_0x34b0f8;});_0x4eb540=_0x4eb540[_0x2f1d06(0x146)](/\[([^\]]+)\]\(([^)]+)\)/g,_0x2f1d06(0x26b)),_0x4eb540=_0x4eb540[_0x2f1d06(0x146)](/\*\*(.*?)\*\*/g,_0x2f1d06(0x244)),_0x4eb540=_0x4eb540[_0x2f1d06(0x146)](/(?<!\*)\*(?!\*)(.*?)(?<!\*)\*(?!\*)/g,_0x2f1d06(0x1a3)),_0x4eb540=_0x4eb540[_0x2f1d06(0x146)](/`([^`]+)`/g,(_0x19d73e,_0x28adcb)=>_0x2f1d06(0x259)+escapeHtml(_0x28adcb)+_0x2f1d06(0x114));const _0x4d0d3b=_0x4eb540[_0x2f1d06(0x220)]('\x0a');let _0x652291=[],_0x16975f=null;_0x4d0d3b[_0x2f1d06(0x257)](_0x41e149=>{const _0x18581d=_0x22b1,_0x25ad90=_0x2f1d06,_0x10af19=_0x41e149[_0x25ad90(0x167)](/^(\s*)([-*+])\s+(.*)/),_0x44d34f=_0x41e149[_0x25ad90(0x167)](/^(\s*)(\d+\.)\s+(.*)/);if(_0x10af19){if(_0x16975f!=='ul'){if(_0x16975f)_0x652291[_0x25ad90(0x277)]('</'+_0x16975f+'>');_0x652291[_0x25ad90(0x277)](_0x25ad90(0x27c)),_0x16975f='ul';}_0x652291[_0x25ad90(0x277)](_0x18581d(0x1ee)+_0x10af19[0x3]+_0x25ad90(0x17b));}else{if(_0x44d34f){if(_0x16975f!=='ol'){if(_0x16975f)_0x652291[_0x25ad90(0x277)]('</'+_0x16975f+'>');_0x652291[_0x25ad90(0x277)](_0x25ad90(0x27a)),_0x16975f='ol';}_0x652291[_0x25ad90(0x277)](_0x25ad90(0x232)+_0x44d34f[0x3]+_0x25ad90(0x17b));}else _0x16975f&&(_0x652291[_0x18581d(0x17a)]('</'+_0x16975f+'>'),_0x16975f=null),_0x652291[_0x25ad90(0x277)](_0x41e149);}}),_0x16975f&&_0x652291[_0x2f1d06(0x277)]('</'+_0x16975f+'>'),_0x4eb540=_0x652291[_0x2f1d06(0x211)]('\x0a');for(const _0x1e7ede in _0xd28886){_0x4eb540=_0x4eb540[_0x2b2873(0x1e9)](_0x1e7ede,()=>_0xd28886[_0x1e7ede]);}const _0x58e004=_0x4eb540[_0x2f1d06(0x220)](/\n\s*\n/)[_0x2b2873(0x204)](_0xb27cb1=>_0xb27cb1[_0x2f1d06(0x111)]())[_0x2f1d06(0x273)](_0x2ee923=>_0x2ee923)[_0x2f1d06(0x229)](_0x304432=>{const _0x31f87a=_0x2b2873,_0x78dde9=_0x2f1d06;if(_0x304432[_0x78dde9(0x167)](/^<(ul|ol|pre|h[1-6]|li|blockquote)/))return _0x304432;return _0x31f87a(0x112)+_0x304432[_0x31f87a(0x1e9)](/\n/g,_0x78dde9(0x156))+_0x78dde9(0x143);})[_0x2f1d06(0x211)]('');return _0x58e004;}function formatTime(_0x3434cf){const _0x13cd62=_0x2198df,_0x1480ad=_0x32b417;if(!_0x3434cf||typeof _0x3434cf!==_0x1480ad(0x174))return'';try{const _0x45ed49=new Date(_0x3434cf);if(isNaN(_0x45ed49[_0x1480ad(0x26c)]()))return'';const _0x4db44a=new Date(),_0x2ea178=_0x45ed49[_0x1480ad(0x140)]()===_0x4db44a[_0x1480ad(0x140)]()&&_0x45ed49[_0x1480ad(0x12d)]()===_0x4db44a[_0x1480ad(0x12d)]()&&_0x45ed49[_0x13cd62(0x1ac)]()===_0x4db44a[_0x1480ad(0x11e)]();return _0x2ea178?_0x45ed49[_0x1480ad(0x153)]([],{'hour':_0x13cd62(0x179),'minute':_0x1480ad(0x1b9)}):_0x45ed49[_0x1480ad(0x153)]([],{'day':_0x1480ad(0x1b9),'month':_0x1480ad(0x1b9),'year':_0x1480ad(0x1b9),'hour':_0x1480ad(0x1b9),'minute':_0x13cd62(0x179)});}catch(_0x5485dd){return console[_0x1480ad(0x238)](_0x13cd62(0x1eb),_0x5485dd,_0x3434cf),'';}}function scrollToBottom(){setTimeout(()=>{const _0x2e7e52=_0x292f;if(chatMessages)chatMessages[_0x2e7e52(0x22b)]=chatMessages[_0x2e7e52(0x203)];},0x64);}function updateMessageCountDisplay(){const _0x2ee8c9=_0x2198df,_0x44902b=_0x32b417;let _0x395db1=currentModelId[_0x44902b(0x146)](_0x44902b(0x23c),'')[_0x2ee8c9(0x1e9)](_0x2ee8c9(0x182),_0x44902b(0x258))[_0x44902b(0x146)](_0x2ee8c9(0x18f),'g-'),_0x4c980a='';if(currentChatView===_0x44902b(0x192))_0x4c980a=_0x44902b(0x1c2);else{if(currentChatView===_0x44902b(0x1bf))_0x4c980a=_0x2ee8c9(0x1ce);else{if(currentChatView===_0x44902b(0x154)&&targetChatId)_0x4c980a=_0x44902b(0x188)+targetChatId[_0x2ee8c9(0xac)](0x0,0x6)+_0x44902b(0x10c);else _0x4c980a='?';}}if(messageCount)messageCount[_0x44902b(0x13e)]=messageCounter+_0x2ee8c9(0xcf)+_0x4c980a+_0x44902b(0x207)+_0x395db1+')';}function updateChatInfoLabel(){const _0x17695d=_0x2198df,_0x24f830=_0x32b417;let _0x30e1e7=_0x24f830(0x1ac);if(currentChatView===_0x24f830(0x192))_0x30e1e7+='Chat\x20Geral';else{if(currentChatView==='own')_0x30e1e7+=_0x24f830(0x1a6);else{if(currentChatView===_0x24f830(0x154)&&targetChatId)_0x30e1e7+=_0x24f830(0x14b)+targetChatId[_0x24f830(0x164)](0x0,0x8)+_0x24f830(0x14a);else _0x30e1e7+=_0x17695d(0x101);}}if(currentChatInfo)currentChatInfo[_0x24f830(0x13e)]=_0x30e1e7;}function updateActiveButton(){const _0x330de7=_0x2198df,_0x38cbdd=_0x32b417;document[_0x38cbdd(0x169)](_0x38cbdd(0x198))[_0x38cbdd(0x257)](_0x404b4d=>{const _0x5433b2=_0x38cbdd;_0x404b4d[_0x5433b2(0x15c)][_0x5433b2(0x22f)](_0x5433b2(0x213),_0x5433b2(0x23d),_0x5433b2(0x275)),_0x404b4d[_0x5433b2(0x15c)][_0x5433b2(0x134)](_0x5433b2(0x1a0),_0x5433b2(0x182),_0x5433b2(0x1ae));});const _0x15ce48=currentChatView===_0x38cbdd(0x192)?_0x330de7(0xfe):currentChatView===_0x38cbdd(0x1bf)?_0x330de7(0x1a5):currentChatView===_0x38cbdd(0x154)?_0x38cbdd(0x1ec):null;if(_0x15ce48){const _0x1fb244=document[_0x38cbdd(0x235)](_0x15ce48);_0x1fb244&&(_0x1fb244[_0x330de7(0x178)][_0x38cbdd(0x134)](_0x330de7(0xd5),_0x330de7(0x1f0),_0x38cbdd(0x275)),_0x1fb244[_0x330de7(0x178)][_0x38cbdd(0x22f)](_0x330de7(0x9b),_0x38cbdd(0x182),_0x38cbdd(0x1ae)));}}function getOrCreateDeviceId(){const _0x2461bf=_0x2198df,_0x26b7bb=_0x32b417;let _0x7a2dbf=localStorage[_0x26b7bb(0x109)](_0x26b7bb(0x1e2));return!_0x7a2dbf?(_0x7a2dbf=_0x26b7bb(0x268)+Date[_0x26b7bb(0x1b1)]()+'-'+Math[_0x26b7bb(0x266)]()[_0x2461bf(0x1db)](0x24)[_0x26b7bb(0x164)](0x2,0x8),localStorage[_0x26b7bb(0x25a)](_0x26b7bb(0x1e2),_0x7a2dbf),console[_0x26b7bb(0x176)](_0x26b7bb(0x21b),_0x7a2dbf)):console[_0x26b7bb(0x176)](_0x26b7bb(0x139),_0x7a2dbf),_0x7a2dbf;}function updateUserDisplay(){const _0x2e8504=_0x2198df,_0xbab27a=_0x32b417;if(USERNAME&&usernameDisplay)usernameDisplay[_0x2e8504(0xb0)]=USERNAME,userAvatar&&(userAvatar[_0xbab27a(0x13e)]=USERNAME[_0xbab27a(0x1cc)](0x0)[_0x2e8504(0x153)](),userAvatar[_0xbab27a(0x15c)][_0xbab27a(0x22f)](_0x2e8504(0x1f2)));else usernameDisplay&&(usernameDisplay[_0xbab27a(0x13e)]=_0xbab27a(0x14a));if(USER_DEVICE_ID&&deviceIdDisplay){const _0x5a88a2=USER_DEVICE_ID[_0xbab27a(0x164)](0x0,0x8)+_0xbab27a(0x14a);deviceIdDisplay[_0x2e8504(0xb0)]=_0x5a88a2;}}async function saveUserToFirebase(){const _0x121652=_0x2198df,_0x4dbb26=_0x32b417;if(!USER_DEVICE_ID||!USERNAME){console[_0x4dbb26(0x238)](_0x4dbb26(0x262));return;}console[_0x121652(0x171)](_0x4dbb26(0x16f)+USER_DEVICE_ID+_0x4dbb26(0x22c)+USERNAME);const _0x289110=database[_0x4dbb26(0x1b0)](_0x4dbb26(0x15a)+USER_DEVICE_ID),_0x1b2003=database[_0x4dbb26(0x1b0)](_0x4dbb26(0x1c8)+USERNAME);try{await _0x289110[_0x4dbb26(0x14d)]({'username':USERNAME,'lastActive':firebase[_0x4dbb26(0x1fb)][_0x4dbb26(0x204)][_0x4dbb26(0x1d1)]}),await _0x1b2003[_0x4dbb26(0x13d)](USER_DEVICE_ID),console[_0x4dbb26(0x176)](_0x4dbb26(0x24e));}catch(_0x22d3d7){console[_0x4dbb26(0x238)]('Erro\x20ao\x20salvar\x20dados\x20do\x20usuário\x20no\x20Firebase:',_0x22d3d7);}}function showWelcomeModal(){const _0x2dc904=_0x2198df,_0x26bcd9=_0x32b417;if(welcomeModal){welcomeModal[_0x26bcd9(0x15c)][_0x2dc904(0x12f)](_0x26bcd9(0x243));if(usernameInput)usernameInput[_0x2dc904(0x133)]();}else console[_0x26bcd9(0x238)](_0x26bcd9(0x13f));}async function handleSaveUsername(){const _0x17a508=_0x2198df,_0xe582fc=_0x32b417,_0x122954=usernameInput[_0xe582fc(0x278)][_0x17a508(0x11c)]()[_0xe582fc(0x233)]();usernameError[_0x17a508(0xb0)]='';if(_0x122954[_0xe582fc(0x1d0)]<0x3||_0x122954[_0xe582fc(0x1d0)]>0xf){usernameError['textContent']=_0xe582fc(0x18c);return;}if(!/^[a-z0-9]+(?:[_-]?[a-z0-9]+)*$/i[_0xe582fc(0x1b2)](_0x122954)){usernameError['textContent']=_0xe582fc(0x202);return;}if([_0xe582fc(0x22a),_0xe582fc(0x166),_0xe582fc(0x260),_0xe582fc(0x110)][_0xe582fc(0x171)](_0x122954)){usernameError[_0xe582fc(0x13e)]=_0xe582fc(0x263);return;}saveUsernameBtn[_0xe582fc(0x1c5)]=!![],saveUsernameBtn[_0xe582fc(0x21f)]=_0xe582fc(0x25c);try{const _0x594d44=await database[_0xe582fc(0x1b0)](_0xe582fc(0x1c8)+_0x122954)[_0xe582fc(0x1ef)](_0xe582fc(0x278)),_0x3faebc=_0x594d44[_0xe582fc(0x149)]();if(_0x3faebc&&_0x3faebc!==USER_DEVICE_ID){const _0x14f38d=database[_0xe582fc(0x1b0)]('users/'+_0x3faebc),_0x315e65=await _0x14f38d[_0xe582fc(0x1ef)](_0xe582fc(0x278)),_0x5e578e=_0x315e65['val']();if(_0x5e578e){const _0x44d398=_0x5e578e[_0xe582fc(0x251)]||0x0,_0x165c5c=Date[_0xe582fc(0x1b1)](),_0x52c14a=0x5*0x3c*0x3e8;if(_0x165c5c-_0x44d398<_0x52c14a){usernameError[_0xe582fc(0x13e)]=_0xe582fc(0x250),saveUsernameBtn[_0xe582fc(0x1c5)]=![],saveUsernameBtn[_0xe582fc(0x21f)]=_0x17a508(0x14c);return;}else console[_0xe582fc(0x176)](_0xe582fc(0x1aa)+_0x122954+_0xe582fc(0x1af)+_0x3faebc),await database[_0xe582fc(0x1b0)](_0xe582fc(0x1c8)+_0x122954)[_0xe582fc(0x13d)](USER_DEVICE_ID),await _0x14f38d[_0xe582fc(0x14d)]({'username':null});}}USERNAME=_0x122954,localStorage[_0xe582fc(0x25a)](_0xe582fc(0x264),USERNAME);if(welcomeModal)welcomeModal[_0xe582fc(0x15c)][_0xe582fc(0x134)]('hidden');updateUserDisplay(),await saveUserToFirebase(),console[_0xe582fc(0x176)](_0x17a508(0x16d)+USERNAME+_0xe582fc(0x18b)),initialLoadComplete=!![],loadChatHistoryAndInit(),startActivityUpdates();}catch(_0x3f892f){console[_0xe582fc(0x238)](_0x17a508(0x143),_0x3f892f),usernameError[_0xe582fc(0x13e)]=_0xe582fc(0x162),saveUsernameBtn[_0x17a508(0x13b)]=![],saveUsernameBtn[_0xe582fc(0x21f)]=_0xe582fc(0x1cd);}}function startActivityUpdates(){const _0x3307ba=_0x2198df,_0x3cc977=_0x32b417;console[_0x3cc977(0x176)](_0x3307ba(0x1c9)),setInterval(async()=>{const _0x421442=_0x3307ba,_0x2b662d=_0x3cc977;if(USER_DEVICE_ID&&USERNAME)try{await database[_0x2b662d(0x1b0)](_0x2b662d(0x15a)+USER_DEVICE_ID)[_0x2b662d(0x14d)]({'lastActive':firebase[_0x2b662d(0x1fb)][_0x2b662d(0x204)][_0x2b662d(0x1d1)],'username':USERNAME});}catch(_0x3d63f2){console[_0x421442(0xd9)](_0x421442(0x113),_0x3d63f2);}},0xea60);}async function setupUser(){const _0x2e5e2b=_0x2198df,_0x1fa609=_0x32b417;USER_DEVICE_ID=getOrCreateDeviceId();const _0x54d9f5=localStorage[_0x1fa609(0x109)](_0x1fa609(0x264));updateUserDisplay(),!_0x54d9f5?(console[_0x1fa609(0x176)](_0x2e5e2b(0x118)),showWelcomeModal()):(USERNAME=_0x54d9f5,console[_0x1fa609(0x176)](_0x1fa609(0x1d3)+USERNAME),updateUserDisplay(),await saveUserToFirebase(),initialLoadComplete=!![],loadChatHistoryAndInit(),startActivityUpdates());}async function initGeminiChat(_0x52ae07=[],_0x368239){const _0x26f283=_0x2198df,_0x58b386=_0x32b417;chat=null;if(currentChatView!==_0x26f283(0x16b)&&currentChatView!==_0x58b386(0x1bf))return console[_0x58b386(0x176)](_0x58b386(0x147),currentChatView),enableChatInput(![]),![];if(!genAI)return console[_0x58b386(0x238)](_0x58b386(0x24a)),appendSystemMessage(_0x58b386(0x178),_0x58b386(0x238)),![];if(!_0x368239)return console[_0x26f283(0xd9)](_0x58b386(0x24d)),appendSystemMessage(_0x58b386(0x15d),_0x58b386(0x238)),![];appendSystemMessage(_0x26f283(0x14a)+currentChatView+_0x58b386(0x142)+_0x368239+_0x58b386(0x14a)),enableChatInput(![]);try{console[_0x58b386(0x176)](_0x58b386(0x10a)+_0x368239+_0x58b386(0x21e)+currentChatView);const _0xa8c32b=genAI[_0x58b386(0x26f)]({'model':_0x368239});return chat=_0xa8c32b[_0x26f283(0x16e)]({'history':_0x52ae07,'generationConfig':{'maxOutputTokens':0x7d0}}),console[_0x58b386(0x176)](_0x58b386(0x179)+_0x368239+_0x58b386(0x27b)+currentChatView+_0x26f283(0x125)+_0x52ae07[_0x26f283(0x17b)]+_0x26f283(0x1a4)),appendSystemMessage(_0x58b386(0x179)+currentChatView+_0x58b386(0x11f)),enableChatInput(!![]),!![];}catch(_0x254b6c){console[_0x58b386(0x238)](_0x58b386(0x1c9)+_0x368239+_0x58b386(0x27b)+currentChatView+'):',_0x254b6c);let _0xd6e091=_0x58b386(0x1cb)+currentChatView+_0x58b386(0x142)+_0x368239+'.';if(_0x254b6c[_0x58b386(0x1e7)]?.[_0x58b386(0x171)](_0x58b386(0x256)))_0xd6e091=_0x58b386(0x26e)+_0x368239+_0x58b386(0x19b);else{if(_0x254b6c[_0x26f283(0x163)]?.[_0x26f283(0x161)](_0x58b386(0x1e1))||_0x254b6c[_0x26f283(0x163)]?.[_0x58b386(0x171)](_0x26f283(0xf6)))_0xd6e091=_0x58b386(0x26e)+_0x368239+_0x58b386(0x18d);else{if(_0x254b6c['message']?.[_0x26f283(0x161)](_0x58b386(0x172)))_0xd6e091=_0x26f283(0x122)+_0x368239+'):\x20Modelo\x20não\x20encontrado\x20(404).\x20Verifique\x20o\x20ID\x20do\x20modelo.';else{if(_0x254b6c[_0x58b386(0x1e7)]?.[_0x58b386(0x171)](_0x26f283(0x1a9)))_0xd6e091=_0x58b386(0x26e)+_0x368239+_0x26f283(0x1b9);else _0x254b6c[_0x26f283(0x163)]?.[_0x58b386(0x171)](_0x58b386(0x123))||_0x254b6c[_0x58b386(0x1e7)]?.[_0x58b386(0x171)](_0x58b386(0x1a9))||_0x254b6c[_0x58b386(0x1e7)]?.[_0x58b386(0x171)](_0x26f283(0x183))?_0xd6e091=_0x58b386(0x26e)+_0x368239+'):\x20Cota\x20da\x20API\x20Gemini\x20excedida.':_0xd6e091=_0x58b386(0x26e)+_0x368239+_0x58b386(0x231)+(_0x254b6c[_0x26f283(0x163)]||_0x58b386(0x1c7));}}}return appendSystemMessage(_0xd6e091,_0x58b386(0x238)),enableChatInput(![]),![];}}function appendMessage(_0x1a26a4,_0x485b20=!![],_0x3740d5=null){const _0x1d76fc=_0x2198df,_0x1f7deb=_0x32b417;if(!_0x1a26a4||typeof _0x1a26a4[_0x1d76fc(0x100)]!==_0x1f7deb(0x23a)||!chatMessages)return;const _0x47aba9=chatMessages[_0x1f7deb(0x1ea)](_0x1f7deb(0x246));if(_0x47aba9)_0x47aba9[_0x1d76fc(0x12f)]();const _0xafd458=document[_0x1f7deb(0x270)](_0x1d76fc(0x132));if(_0x485b20)_0xafd458['classList'][_0x1f7deb(0x134)](_0x1f7deb(0x25d));if(_0x3740d5)_0xafd458['id']=_0x1f7deb(0x150)+_0x3740d5;const _0x4ae5c5=_0x1a26a4[_0x1f7deb(0x16a)],_0x30e254=_0x1a26a4[_0x1f7deb(0x1d6)]?formatTime(_0x1a26a4[_0x1d76fc(0x123)]):'',_0x1b8d45=_0x1a26a4['deviceId']||null;if(_0x1a26a4[_0x1d76fc(0xcd)]===_0x1f7deb(0x15b)){const _0x5b0244=_0x1b8d45===USER_DEVICE_ID,_0x349c78=_0x5b0244?_0x1f7deb(0x24b):'justify-start',_0x1df80f=_0x5b0244?_0x1f7deb(0x1ab):_0x1f7deb(0x1a4),_0x427785=!_0x5b0244&&_0x1b8d45&&(currentChatView===_0x1f7deb(0x192)||currentChatView===_0x1d76fc(0xba)),_0x1d7303=_0x427785?'<span\x20class=\x22text-xs\x20text-blue-700\x20ml-2\x22>'+_0x1b8d45[_0x1d76fc(0xac)](0x0,0x6)+_0x1d76fc(0xa2):'';_0xafd458[_0x1f7deb(0x21f)]=_0x1f7deb(0x1c1)+_0x349c78+'\x20mb-2\x20items-end\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(!_0x5b0244?_0x1f7deb(0x228)+(_0x1a26a4[_0x1f7deb(0x264)]?.[_0x1f7deb(0x1cc)](0x0)[_0x1f7deb(0x19d)]()||'?')+_0x1d76fc(0x19f):'')+_0x1f7deb(0x133)+_0x1df80f+_0x1f7deb(0x20f)+(_0x5b0244?_0x1f7deb(0x25e):_0x1a26a4[_0x1f7deb(0x264)]||_0x1f7deb(0x155))+_0x1f7deb(0x141)+_0x1d7303+_0x1f7deb(0x18a)+escapeHtml(_0x4ae5c5)+_0x1f7deb(0x219)+(_0x5b0244?_0x1f7deb(0x236):_0x1f7deb(0x1ed))+_0x1f7deb(0x27e)+_0x30e254+_0x1f7deb(0x1e4)+(_0x5b0244?_0x1d76fc(0x16a)+(USERNAME?.[_0x1f7deb(0x1cc)](0x0)[_0x1f7deb(0x19d)]()||'?')+_0x1f7deb(0x1f9):'')+_0x1d76fc(0x11a);}else{const _0x4e0bcb=formatMarkdown(_0x4ae5c5),_0x4a53c1=_0x1a26a4['isError']||_0x4ae5c5[_0x1f7deb(0x233)]()[_0x1f7deb(0x163)](_0x1f7deb(0x1f6))||_0x4ae5c5[_0x1d76fc(0x115)]()[_0x1f7deb(0x163)](_0x1f7deb(0x1e5))||_0x4ae5c5[_0x1f7deb(0x233)]()[_0x1d76fc(0x18b)](_0x1f7deb(0x20d))||_0x4ae5c5[_0x1f7deb(0x233)]()[_0x1f7deb(0x171)](_0x1f7deb(0x205)),_0x360f05=_0x4a53c1?_0x1f7deb(0x18e):_0x1f7deb(0x242);_0xafd458[_0x1f7deb(0x21f)]=_0x1f7deb(0x11c)+_0x360f05+_0x1f7deb(0x10e)+_0x4e0bcb+_0x1f7deb(0x209)+_0x30e254+_0x1f7deb(0x1da);}chatMessages[_0x1f7deb(0x129)](_0xafd458),scrollToBottom();}function _0x292f(_0x8b1c3,_0x2662a2){const _0x17fc53=_0x3db1();return _0x292f=function(_0x50cf50,_0x137f6f){_0x50cf50=_0x50cf50-0x107;let _0x149292=_0x17fc53[_0x50cf50];return _0x149292;},_0x292f(_0x8b1c3,_0x2662a2);}function _0x22b1(_0x267dc8,_0x2fc470){const _0x3378f1=_0x3378();return _0x22b1=function(_0x22b19e,_0x4c05e5){_0x22b19e=_0x22b19e-0x9b;let _0x13551d=_0x3378f1[_0x22b19e];return _0x13551d;},_0x22b1(_0x267dc8,_0x2fc470);}function appendSystemMessage(_0x1edc98,_0x511bbf=_0x2198df(0x1f1)){const _0x5117eb=_0x2198df,_0x9d2a24=_0x32b417;if(!chatMessages)return;const _0x1d764a=chatMessages[_0x5117eb(0xa6)](_0x9d2a24(0x246));if(_0x1d764a)_0x1d764a[_0x9d2a24(0x22f)]();const _0x231f53=document[_0x9d2a24(0x270)](_0x9d2a24(0x1a2));_0x231f53[_0x9d2a24(0x15c)]['add'](_0x5117eb(0x186),_0x9d2a24(0x279),_0x9d2a24(0x1f0),_0x9d2a24(0x1b4));let _0x17e4c7=_0x9d2a24(0x1bd);if(_0x511bbf===_0x9d2a24(0x238))_0x17e4c7=_0x9d2a24(0x18e);else _0x511bbf===_0x9d2a24(0x127)&&(_0x17e4c7=_0x9d2a24(0x17f));_0x231f53[_0x5117eb(0x1cc)]=_0x9d2a24(0x1dd)+_0x17e4c7+_0x5117eb(0x1d6)+(_0x511bbf===_0x9d2a24(0x238)?_0x5117eb(0x17e):_0x511bbf===_0x9d2a24(0x127)?_0x9d2a24(0x14e):_0x5117eb(0x1ab))+_0x9d2a24(0x1f5)+escapeHtml(_0x1edc98)+_0x9d2a24(0x130),chatMessages[_0x9d2a24(0x129)](_0x231f53),scrollToBottom();if(_0x1edc98[_0x9d2a24(0x171)](_0x9d2a24(0x241)))setTimeout(()=>{_0x231f53['remove']();},0x5dc);else _0x1edc98[_0x9d2a24(0x171)](_0x9d2a24(0x224))&&_0x1edc98[_0x9d2a24(0x171)](_0x9d2a24(0x196))&&setTimeout(()=>{const _0x3882ef=_0x5117eb,_0x3ee79b=_0x9d2a24;_0x231f53[_0x3ee79b(0x206)][_0x3882ef(0xc6)]=_0x3ee79b(0x120),_0x231f53[_0x3ee79b(0x206)][_0x3ee79b(0x12c)]='0',setTimeout(()=>_0x231f53[_0x3ee79b(0x22f)](),0x1f4);},0x7d0);}async function getGeminiResponse(_0x6321c2){const _0x489926=_0x2198df,_0x2cb72a=_0x32b417;if(currentChatView!==_0x2cb72a(0x192)&&currentChatView!==_0x2cb72a(0x1bf)){console[_0x2cb72a(0x199)](_0x2cb72a(0x25b),currentChatView);return;}if(!chat){console[_0x489926(0xd9)](_0x2cb72a(0x225)),appendSystemMessage(_0x2cb72a(0x1d8),_0x489926(0xd9)),enableChatInput(!![]);return;}if(!genAI){console[_0x2cb72a(0x238)]('SDK\x20Gemini\x20não\x20inicializado.'),appendSystemMessage(_0x2cb72a(0x178),_0x489926(0xd9)),enableChatInput(!![]);return;}isGeminiTyping=!![];if(typingIndicator)typingIndicator[_0x489926(0x178)][_0x489926(0x12f)](_0x489926(0x1f2));scrollToBottom();const _0x292360=sanitizeForFirebasePath(currentModelId);if(!_0x292360){console[_0x2cb72a(0x238)](_0x2cb72a(0x247)),appendSystemMessage(_0x2cb72a(0x124),_0x2cb72a(0x238)),isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x2cb72a(0x15c)][_0x2cb72a(0x134)](_0x489926(0x1f2));enableChatInput(!![]);return;}let _0x41fb00=null;if(currentChatView===_0x2cb72a(0x192))_0x41fb00=_0x2cb72a(0x144)+_0x292360;else currentChatView===_0x2cb72a(0x1bf)&&USER_DEVICE_ID&&(_0x41fb00=_0x2cb72a(0x1ff)+USER_DEVICE_ID+'/'+_0x292360);if(!_0x41fb00){console[_0x489926(0xd9)](_0x489926(0x18d)),appendSystemMessage(_0x489926(0x14b),_0x2cb72a(0x238)),isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x489926(0x178)][_0x2cb72a(0x134)](_0x2cb72a(0x243));enableChatInput(!![]);return;}try{console['log'](_0x489926(0x194)+currentModelId+_0x489926(0xf4)+currentChatView+'):',_0x6321c2);const _0x5d1187=await chat[_0x2cb72a(0x11d)](_0x6321c2),_0x28967e=await _0x5d1187[_0x2cb72a(0x1be)],_0x40b2b9=_0x28967e[_0x2cb72a(0x16a)]();console[_0x2cb72a(0x176)](_0x489926(0x131)+currentModelId+_0x2cb72a(0x27b)+currentChatView+'):',_0x40b2b9);const _0x185dbe=database[_0x489926(0x1a3)](_0x41fb00)[_0x2cb72a(0x277)]();await _0x185dbe['set']({'text':_0x40b2b9,'sender':_0x2cb72a(0x166),'timestamp':firebase[_0x2cb72a(0x1fb)][_0x489926(0x172)][_0x2cb72a(0x1d1)],'deviceId':null,'isError':![]}),console[_0x2cb72a(0x176)](_0x489926(0x1e1),_0x185dbe[_0x2cb72a(0x274)]);}catch(_0x1da0b1){console[_0x489926(0xd9)](_0x489926(0xab)+currentModelId+_0x2cb72a(0x27b)+currentChatView+'):',_0x1da0b1);let _0xb01ed3=_0x2cb72a(0x1d2)+currentModelId+'.',_0x2738f8=!![];if(_0x1da0b1[_0x489926(0x160)]?.[_0x2cb72a(0x1d7)]?.[_0x2cb72a(0x21c)])_0xb01ed3=_0x2cb72a(0x125)+currentModelId+_0x2cb72a(0x271)+_0x1da0b1[_0x489926(0x160)]['promptFeedback'][_0x2cb72a(0x21c)]+'.';else{if(_0x1da0b1[_0x489926(0x163)]?.[_0x2cb72a(0x171)](_0x2cb72a(0x27f))||_0x1da0b1[_0x2cb72a(0x1e7)]?.[_0x2cb72a(0x171)](_0x2cb72a(0x123)))_0xb01ed3=_0x2cb72a(0x245)+currentModelId+_0x489926(0xf2);else{if(_0x1da0b1[_0x2cb72a(0x1e7)]?.[_0x2cb72a(0x171)]('API\x20key\x20not\x20valid'))_0xb01ed3=_0x2cb72a(0x245)+currentModelId+_0x2cb72a(0x1ca),_0x2738f8=![];else{if(_0x1da0b1[_0x2cb72a(0x1e7)]?.[_0x2cb72a(0x171)](_0x2cb72a(0x1e1))||_0x1da0b1[_0x2cb72a(0x1e7)]?.['includes'](_0x2cb72a(0x12b)))_0xb01ed3=_0x489926(0xad)+currentModelId+_0x2cb72a(0x185);else _0x1da0b1[_0x2cb72a(0x1e7)]&&(_0xb01ed3=_0x2cb72a(0x24c)+currentModelId+_0x489926(0x206)+_0x1da0b1[_0x2cb72a(0x1e7)]);}}}const _0x189b72=database[_0x2cb72a(0x1b0)](_0x41fb00)['push']();await _0x189b72[_0x2cb72a(0x13d)]({'text':_0xb01ed3,'sender':'gemini','timestamp':firebase[_0x2cb72a(0x1fb)]['ServerValue'][_0x2cb72a(0x1d1)],'deviceId':null,'isError':!![]}),console[_0x2cb72a(0x176)](_0x2cb72a(0x22e),_0x189b72[_0x2cb72a(0x274)]);}finally{isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x2cb72a(0x15c)][_0x2cb72a(0x134)](_0x2cb72a(0x243));enableChatInput(!![]);}}function enableChatInput(_0x8504e9){const _0x56e9ab=_0x2198df,_0x310f37=_0x32b417,_0x42b5bb=statusText[_0x310f37(0x13e)]===_0x310f37(0x1fd),_0x2ad28b=_0x8504e9&&(currentChatView===_0x56e9ab(0x16b)||currentChatView===_0x310f37(0x1bf))&&!!chat&&!isGeminiTyping&&_0x42b5bb;if(messageInput){messageInput[_0x310f37(0x1c5)]=!_0x2ad28b,messageInput[_0x310f37(0x15c)][_0x310f37(0x1c3)](_0x310f37(0x1a0),!_0x2ad28b),messageInput['classList'][_0x310f37(0x1c3)](_0x310f37(0x1f4),!_0x2ad28b);if(!_0x42b5bb)messageInput[_0x310f37(0x132)]=_0x310f37(0x170);else{if(currentChatView===_0x310f37(0x154))messageInput[_0x310f37(0x132)]=_0x310f37(0x252);else{if(!chat&&(currentChatView===_0x310f37(0x192)||currentChatView===_0x310f37(0x1bf)))messageInput[_0x310f37(0x132)]=_0x310f37(0x161);else{if(isGeminiTyping)messageInput[_0x310f37(0x132)]=_0x310f37(0x1fc);else!_0x2ad28b?messageInput[_0x310f37(0x132)]=_0x310f37(0x145):messageInput[_0x310f37(0x132)]=_0x310f37(0x237);}}}}messageSubmitButton&&(messageSubmitButton[_0x310f37(0x1c5)]=!_0x2ad28b,messageSubmitButton[_0x310f37(0x15c)][_0x310f37(0x1c3)](_0x310f37(0x22d),!_0x2ad28b),messageSubmitButton[_0x310f37(0x15c)][_0x310f37(0x1c3)](_0x56e9ab(0x1f6),!_0x2ad28b));}async function loadMoreMessages(){const _0x647d91=_0x2198df,_0x1c4eaf=_0x32b417;if(isLoadingMore||!currentMessagesRef||!firstMessageTimestamp)return;isLoadingMore=!![];try{const _0x1689c4=await currentMessagesRef[_0x1c4eaf(0x116)](_0x1c4eaf(0x1d6))[_0x1c4eaf(0x12e)](firstMessageTimestamp)[_0x1c4eaf(0x226)](MESSAGES_PER_PAGE)[_0x647d91(0x1f8)](_0x1c4eaf(0x278)),_0x2c3ed5=_0x1689c4[_0x1c4eaf(0x149)]();if(!_0x2c3ed5){console[_0x1c4eaf(0x176)](_0x1c4eaf(0x159));return;}const _0x4132e8=Object[_0x1c4eaf(0x1bb)](_0x2c3ed5)[_0x1c4eaf(0x151)]((_0x3fc0fa,_0x5bb5fb)=>_0x2c3ed5[_0x3fc0fa][_0x647d91(0x123)]-_0x2c3ed5[_0x5bb5fb][_0x647d91(0x123)]);firstMessageTimestamp=_0x2c3ed5[_0x4132e8[0x0]][_0x1c4eaf(0x1d6)],_0x4132e8[_0x1c4eaf(0x257)](_0x792674=>{const _0x3c792a=_0x647d91,_0x4a59fe=_0x1c4eaf,_0x284303=_0x2c3ed5[_0x792674];if(_0x284303&&_0x284303[_0x4a59fe(0x1d6)]&&!document[_0x4a59fe(0x235)](_0x4a59fe(0x150)+_0x792674)){messageCounter++;const _0x188c6f=document[_0x3c792a(0xb3)](_0x4a59fe(0x1a2));appendMessage(_0x284303,![],_0x792674),chatMessages[_0x4a59fe(0x1a8)](_0x188c6f,chatMessages[_0x3c792a(0x12b)]);}}),updateMessageCountDisplay();}catch(_0x2d4348){console[_0x1c4eaf(0x238)](_0x1c4eaf(0x11a),_0x2d4348);}finally{isLoadingMore=![];}}async function loadChatHistoryAndInit(){const _0x33c28f=_0x2198df,_0x6d8cb3=_0x32b417;if(!initialLoadComplete){console[_0x6d8cb3(0x176)](_0x6d8cb3(0x23e));if(chatMessages)chatMessages[_0x33c28f(0x1cc)]=_0x6d8cb3(0x14f);return;}console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1c4)+currentChatView+_0x6d8cb3(0x157)+currentModelId+_0x6d8cb3(0x148)+(targetChatId||(currentChatView===_0x6d8cb3(0x192)?_0x33c28f(0xc3):_0x6d8cb3(0x1db)))+'\x27'),enableChatInput(![]);if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x33c28f(0x1d1);messageCounter=0x0,updateMessageCountDisplay(),updateChatInfoLabel(),updateActiveButton();if(currentMessagesRef&&currentFirebaseListener){console[_0x6d8cb3(0x176)](_0x6d8cb3(0x177),currentMessagesRef[_0x6d8cb3(0x261)]());try{currentMessagesRef['off'](_0x6d8cb3(0x138),currentFirebaseListener),console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1b6));}catch(_0x4a235d){console['error'](_0x6d8cb3(0x210),_0x4a235d);}}else console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1eb),currentMessagesRef,_0x6d8cb3(0x16b),typeof currentFirebaseListener);currentFirebaseListener=null,currentMessagesRef=null,chat=null,targetChatId=currentChatView===_0x6d8cb3(0x154)?targetChatId:null;let _0x25aeef=null;const _0x3f1404=sanitizeForFirebasePath(currentModelId);if(!_0x3f1404){const _0x902d79=_0x6d8cb3(0x187);console[_0x6d8cb3(0x238)](_0x902d79),appendSystemMessage(_0x902d79,_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x33c28f(0x1de)+_0x902d79+_0x33c28f(0x13e);return;}if(currentChatView===_0x6d8cb3(0x192))_0x25aeef=_0x33c28f(0x159)+_0x3f1404;else{if(currentChatView===_0x6d8cb3(0x1bf)&&USER_DEVICE_ID)_0x25aeef=_0x6d8cb3(0x1ff)+USER_DEVICE_ID+'/'+_0x3f1404;else{if(currentChatView===_0x6d8cb3(0x154)){const _0x4c85e5=userSearchInput[_0x6d8cb3(0x278)][_0x33c28f(0x11c)]();if(!_0x4c85e5){appendSystemMessage(_0x6d8cb3(0x126),_0x6d8cb3(0x193));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x181);enableChatInput(![]);return;}appendSystemMessage(_0x6d8cb3(0x20b)+_0x4c85e5+_0x6d8cb3(0x14a),_0x6d8cb3(0x193));let _0x9397a1=null;if(!_0x4c85e5[_0x6d8cb3(0x163)](_0x6d8cb3(0x268))){const _0x478152=_0x4c85e5[_0x6d8cb3(0x233)]();try{const _0x2238e6=await database[_0x6d8cb3(0x1b0)](_0x6d8cb3(0x1c8)+_0x478152)[_0x33c28f(0x1f8)](_0x6d8cb3(0x278));_0x2238e6[_0x33c28f(0xfc)]()?(_0x9397a1=_0x2238e6[_0x6d8cb3(0x149)](),console[_0x6d8cb3(0x176)](_0x6d8cb3(0x16c)+_0x4c85e5+_0x6d8cb3(0x108)+_0x9397a1)):console[_0x33c28f(0x171)](_0x6d8cb3(0x16c)+_0x4c85e5+_0x6d8cb3(0x1b7));}catch(_0x482045){console[_0x6d8cb3(0x238)](_0x6d8cb3(0x11b),_0x482045),appendSystemMessage('Erro\x20ao\x20buscar\x20nome\x20\x27'+_0x4c85e5+'\x27.','error');}}if(!_0x9397a1){if(_0x4c85e5[_0x33c28f(0x18b)](_0x6d8cb3(0x268)))_0x9397a1=_0x4c85e5,console[_0x6d8cb3(0x176)](_0x6d8cb3(0x272)+_0x4c85e5+_0x6d8cb3(0x239));else{appendSystemMessage(_0x6d8cb3(0x19f)+_0x4c85e5+_0x6d8cb3(0x168),_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x158)+escapeHtml(_0x4c85e5)+_0x6d8cb3(0x1dc);enableChatInput(![]);return;}}if(_0x9397a1)try{const _0x334046=await database[_0x6d8cb3(0x1b0)](_0x33c28f(0x130)+_0x9397a1)['once'](_0x6d8cb3(0x278));if(!_0x334046[_0x6d8cb3(0x186)]()){console[_0x6d8cb3(0x199)](_0x6d8cb3(0x18f)+_0x9397a1+_0x6d8cb3(0x15f)),appendSystemMessage(_0x33c28f(0x19d)+_0x9397a1['substring'](0x0,0x8)+_0x33c28f(0x150),_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x200);enableChatInput(![]);return;}else targetChatId=_0x9397a1,_0x25aeef=_0x6d8cb3(0x1ff)+targetChatId+'/'+_0x3f1404,console[_0x6d8cb3(0x176)](_0x33c28f(0x102)+targetChatId),appendSystemMessage(_0x6d8cb3(0x24f)+targetChatId+'\x27.',_0x6d8cb3(0x193));}catch(_0x146489){console[_0x33c28f(0xd9)](_0x6d8cb3(0x1ad)+_0x9397a1+':',_0x146489),appendSystemMessage(_0x33c28f(0xe0),_0x33c28f(0xd9)),enableChatInput(![]);return;}else{appendSystemMessage(_0x6d8cb3(0x1cf)+_0x4c85e5+'\x27.',_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x26d);enableChatInput(![]);return;}}}}if(!_0x25aeef){const _0x789c28=currentChatView===_0x6d8cb3(0x1bf)&&!USER_DEVICE_ID?_0x6d8cb3(0x208):_0x6d8cb3(0x1a5);console[_0x6d8cb3(0x238)](_0x789c28),appendSystemMessage(_0x789c28,_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x20c)+_0x789c28+_0x6d8cb3(0x234);enableChatInput(![]);return;}currentMessagesRef=database[_0x6d8cb3(0x1b0)](_0x25aeef),console[_0x33c28f(0x171)](_0x6d8cb3(0x137)+_0x25aeef);try{const _0x50ba6b=await currentMessagesRef[_0x6d8cb3(0x116)](_0x6d8cb3(0x1d6))[_0x6d8cb3(0x226)](0x3e8)[_0x33c28f(0x1f8)](_0x6d8cb3(0x278)),_0x10f18e=_0x50ba6b[_0x33c28f(0xbd)](),_0x583bfd=[];let _0x1d9d24=0x0;if(chatMessages)chatMessages[_0x33c28f(0x1cc)]='';if(_0x10f18e){console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1f8)+currentChatView+':\x20'+Object[_0x6d8cb3(0x1bb)](_0x10f18e)['length']+_0x6d8cb3(0x12f));const _0x50a351=Object[_0x33c28f(0x1fa)](_0x10f18e)[_0x6d8cb3(0x151)]((_0x4d730e,_0x4b074a)=>_0x10f18e[_0x4d730e][_0x6d8cb3(0x1d6)]-_0x10f18e[_0x4b074a][_0x6d8cb3(0x1d6)]);_0x50a351[_0x6d8cb3(0x257)](_0xd46de6=>{const _0x4d58e1=_0x33c28f,_0x5262b8=_0x6d8cb3;messageCounter++;const _0x31a1ec=_0x10f18e[_0xd46de6];if(_0x31a1ec&&_0x31a1ec['timestamp']){appendMessage(_0x31a1ec,![],_0xd46de6),_0x1d9d24=Math['max'](_0x1d9d24,_0x31a1ec[_0x5262b8(0x1d6)]);if((currentChatView===_0x5262b8(0x192)||currentChatView===_0x5262b8(0x1bf))&&typeof _0x31a1ec[_0x4d58e1(0x100)]===_0x5262b8(0x23a)&&!_0x31a1ec[_0x5262b8(0x218)]){const _0x533642=_0x31a1ec[_0x5262b8(0x1e8)]===_0x5262b8(0x15b)?_0x5262b8(0x15b):_0x5262b8(0x14c),_0x470bd1=_0x31a1ec[_0x5262b8(0x16a)];_0x470bd1[_0x5262b8(0x111)]()?_0x583bfd[_0x5262b8(0x277)]({'role':_0x533642,'parts':[{'text':_0x470bd1}]}):console[_0x5262b8(0x199)](_0x4d58e1(0xa5),_0xd46de6);}}else console[_0x5262b8(0x199)](_0x5262b8(0x222),_0xd46de6,_0x31a1ec);}),_0x50a351[_0x6d8cb3(0x1d0)]>0x0&&(firstMessageTimestamp=_0x10f18e[_0x50a351[0x0]][_0x6d8cb3(0x1d6)]);if(_0x50a351[_0x6d8cb3(0x1d0)]===0x0){if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x33c28f(0xb7);}}else{console['log'](_0x6d8cb3(0x20a)+_0x25aeef+'.');if(chatMessages)chatMessages[_0x6d8cb3(0x21f)]=_0x6d8cb3(0x254);}updateMessageCountDisplay(),scrollToBottom();let _0x15b07a=![];currentChatView===_0x6d8cb3(0x192)||currentChatView==='own'?_0x15b07a=await initGeminiChat(_0x583bfd,currentModelId):(_0x15b07a=!![],console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1f2)),enableChatInput(![]));if(_0x15b07a&&currentMessagesRef){currentFirebaseListener=_0x415145=>{const _0x53dfa4=_0x33c28f,_0x52d9a3=_0x6d8cb3,_0x3b7220=_0x415145[_0x52d9a3(0x149)](),_0x1a1af5=_0x415145[_0x52d9a3(0x274)];if(_0x3b7220&&!document[_0x53dfa4(0x1bc)](_0x53dfa4(0xc5)+_0x1a1af5))console[_0x52d9a3(0x176)](_0x52d9a3(0x136)+currentChatView+'):',_0x1a1af5),messageCounter++,appendMessage(_0x3b7220,!![],_0x1a1af5),updateMessageCountDisplay();else!_0x3b7220&&console[_0x52d9a3(0x199)](_0x52d9a3(0x23b),_0x1a1af5);};const _0x3d3dca=_0x1d9d24>0x0?_0x1d9d24+0x1:Date[_0x33c28f(0xe6)]();currentMessagesRef[_0x6d8cb3(0x116)](_0x6d8cb3(0x1d6))[_0x6d8cb3(0x1ee)](_0x3d3dca)['on'](_0x33c28f(0x1dd),currentFirebaseListener),console[_0x6d8cb3(0x176)](_0x6d8cb3(0x1fe)+_0x25aeef+_0x6d8cb3(0x1d9)+new Date(_0x3d3dca)[_0x6d8cb3(0x214)]()),currentChatView!==_0x33c28f(0xba)&&enableChatInput(_0x15b07a);}else console[_0x6d8cb3(0x199)](_0x6d8cb3(0x17e)),!_0x15b07a&&(currentChatView===_0x6d8cb3(0x192)||currentChatView==='own')&&appendSystemMessage(_0x6d8cb3(0x195),_0x6d8cb3(0x238)),enableChatInput(![]);}catch(_0x364aa1){console[_0x6d8cb3(0x238)](_0x6d8cb3(0x217)+_0x25aeef+':',_0x364aa1);let _0x11cf47=_0x6d8cb3(0x184);_0x364aa1[_0x6d8cb3(0x1e7)]?.[_0x6d8cb3(0x233)]()[_0x6d8cb3(0x171)](_0x6d8cb3(0x15e))||_0x364aa1[_0x6d8cb3(0x17d)]?.[_0x6d8cb3(0x233)]()[_0x6d8cb3(0x171)](_0x6d8cb3(0x15e))?(_0x11cf47=_0x6d8cb3(0x13a)+_0x25aeef+_0x6d8cb3(0x27d),currentChatView===_0x6d8cb3(0x154)&&(_0x11cf47+=_0x6d8cb3(0x113))):_0x11cf47+=_0x6d8cb3(0x249)+_0x364aa1[_0x6d8cb3(0x1e7)],appendSystemMessage(_0x11cf47,_0x6d8cb3(0x238));if(chatMessages)chatMessages[_0x33c28f(0x1cc)]=_0x6d8cb3(0x165);enableChatInput(![]);}}function populateModelSelector(){const _0x7d44ad=_0x32b417;if(!modelSelect)return;modelSelect[_0x7d44ad(0x21f)]='',AVAILABLE_MODELS[_0x7d44ad(0x257)](_0x347563=>{const _0x11575b=_0x22b1,_0x1cb6b7=_0x7d44ad,_0x1d2851=document[_0x1cb6b7(0x270)]('option');_0x1d2851[_0x1cb6b7(0x278)]=_0x347563['id'],_0x1d2851[_0x11575b(0xb0)]=_0x347563[_0x1cb6b7(0x10d)],_0x347563['id']===currentModelId&&(_0x1d2851[_0x11575b(0x139)]=!![]),modelSelect[_0x11575b(0x155)](_0x1d2851);});}const toggleControlsBtn=document[_0x32b417(0x1ea)](_0x32b417(0x21a)),controlsContainer=document[_0x32b417(0x1ea)](_0x32b417(0x1c6));toggleControlsBtn&&controlsContainer&&(toggleControlsBtn[_0x32b417(0x15c)][_0x32b417(0x22f)](_0x32b417(0x243)),toggleControlsBtn[_0x32b417(0x248)](_0x2198df(0xbb),()=>{const _0xb7b26=_0x2198df,_0x1f7617=_0x32b417;controlsContainer[_0x1f7617(0x15c)][_0x1f7617(0x1c3)](_0x1f7617(0x135)),toggleControlsBtn[_0x1f7617(0x15c)][_0x1f7617(0x1c3)](_0xb7b26(0xeb));}),document[_0x32b417(0x248)](_0x32b417(0x1f3),_0x2eeba6=>{const _0x1f26aa=_0x2198df,_0x5afe31=_0x32b417;!controlsContainer['contains'](_0x2eeba6[_0x5afe31(0x1e0)])&&!toggleControlsBtn[_0x1f26aa(0x1da)](_0x2eeba6[_0x5afe31(0x1e0)])&&controlsContainer[_0x5afe31(0x15c)][_0x5afe31(0x1fa)](_0x5afe31(0x135))&&(controlsContainer[_0x5afe31(0x15c)][_0x5afe31(0x22f)](_0x5afe31(0x135)),toggleControlsBtn['classList'][_0x5afe31(0x22f)]('active'));})),connectedRef['on'](_0x32b417(0x278),_0x53e521=>{const _0xd34f4a=_0x2198df,_0x9182fe=_0x32b417,_0x5e1c13=_0x53e521[_0x9182fe(0x149)]();console[_0x9182fe(0x176)](_0x9182fe(0x16d),_0x5e1c13),statusIndicator&&(statusIndicator[_0x9182fe(0x15c)][_0x9182fe(0x1c3)](_0x9182fe(0x269),_0x5e1c13),statusIndicator[_0x9182fe(0x15c)][_0x9182fe(0x1c3)](_0xd34f4a(0x10f),!_0x5e1c13),statusIndicator[_0x9182fe(0x15c)][_0x9182fe(0x1c3)](_0x9182fe(0x240),!_0x5e1c13));if(statusText)statusText[_0x9182fe(0x13e)]=_0x5e1c13?_0x9182fe(0x1fd):_0x9182fe(0x19a);connectionStatus&&(connectionStatus[_0x9182fe(0x21f)]=_0x5e1c13?_0x9182fe(0x17c):_0x9182fe(0x1ce)),enableChatInput(_0x5e1c13),!_0x5e1c13?appendSystemMessage('Conexão\x20com\x20o\x20Firebase\x20perdida.\x20Tentando\x20reconectar...',_0x9182fe(0x238)):console[_0x9182fe(0x176)](_0x9182fe(0x227));}),modelSelect&&modelSelect[_0x32b417(0x248)](_0x32b417(0x1b3),_0x41ea04=>{const _0x2880ba=_0x2198df,_0x3c8307=_0x32b417,_0x59e303=_0x41ea04[_0x2880ba(0x195)][_0x2880ba(0xd1)];_0x59e303!==currentModelId&&(currentModelId=_0x59e303,console[_0x3c8307(0x176)](_0x3c8307(0x131)+currentModelId),loadChatHistoryAndInit());}),btnGeneralChat&&btnGeneralChat[_0x32b417(0x248)](_0x32b417(0x1f3),()=>{const _0x894f6a=_0x2198df,_0x1d01f1=_0x32b417;if(currentChatView!==_0x1d01f1(0x192)){currentChatView=_0x1d01f1(0x192),targetChatId=null;if(userSearchInput)userSearchInput[_0x894f6a(0xd1)]='';loadChatHistoryAndInit();}}),btnMyChat&&btnMyChat[_0x2198df(0x17d)](_0x32b417(0x1f3),()=>{const _0x102825=_0x2198df,_0xb06796=_0x32b417;if(!USER_DEVICE_ID){appendSystemMessage(_0xb06796(0x10b),_0x102825(0xd9)),showWelcomeModal();return;}if(currentChatView!=='own'){currentChatView=_0x102825(0x12d),targetChatId=null;if(userSearchInput)userSearchInput[_0xb06796(0x278)]='';loadChatHistoryAndInit();}}),btnOtherChat&&btnOtherChat[_0x32b417(0x248)](_0x32b417(0x1f3),()=>{const _0x517540=_0x2198df,_0x192e90=_0x32b417,_0x568ef0=userSearchInput[_0x192e90(0x278)][_0x192e90(0x111)]();if(!_0x568ef0){appendSystemMessage(_0x192e90(0x17a),_0x517540(0x1f1)),userSearchInput[_0x517540(0x133)]();return;}currentChatView=_0x192e90(0x154),loadChatHistoryAndInit();}),userSearchInput&&userSearchInput[_0x32b417(0x248)](_0x2198df(0x1f3),_0x352333=>{const _0x15f6db=_0x2198df,_0x1f15b1=_0x32b417;_0x352333[_0x1f15b1(0x274)]===_0x15f6db(0x1c3)&&(_0x352333[_0x15f6db(0x148)](),btnOtherChat[_0x1f15b1(0x1f3)]());}),messageForm&&messageForm[_0x32b417(0x248)](_0x32b417(0x230),async _0x1a4aa6=>{const _0x29cdbe=_0x2198df,_0x5501f6=_0x32b417;_0x1a4aa6[_0x5501f6(0x189)]();const _0x4c9bb4=messageInput[_0x5501f6(0x278)][_0x5501f6(0x111)]();if(!_0x4c9bb4)return;if(currentChatView==='other'){appendSystemMessage(_0x5501f6(0x183),_0x5501f6(0x238));return;}if(currentChatView!==_0x5501f6(0x192)&&currentChatView!==_0x5501f6(0x1bf)){appendSystemMessage(_0x29cdbe(0x166),_0x29cdbe(0xd9));return;}if(!USER_DEVICE_ID||!USERNAME){appendSystemMessage(_0x5501f6(0x118),_0x29cdbe(0xd9)),showWelcomeModal();return;}if(!chat){appendSystemMessage(_0x5501f6(0x1c0),_0x5501f6(0x238));return;}if(!genAI){appendSystemMessage(_0x5501f6(0x197),_0x5501f6(0x238));return;}let _0x2c48ba=null;const _0x283a55=sanitizeForFirebasePath(currentModelId);if(!_0x283a55){appendSystemMessage(_0x5501f6(0x253),_0x5501f6(0x238));return;}if(currentChatView===_0x29cdbe(0x16b))_0x2c48ba=_0x5501f6(0x144)+_0x283a55;else currentChatView===_0x5501f6(0x1bf)&&(_0x2c48ba=_0x29cdbe(0x1e4)+USER_DEVICE_ID+'/'+_0x283a55);if(!_0x2c48ba){appendSystemMessage(_0x5501f6(0x1df),_0x29cdbe(0xd9));return;}enableChatInput(![]);const _0x274faf={'text':_0x4c9bb4,'sender':_0x5501f6(0x15b),'timestamp':firebase[_0x5501f6(0x1fb)][_0x5501f6(0x204)][_0x5501f6(0x1d1)],'deviceId':USER_DEVICE_ID,'username':USERNAME},_0x475088=database[_0x29cdbe(0x1a3)](_0x2c48ba)[_0x5501f6(0x277)]();try{await _0x475088[_0x29cdbe(0xb2)](_0x274faf),console[_0x5501f6(0x176)](_0x5501f6(0x1e3)+USERNAME+'/'+USER_DEVICE_ID+_0x5501f6(0x107)+_0x2c48ba+':',_0x475088[_0x29cdbe(0x108)]),messageInput[_0x29cdbe(0xd1)]='',await getGeminiResponse(_0x4c9bb4);}catch(_0x3614da){console[_0x5501f6(0x238)](_0x5501f6(0x216),_0x3614da),appendSystemMessage(_0x5501f6(0x1d5),_0x5501f6(0x238)),enableChatInput(!![]);}finally{!messageInput[_0x29cdbe(0x13b)]&&messageInput[_0x5501f6(0x1b5)]();}}),saveUsernameBtn&&saveUsernameBtn[_0x32b417(0x248)](_0x32b417(0x1f3),handleSaveUsername),usernameInput&&usernameInput[_0x32b417(0x248)]('keypress',_0xb6b92a=>{const _0x4909e7=_0x2198df,_0x151a02=_0x32b417;_0xb6b92a[_0x4909e7(0x108)]===_0x151a02(0x212)&&handleSaveUsername();}),chatMessages&&chatMessages['addEventListener'](_0x32b417(0x255),()=>{const _0x1f2ba8=_0x32b417;chatMessages[_0x1f2ba8(0x22b)]===0x0&&!isLoadingMore&&loadMoreMessages();}),window[_0x32b417(0x248)](_0x2198df(0x169),()=>{const _0x238544=_0x2198df,_0xb49f87=_0x32b417;console[_0xb49f87(0x176)](_0x238544(0xd3)),populateModelSelector(),setupUser();if(messageInput)messageInput[_0xb49f87(0x1b5)]();console[_0xb49f87(0x176)](_0xb49f87(0x191));});
</script>

</body>
</html>
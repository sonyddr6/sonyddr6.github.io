<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Gemini Multi-View</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #94a3b8;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        @keyframes typingDots {
            0%, 20% { content: "."; }
            40% { content: ".."; }
            60%, 100% { content: "..."; }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .message-enter {
            animation: fadeIn 0.3s ease-out;
        }

        .typing-indicator::after {
            content: "...";
            animation: typingDots 1.5s infinite;
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        .chat-container {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .message-bubble {
            border-radius: 1.125rem 1.125rem 1.125rem 0;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.1));
            transition: all 0.3s ease;
        }

        .message-bubble.user {
            border-radius: 1.125rem 1.125rem 0 1.125rem;
        }

        .message-bubble:hover {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15));
        }

        .input-field {
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
        }

        .input-field:focus {
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
        }

        .send-button {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .send-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .send-button:active {
            transform: translateY(0);
        }

        .modal-content {
            animation: fadeIn 0.3s ease-out;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            background-color: var(--primary);
        }

        .bot-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--secondary);
            color: white;
        }

        .markdown-content p {
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .markdown-content ul, .markdown-content ol {
            margin-left: 1.25rem;
            margin-bottom: 0.75rem;
        }

        .markdown-content li {
            margin-bottom: 0.25rem;
        }

        .markdown-content code {
            background-color: rgba(0, 0, 0, 0.05);
            color: var(--danger);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9em;
        }

        .markdown-content pre {
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 0.375rem;
            padding: 0.75rem;
            overflow-x: auto;
            margin-bottom: 0.75rem;
        }

        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }

        .markdown-content a {
            color: var(--primary);
            text-decoration: underline;
        }

        .markdown-content a:hover {
            color: var(--primary-dark);
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @media (max-width: 640px) {
            .mobile-flex-col {
                flex-direction: column;
            }
            
            .mobile-w-full {
                width: 100% !important;
            }
            
            .mobile-mt-2 {
                margin-top: 0.5rem;
            }
        }
        @media (max-width: 768px) {
            .messages-container {
                width: 100%;
                max-width: 100%;
                padding: 10px;
                margin: 0 auto;
                box-sizing: border-box;
            }

            .message-bubble {
                margin: 8px 0;
                padding: 12px 15px;
                font-size: 16px;
                line-height: 1.5;
                background-color: #f5f5f5;
                border-radius: 10px;
                word-wrap: break-word;
            }

            .message-header,
            .message-footer {
                display: none;
            }

            #chat-messages {
                padding: 10px !important;
            }

            .user-avatar,
            .bot-avatar {
                width: 28px;
                height: 28px;
                font-size: 0.875rem;
            }

            .mobile-flex-col {
                flex-direction: column !important;
            }
            

            .mobile-w-full {
                width: 100% !important;
            }
        }

        /* Adicione estes estilos para controlar o menu móvel */
        @media (max-width: 768px) {
            .controls-container {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                padding: 10px;
                border-top: 1px solid #e5e7eb;
                transform: translateY(100%);
                transition: transform 0.3s ease-in-out;
                z-index: 40;
                box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            }

            .controls-container.active {
                transform: translateY(0);
            }

            .toggle-controls {
                position: fixed;
                bottom: 70px;
                right: 20px;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: var(--primary);
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                z-index: 41;
                transition: transform 0.3s ease;
            }

            .toggle-controls.active {
                transform: rotate(180deg);
            }

            /* Ajuste o espaçamento do container de mensagens */
            .chat-container {
                padding-bottom: 70px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans antialiased">

<!-- Welcome Modal -->
<div id="welcome-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="modal-content bg-white rounded-xl p-6 max-w-md w-full mx-4 transform transition-all">
        <div class="flex justify-center mb-4">
            <div class="gradient-bg text-white p-3 rounded-full animate-float">
                <i class="fas fa-robot text-2xl"></i>
            </div>
        </div>
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-4">Bem-vindo ao Chat Gemini!</h2>
        <p class="text-gray-600 text-center mb-4">Escolha um nome de usuário para começar</p>
        
        <div class="mb-4">
            <input type="text" id="username-input" placeholder="Seu nome de usuário" 
                   class="username-input input-field w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <p id="username-error" class="text-sm text-red-500 mt-2 h-4"></p>
        </div>
        
        <button id="save-username-btn" class="w-full gradient-bg text-white px-4 py-3 rounded-lg font-semibold transition-all hover:opacity-90 active:scale-95">
            <i class="fas fa-sign-in-alt mr-2"></i> Entrar no Chat
        </button>
        
        <p class="text-xs text-gray-500 mt-4 text-center">Seu nome será visível para outros usuários</p>
    </div>
</div>

<!-- Main Chat Container -->
<div class="container mx-auto max-w-4xl h-screen flex flex-col p-2 sm:p-4">
    <!-- Header -->
    <header class="gradient-bg text-white rounded-xl shadow-md p-3 mb-3 sm:mb-4 flex items-center justify-between">
        <div class="flex items-center space-x-3">
            <div class="bot-avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div>
                <h1 class="text-lg sm:text-xl font-bold">Chat Gemini</h1>
                <p class="text-xs opacity-80">Conecte-se e converse com IA</p>
            </div>
        </div>
        
        <div class="flex items-center space-x-3">
            <div id="user-info" class="flex items-center space-x-2">
                <div id="user-avatar" class="user-avatar hidden"></div>
                <div class="hidden sm:block">
                    <span id="username-display" class="text-sm font-medium">...</span>
                    <span class="text-xs opacity-70 block">ID: <span id="device-id-display">...</span></span>
                </div>
            </div>
            
            <div id="user-status" class="flex items-center space-x-1 bg-white bg-opacity-20 px-2 py-1 rounded-full">
                <span id="status-indicator" class="h-2 w-2 rounded-full bg-gray-300"></span>
                <span id="status-text" class="text-xs">Offline</span>
            </div>
        </div>
    </header>

    <!-- Botão toggle para controles móveis -->
    <button class="toggle-controls hidden md:hidden">
        <i class="fas fa-cog"></i>
    </button>

    <!-- Wrap os controles existentes em um container -->
    <div class="controls-container">
        <!-- Controls -->
        <div class="mb-3 sm:mb-4 bg-white rounded-xl shadow-sm p-3 flex flex-col md:flex-row gap-4 mobile-flex-col">
            <div class="w-full md:w-auto mobile-w-full">
                <label for="model-select" class="block text-sm font-medium text-gray-700 mb-1">Modelo de IA:</label>
                <select id="model-select" class="block w-full pl-3 pr-10 py-2 text-sm border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent input-field">
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            
            <div class="flex-grow mobile-w-full">
                <label class="block text-sm font-medium text-gray-700 mb-1">Visualização:</label>
                <div class="flex flex-wrap gap-2 items-center mobile-flex-col mobile-items-stretch">
                    <button id="btn-general-chat" class="chat-view-button chat-view-button-active px-4 py-2 rounded-lg text-sm font-medium transition-all">
                        <i class="fas fa-users mr-2"></i> Geral
                    </button>
                    <button id="btn-my-chat" class="chat-view-button px-4 py-2 rounded-lg text-sm font-medium transition-all">
                        <i class="fas fa-user mr-2"></i> Meu Chat
                    </button>
                    <div class="flex items-center gap-2 flex-grow mobile-w-full mobile-mt-2">
                        <input type="text" id="user-search-input" placeholder="Buscar usuário..." 
                               class="flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500 input-field">
                        <button id="btn-other-chat" class="chat-view-button px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap">
                            <i class="fas fa-search mr-2"></i> Buscar
                        </button>
                    </div>
                </div>
                <p class="text-xs text-gray-500 mt-2" id="current-chat-info">Visualizando: Chat Geral</p>
            </div>
        </div>
    </div>

    <!-- Chat Messages -->
    <div class="bg-white rounded-xl shadow-sm overflow-hidden flex flex-col flex-grow min-h-0 chat-container">
        <div id="chat-messages" class="p-3 sm:p-4 space-y-4 overflow-y-auto flex-grow min-h-0 scrollbar-hide">
            <div class="text-center text-gray-500 py-10 initial-message">
                <div class="gradient-bg text-white p-4 rounded-full inline-block mb-3 animate-float">
                    <i class="fas fa-comments text-2xl"></i>
                </div>
                <p class="text-sm sm:text-base font-medium">Carregando conversas...</p>
                <p class="text-xs mt-2">Aguarde enquanto carregamos as mensagens</p>
            </div>
        </div>
        
        <div id="typing-indicator" class="hidden bg-gray-50 px-4 py-3 text-gray-500 text-sm flex items-center">
            <div class="typing-dots flex space-x-1 mr-3">
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0ms"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 150ms"></div>
                <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 300ms"></div>
            </div>
            <span class="typing-indicator">Gemini está digitando</span>
        </div>
        
        <div class="border-t border-gray-200 p-3 bg-gray-50">
            <form id="message-form" class="flex space-x-2">
                <input id="message-input" type="text" placeholder="Digite sua mensagem..." 
                       class="flex-1 px-4 py-3 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base input-field" 
                       autocomplete="off" disabled>
                <button type="submit" aria-label="Enviar mensagem" 
                        class="gradient-bg text-white px-4 py-3 rounded-full transition-all send-button flex items-center justify-center" disabled>
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
            <div class="flex justify-between items-center mt-2">
                <span id="connection-status" class="text-xs text-gray-500 flex items-center">
                    <i class="fas fa-circle mr-1 text-gray-400"></i> Conectando...
                </span>
                <span id="message-count" class="text-xs text-gray-500">0 mensagens</span>
            </div>
        </div>
    </div>
</div>

<script type="module">
   const _0x5e3d45=_0x3e8b;(function(_0xb98055,_0x24c7f0){const _0x513611=_0x3e8b,_0x58ca1c=_0xb98055();while(!![]){try{const _0xde326e=parseInt(_0x513611(0x1d7))/0x1+parseInt(_0x513611(0x193))/0x2+-parseInt(_0x513611(0x15c))/0x3*(parseInt(_0x513611(0x256))/0x4)+parseInt(_0x513611(0x15a))/0x5*(-parseInt(_0x513611(0x164))/0x6)+parseInt(_0x513611(0x18e))/0x7*(-parseInt(_0x513611(0x135))/0x8)+-parseInt(_0x513611(0x187))/0x9+parseInt(_0x513611(0x175))/0xa;if(_0xde326e===_0x24c7f0)break;else _0x58ca1c['push'](_0x58ca1c['shift']());}catch(_0x4eda34){_0x58ca1c['push'](_0x58ca1c['shift']());}}}(_0x340f,0x19559));const _0x3eca66=_0x1b97;(function(_0x5015c8,_0x5154e1){const _0x16d5cb=_0x3e8b,_0x334606=_0x1b97,_0x26ae0a=_0x5015c8();while(!![]){try{const _0x3a3629=parseInt(_0x334606(0x1a0))/0x1+parseInt(_0x334606(0x1c1))/0x2+parseInt(_0x334606(0x20f))/0x3+parseInt(_0x334606(0x16c))/0x4*(parseInt(_0x334606(0x2ac))/0x5)+-parseInt(_0x334606(0x1cb))/0x6+parseInt(_0x334606(0x15c))/0x7*(parseInt(_0x334606(0x28d))/0x8)+parseInt(_0x334606(0x22b))/0x9*(-parseInt(_0x334606(0x249))/0xa);if(_0x3a3629===_0x5154e1)break;else _0x26ae0a[_0x16d5cb(0x1cf)](_0x26ae0a['shift']());}catch(_0x1e66d6){_0x26ae0a[_0x16d5cb(0x1cf)](_0x26ae0a[_0x16d5cb(0x279)]());}}}(_0x31ac,0x73ed8));import{GoogleGenerativeAI}from'https://esm.run/@google/generative-ai';const firebaseConfig={'apiKey':_0x3eca66(0x1a3),'authDomain':_0x3eca66(0x274),'projectId':_0x3eca66(0x23d),'storageBucket':_0x3eca66(0x232),'messagingSenderId':_0x3eca66(0x184),'appId':_0x3eca66(0x1f0),'measurementId':_0x5e3d45(0x1a9)},GEMINI_API_KEY=_0x3eca66(0x170),AVAILABLE_MODELS=[{'id':_0x5e3d45(0x230),'name':_0x3eca66(0x26e)}];function _0x3e8b(_0xb63799,_0x5b356d){const _0x340f25=_0x340f();return _0x3e8b=function(_0x3e8bd8,_0x12c375){_0x3e8bd8=_0x3e8bd8-0x121;let _0x95a9dd=_0x340f25[_0x3e8bd8];return _0x95a9dd;},_0x3e8b(_0xb63799,_0x5b356d);}let currentModelId=AVAILABLE_MODELS[0x0]['id'],currentChatView=_0x3eca66(0x233),targetChatId=null,USER_DEVICE_ID=null,USERNAME=null,genAI,chat=null,currentFirebaseListener=null,currentMessagesRef=null,isGeminiTyping=![],messageCounter=0x0,initialLoadComplete=![];try{firebase[_0x3eca66(0x254)](firebaseConfig);}catch(_0x476670){console[_0x3eca66(0x1cd)](_0x5e3d45(0x1a6),_0x476670),alert(_0x3eca66(0x24c));}function _0x340f(){const _0x1c067a=['response','\x20do\x20usuário\x20','AIzaSyBL7oI8tr3rseMyQW6ouPVwbfZKGUfwJ1s','Inicialização\x20do\x20Gemini\x20falhou\x20ou\x20referência\x20Firebase\x20inválida.\x20Listener\x20não\x20anexado.','150mRBbBk','15422290fWwWTr','child_added','my-2','justify-center','.toggle-controls','\x20rounded-xl\x20px-4\x20py-2\x20max-w-[90%]\x20sm:max-w-md\x20lg:max-w-lg\x20text-sm\x20text-center\x20system-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-','):\x20Chave\x20da\x20API\x20Gemini\x20inválida\x20ou\x20expirada.\x20Verifique\x20a\x20chave\x20no\x20código.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22','Erro\x20ao\x20comunicar\x20com\x20Gemini\x20ou\x20salvar\x20resposta\x20(','\x27\x20encontrado.\x20ID:\x20','value','justify-start','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','toLocaleTimeString','Nenhum\x20nome\x20de\x20usuário\x20local\x20encontrado.\x20Mostrando\x20modal.',',\x20Nome=','3848260BivuaP','bg-gray-100\x20text-gray-800','404','-latest','model-select','&lt;','\x20Para\x20ver\x20o\x20chat\x20de\x20outro\x20usuário,\x20as\x20regras\x20para\x20\x27/userChats/$userId\x27\x20devem\x20permitir\x20leitura.','Você\x20não\x20pode\x20enviar\x20mensagens\x20no\x20chat\x20de\x20outro\x20usuário.','<pre><code>','preventDefault','Este\x20nome\x20já\x20está\x20em\x20uso!','current-chat-info','Erro\x20de\x20rede\x20ao\x20tentar\x20contatar\x20','O\x20chat\x20não\x20pôde\x20ser\x20iniciado\x20corretamente.\x20O\x20envio\x20de\x20mensagens\x20está\x20deshabilitado.','scrollTop','active','API\x20key\x20not\x20valid','addEventListener','1407222DMNBIr','text-blue-600','warn','getElementById','#message-form\x20button[type=\x22submit\x22]','key','join','89299BEWzIn','off','Mensagem\x20do\x20usuário\x20(','Erro\x20interno:\x20ID\x20do\x20modelo\x20não\x20especificado.','message','249560XPCBMU','Nenhum\x20histórico\x20encontrado\x20para\x20','Por\x20favor,\x20insira\x20um\x20nome\x20de\x20usuário\x20ou\x20ID\x20para\x20buscar.','<div\x20class=\x22user-avatar\x22>','database',')\x20com\x20','exclamation-circle','animate-pulse','.controls-container','<p>','\x27\x20parece\x20ser\x20um\x20ID.\x20Verificando\x20existência...','Digite\x20um\x20nome\x20ou\x20ID\x20de\x20usuário\x20para\x20buscar.','Erro\x20desconhecido\x20na\x20API\x20Gemini.','&gt;','replace','save-username-btn','\x27\x20não\x20encontrado.</p></div>','1117510PknglW','ID\x20do\x20modelo\x20inválido\x20após\x20sanitização\x20para\x20salvar\x20resposta.','Erro\x20ao\x20inicializar\x20Firebase:','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20','userDeviceId','G-VD9JE84V5N','erro','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Erro\x20ao\x20buscar\x20username\x20no\x20Firebase:','Não\x20foi\x20possível\x20identificar\x20o\x20usuário\x20\x27','Tentativa\x20de\x20chamar\x20getGeminiResponse\x20em\x20view\x20inválida:','innerHTML','Erro\x20interno:\x20Não\x20foi\x20possível\x20determinar\x20onde\x20salvar\x20sua\x20mensagem.','orderByChild','Chat\x20(','Objeto\x20\x27chat\x27\x20não\x20inicializado\x20em\x20getGeminiResponse.','Tentativa\x20de\x20salvar\x20usuário\x20no\x20Firebase\x20sem\x20ID\x20ou\x20Nome.','TIMESTAMP','device-id-display','Enviando\x20para\x20Gemini\x20(','check-circle','<i\x20class=\x22fas\x20fa-circle\x20mr-1\x20text-green-500\x22></i>\x20Conectado','setItem','toString','btn-other-chat','Erro:\x20ID\x20do\x20dispositivo\x20do\x20usuário\x20não\x20definido\x20para\x20carregar\x20\x27Meu\x20Chat\x27.','length','usernames/','text-white','.info/connected','bg-red-500','bg-gray-100','\x27\x20não\x20encontrado\x20no\x20índice.','fetch','Desconectado\x20do\x20Firebase...','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x22><p>','Erro\x20Gemini\x20(','g1.5-','gradient-bg\x20text-white','Listener\x20Firebase\x20anexado\x20em\x20','Erro\x20ao\x20inicializar\x20SDK\x20Gemini:','):\x20Requisição\x20inválida\x20(400).\x20Pode\x20ser\x20um\x20problema\x20no\x20histórico\x20ou\x20configuração.','Listener\x20Firebase\x20desanexado\x20com\x20sucesso.','push','submit','1:1080485760423:web:8e4befd62dbf6106ff7a82','ID\x20do\x20modelo\x20não\x20fornecido\x20para\x20initGeminiChat.','match','<span\x20class=\x22text-xs\x20text-blue-700\x20ml-2\x22>','startChat','\x20-\x20','62004jcCCWE','Mensagem\x20com\x20texto\x20vazio\x20encontrada\x20no\x20histórico,\x20pulando\x20para\x20Gemini:','getItem','contains','⚠️\x20Lembre-se:\x20Para\x20ver\x20o\x20chat\x20de\x20outro\x20usuário,\x20as\x20Regras\x20de\x20Segurança\x20do\x20Firebase\x20devem\x20permitir\x20leitura\x20em\x20\x27userChats/','Nome\x20de\x20usuário\x20encontrado\x20localmente:\x20','button[type=\x22submit\x22]','\x20mr-2\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','hidden','flex','<li>','Offline','update','typing-indicator','\x27\x20(encontrado\x20ou\x20digitado)\x20não\x20existe\x20no\x20nó\x20/users.','Erro\x20ao\x20verificar\x20usuário.\x20Tente\x20novamente.','\x27,\x20Model=\x27','Erro\x20interno\x20ao\x20salvar\x20a\x20resposta.','deviceId','code','target','.\x20Verifique\x20sua\x20conexão.','Chat\x20de\x20','bg-red-100\x20text-red-800','.\x20Verifique\x20as\x20Regras\x20de\x20Segurança\x20do\x20Firebase\x20Database.','Listener\x20recebeu\x20snapshot\x20nulo:','Meu','text','keypress','message-input','Erro\x20ao\x20verificar.\x20Tente\x20novamente.','scrollHeight','<strong>$1</strong>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','<br>','createElement','includes','152028zkOFQm','):\x20Cota\x20da\x20API\x20Gemini\x20excedida.','info-circle','Usando\x20ID\x20de\x20dispositivo\x20existente:','substring','Visualizando:\x20','Erro\x20ao\x20salvar\x20dados\x20do\x20usuário\x20no\x20Firebase:','...</span>','AIzaSyDF5wOFJPEuhrlD9s0m1ZjYLg-IIPWsCRg','\x27\x20definido\x20e\x20salvo.','max','...','bg-green-100\x20text-green-800','.initial-message','<ol>','<a\x20href=\x22$2\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22\x20class=\x22text-indigo-600\x20hover:underline\x22>$1</a>','Dados\x20do\x20usuário\x20salvos\x20no\x20Firebase\x20com\x20sucesso.','own','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','once','Nenhum\x20listener/ref\x20Firebase\x20anterior\x20para\x20desanexar\x20(ou\x20um\x20deles\x20era\x20null).\x20Ref:','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-question-circle\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Não\x20foi\x20possível\x20encontrar\x20o\x20usuário.</p></div>','remove','Network\x20Error','error','trim','sendMessage','Interface\x20inicializada.','14BvWeIR','toUpperCase','</div>','Erro\x20crítico:\x20Não\x20foi\x20possível\x20conectar\x20ao\x20Firebase.','bloqueado','username','timestamp','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>','Modal\x20de\x20boas-vindas\x20não\x20encontrado\x20no\x20DOM.','.\x20A\x20funcionalidade\x20de\x20IA\x20pode\x20não\x20funcionar.','btn-general-chat','toggle','Erro\x20ao\x20buscar\x20nome\x20\x27','general','<ul>','text-gray-700','exists','Erro\x20de\x20Permissão\x20ao\x20acessar\x20','chat-view-button-active','Erro\x20crítico:\x20SDK\x20Gemini\x20não\x20disponível.','info','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-search\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Digite\x20um\x20nome\x20ou\x20ID\x20acima\x20para\x20ver\x20o\x20chat.</p></div>','welcome-modal','gemini-1.5-flash-latest','Iniciando\x20modelo:\x20','getFullYear','user-avatar','focus','gemini-1.5-','forEach','Não\x20foi\x20possível\x20determinar\x20o\x20caminho\x20del\x20chat\x20no\x20Firebase.','sort','quota','Usuário\x20\x27','toLowerCase','</li>','falha','...\x27\x20não\x20encontrado\x20no\x20banco\x20de\x20dados.','Usuário\x20com\x20ID\x20\x27','DOM\x20Carregado.\x20Iniciando\x20aplicação...','Histórico\x20inicial\x20carregado\x20para\x20','placeholder','Desanexando\x20listener\x20Firebase\x20anterior\x20da\x20Ref:','initializeApp','Liberando\x20nome\x20inativo\x20','admin','chat-messages','userChats/','Quota','</p></div>','Visualizando\x20chat\x20de\x20outro\x20usuário...','promptFeedback','Salvando/Atualizando\x20usuário\x20no\x20Firebase:\x20ID=','Mensagem\x20inválida\x20ou\x20sem\x20timestamp\x20encontrada\x20no\x20histórico:','other','generalChat/','Status\x20Conexão\x20Firebase:','Mensagem\x20de\x20erro\x20do\x20Gemini\x20salva\x20no\x20Firebase:','cursor-not-allowed',',\x20view:\x20','bg-green-500','283084byZUqP','Erro:\x20ID\x20do\x20modelo\x20inválido\x20ao\x20tentar\x20salvar\x20mensagem.','val','split','Erro\x20ao\x20tentar\x20desanexar\x20listener\x20Firebase:','selected','users/','Nome\x20de\x20usuário\x20\x27','ref','Falha\x20ao\x20inicializar\x20chat\x20(','9rljNJw','Erro\x20ao\x20salvar\x20mensagem\x20do\x20usuário\x20no\x20Firebase:','success','user','getTime','bg-blue-100\x20text-blue-900','\x20devido\x20a:\x20','\x20mensagens\x20no\x20histórico.','disabled','2-digit','1885911kFHdOy','\x20começando\x20em\x20','Erro\x20ao\x20verificar\x20existência\x20do\x20usuário\x20','message-count','Chave\x20da\x20API\x20Gemini\x20não\x20configurada!','string','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Carregando\x20mensagens...</p></div>','\x20mb-2\x20items-end\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Erro\x20crítico:\x20SDK\x20Gemini\x20não\x20disponível\x20para\x20enviar\x20mensagem.','<em>$1</em>','Erro:\x20ID\x20do\x20dispositivo\x20não\x20definido.','\x20px-4\x20py-3\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20mb-1\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>','message-form','</code></pre>','geral','shift','ServerValue','...)','SDK\x20Gemini\x20não\x20inicializado.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20','RESOURCE_EXHAUSTED','Falha\x20(','Usuário','startsWith','AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXX','Erro\x20ao\x20enviar\x20sua\x20mensagem.\x20Verifique\x20sua\x20conexão\x20e\x20tente\x20novamente.','msg-','Não\x20inicializando\x20objeto\x20de\x20chat\x20Gemini\x20para\x20view\x20\x27other\x27.','__CB_','username-error','Erro\x20ao\x20inicializar\x20Gemini\x20Chat\x20(','user-search-input','Esse\x20nome\x20não\x20é\x20permitido.','Inicializando\x20chat\x20(','\x20mt-2\x20text-right\x22>','Resposta\x20do\x20Gemini\x20salva\x20no\x20Firebase:','click','):\x20Cota\x20da\x20API\x20excedida.\x20Não\x20é\x20possível\x20processar\x20mais\x20mensagens\x20no\x20momento.','log','</p>','Não\x20foi\x20possível\x20determinar\x20o\x20caminho\x20para\x20salvar\x20a\x20resposta\x20do\x20Gemini.','Erro\x20grave\x20ao\x20carregar\x20o\x20histórico\x20do\x20chat.','104xirrqG','Online','hover:bg-gray-200','status-indicator','model','change','Buscando\x20usuário:\x20','Visualizando\x20chat\x20para\x20ID:\x20','textContent','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-slash\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Usuário\x20\x27','gaamini-teste-api','set','justify-end','Erro:\x20O\x20chat\x20não\x20está\x20pronto\x20para\x20receber\x20mensagens.','test','.chat-view-button','1080485760423','<div\x20class=\x22text-center\x20text-red-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-slash\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Usuário\x20não\x20existe.</p></div>','Digite\x20sua\x20mensagem...','classList','Erro\x20CRÍTICO\x20ao\x20carregar\x20histórico\x20ou\x20anexar\x20listener\x20para\x20','Erro\x20interno\x20ao\x20preparar\x20para\x20salvar\x20resposta.','DOMContentLoaded','Enter','connection-status','Gemini\x201.5\x20Flash','gaamini-teste-api.appspot.com','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble\x20user\x20','blockReason','&#039;','permission_denied','Iniciando\x20atualizações\x20de\x20status\x20de\x20atividade','opacity-50','now','\x20mensagens.','Novo\x20ID\x20de\x20dispositivo\x20criado:','Inicializando\x20chat...','820Vtwbdg','charAt','6HUegNe','\x27\x20não\x20encontrado.\x20Verifique\x20o\x20nome\x20ou\x20ID.','2158880hurGWC','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x20mr-2\x22></i>\x20Verificando...'];_0x340f=function(){return _0x1c067a;};return _0x340f();}const database=firebase[_0x3eca66(0x235)](),connectedRef=database[_0x3eca66(0x17c)](_0x3eca66(0x217));try{if(!GEMINI_API_KEY||GEMINI_API_KEY===_0x3eca66(0x1b4))throw new Error(_0x3eca66(0x278));genAI=new GoogleGenerativeAI(GEMINI_API_KEY);}catch(_0x115ac2){console[_0x3eca66(0x1cd)](_0x3eca66(0x18f),_0x115ac2),alert('Erro\x20crítico:\x20'+_0x115ac2[_0x3eca66(0x1e1)]+_0x3eca66(0x2ae)),document[_0x3eca66(0x1c6)]('message-input')[_0x5e3d45(0x268)]=!![],document[_0x3eca66(0x201)](_0x3eca66(0x210))[_0x3eca66(0x29e)]=!![];}const messageForm=document[_0x5e3d45(0x18a)](_0x5e3d45(0x276)),messageInput=document[_0x3eca66(0x1c6)](_0x3eca66(0x15f)),messageSubmitButton=messageForm[_0x3eca66(0x201)](_0x3eca66(0x1dc)),chatMessages=document[_0x3eca66(0x1c6)](_0x5e3d45(0x247)),typingIndicator=document[_0x3eca66(0x1c6)](_0x3eca66(0x1a8)),statusIndicator=document[_0x3eca66(0x1c6)](_0x3eca66(0x2a4)),statusText=document[_0x3eca66(0x1c6)](_0x3eca66(0x25b)),connectionStatus=document[_0x3eca66(0x1c6)](_0x5e3d45(0x14d)),messageCount=document[_0x3eca66(0x1c6)](_0x5e3d45(0x26d)),modelSelect=document[_0x3eca66(0x1c6)](_0x3eca66(0x24b)),deviceIdDisplay=document[_0x3eca66(0x1c6)](_0x3eca66(0x206)),btnGeneralChat=document[_0x3eca66(0x1c6)](_0x3eca66(0x24d)),btnMyChat=document[_0x5e3d45(0x18a)](_0x3eca66(0x1a7)),btnOtherChat=document[_0x5e3d45(0x18a)](_0x3eca66(0x238)),userSearchInput=document['getElementById'](_0x3eca66(0x2b6)),currentChatInfo=document[_0x3eca66(0x1c6)](_0x3eca66(0x1b7)),welcomeModal=document[_0x3eca66(0x1c6)](_0x3eca66(0x1f5)),usernameInput=document[_0x3eca66(0x1c6)](_0x3eca66(0x1ea)),saveUsernameBtn=document[_0x3eca66(0x1c6)](_0x3eca66(0x1ae)),usernameDisplay=document[_0x3eca66(0x1c6)](_0x3eca66(0x1ed)),usernameError=document[_0x3eca66(0x1c6)](_0x3eca66(0x2b4)),userAvatar=document[_0x3eca66(0x1c6)](_0x3eca66(0x187));function sanitizeForFirebasePath(_0x24f57b){const _0x4e464d=_0x3eca66;if(!_0x24f57b)return'';return _0x24f57b[_0x4e464d(0x1b1)](/[.#$[\]/]/g,'_');}function escapeHtml(_0x14de5c){const _0x44c5c5=_0x5e3d45,_0x2abddd=_0x3eca66;if(typeof _0x14de5c!==_0x2abddd(0x179))return'';return _0x14de5c[_0x2abddd(0x1b1)](/&/g,_0x2abddd(0x277))[_0x2abddd(0x1b1)](/</g,_0x2abddd(0x1bc))[_0x2abddd(0x1b1)](/>/g,_0x2abddd(0x1d0))[_0x44c5c5(0x1a1)](/"/g,'&quot;')[_0x2abddd(0x1b1)](/'/g,_0x2abddd(0x28e));}function formatMarkdown(_0x4fb0ee){const _0x43ca77=_0x5e3d45,_0x16d01d=_0x3eca66;if(typeof _0x4fb0ee!==_0x43ca77(0x26f))return'';const _0x1cf182={};let _0x4cea97=0x0,_0x219d72=_0x4fb0ee['replace'](/```([\s\S]*?)```/gs,(_0x5ab990,_0x40cc34)=>{const _0x13ee7c=_0x43ca77,_0x4f8dd1=_0x1b97,_0x5ad3ee=_0x4f8dd1(0x27a)+_0x4cea97++ +'__';return _0x1cf182[_0x5ad3ee]=_0x13ee7c(0x17d)+escapeHtml(_0x40cc34)+_0x4f8dd1(0x1df),_0x5ad3ee;});_0x219d72=_0x219d72[_0x43ca77(0x1a1)](/\[([^\]]+)\]\(([^)]+)\)/g,_0x16d01d(0x21d)),_0x219d72=_0x219d72[_0x16d01d(0x1b1)](/\*\*(.*?)\*\*/g,_0x43ca77(0x1f8)),_0x219d72=_0x219d72[_0x16d01d(0x1b1)](/(?<!\*)\*(?!\*)(.*?)(?<!\*)\*(?!\*)/g,_0x16d01d(0x2a6)),_0x219d72=_0x219d72[_0x16d01d(0x1b1)](/`([^`]+)`/g,(_0x42b78b,_0x2b92bf)=>_0x16d01d(0x279)+escapeHtml(_0x2b92bf)+_0x16d01d(0x273));const _0x5c6a87=_0x219d72[_0x16d01d(0x16d)]('\x0a');let _0x5d7cd5=[],_0x2dd4c1=null;_0x5c6a87[_0x16d01d(0x224)](_0x2420ca=>{const _0x2b6686=_0x43ca77,_0x530899=_0x16d01d,_0x2a3087=_0x2420ca[_0x530899(0x1be)](/^(\s*)([-*+])\s+(.*)/),_0x496fe2=_0x2420ca[_0x530899(0x1be)](/^(\s*)(\d+\.)\s+(.*)/);if(_0x2a3087){if(_0x2dd4c1!=='ul'){if(_0x2dd4c1)_0x5d7cd5[_0x530899(0x275)]('</'+_0x2dd4c1+'>');_0x5d7cd5[_0x2b6686(0x1cf)](_0x530899(0x2b9)),_0x2dd4c1='ul';}_0x5d7cd5[_0x2b6686(0x1cf)](_0x2b6686(0x1e2)+_0x2a3087[0x3]+_0x2b6686(0x23c));}else{if(_0x496fe2){if(_0x2dd4c1!=='ol'){if(_0x2dd4c1)_0x5d7cd5[_0x2b6686(0x1cf)]('</'+_0x2dd4c1+'>');_0x5d7cd5[_0x530899(0x275)](_0x2b6686(0x20b)),_0x2dd4c1='ol';}_0x5d7cd5[_0x530899(0x275)](_0x530899(0x1ab)+_0x496fe2[0x3]+_0x530899(0x1e2));}else _0x2dd4c1&&(_0x5d7cd5[_0x530899(0x275)]('</'+_0x2dd4c1+'>'),_0x2dd4c1=null),_0x5d7cd5[_0x530899(0x275)](_0x2420ca);}}),_0x2dd4c1&&_0x5d7cd5[_0x43ca77(0x1cf)]('</'+_0x2dd4c1+'>'),_0x219d72=_0x5d7cd5[_0x43ca77(0x18d)]('\x0a');for(const _0x411a61 in _0x1cf182){_0x219d72=_0x219d72[_0x16d01d(0x1b1)](_0x411a61,()=>_0x1cf182[_0x411a61]);}const _0x549d28=_0x219d72[_0x43ca77(0x259)](/\n\s*\n/)[_0x16d01d(0x2bd)](_0x21aa00=>_0x21aa00[_0x16d01d(0x28c)]())[_0x16d01d(0x16a)](_0x3fb868=>_0x3fb868)[_0x16d01d(0x2bd)](_0x542911=>{const _0x196ae1=_0x16d01d;if(_0x542911[_0x196ae1(0x1be)](/^<(ul|ol|pre|h[1-6]|li|blockquote)/))return _0x542911;return _0x196ae1(0x251)+_0x542911[_0x196ae1(0x1b1)](/\n/g,_0x196ae1(0x225))+_0x196ae1(0x22a);})[_0x16d01d(0x19b)]('');return _0x549d28;}function formatTime(_0x3d8bde){const _0x3f7656=_0x5e3d45,_0x481858=_0x3eca66;if(!_0x3d8bde||typeof _0x3d8bde!==_0x481858(0x197))return'';try{const _0xa678c0=new Date(_0x3d8bde);if(isNaN(_0xa678c0[_0x481858(0x20b)]()))return'';const _0x1209a6=new Date(),_0x43ce1b=_0xa678c0[_0x481858(0x281)]()===_0x1209a6['getDate']()&&_0xa678c0[_0x481858(0x260)]()===_0x1209a6[_0x481858(0x260)]()&&_0xa678c0[_0x481858(0x2a7)]()===_0x1209a6['getFullYear']();return _0x43ce1b?_0xa678c0[_0x481858(0x202)]([],{'hour':_0x481858(0x19d),'minute':_0x481858(0x19d)}):_0xa678c0[_0x481858(0x202)]([],{'day':_0x481858(0x19d),'month':_0x481858(0x19d),'year':_0x481858(0x19d),'hour':_0x3f7656(0x269),'minute':_0x481858(0x19d)});}catch(_0x1d930b){return console[_0x481858(0x1cd)]('Erro\x20formatar\x20hora:',_0x1d930b,_0x3d8bde),'';}}function scrollToBottom(){setTimeout(()=>{const _0x23b0b8=_0x1b97;if(chatMessages)chatMessages[_0x23b0b8(0x1e9)]=chatMessages[_0x23b0b8(0x193)];},0x64);}function updateMessageCountDisplay(){const _0x1a7c01=_0x5e3d45,_0x117146=_0x3eca66;let _0x2ced40=currentModelId[_0x117146(0x1b1)](_0x117146(0x19a),'')['replace'](_0x117146(0x211),_0x117146(0x1d5))[_0x117146(0x1b1)](_0x117146(0x27d),'g-'),_0x24190f='';if(currentChatView===_0x117146(0x233))_0x24190f=_0x117146(0x15d);else{if(currentChatView===_0x1a7c01(0x20e))_0x24190f=_0x117146(0x252);else{if(currentChatView===_0x117146(0x198)&&targetChatId)_0x24190f=_0x117146(0x1c4)+targetChatId[_0x117146(0x231)](0x0,0x6)+_0x117146(0x247);else _0x24190f='?';}}if(messageCount)messageCount[_0x117146(0x2a8)]=messageCounter+_0x117146(0x262)+_0x24190f+_0x117146(0x1ca)+_0x2ced40+')';}function updateChatInfoLabel(){const _0x573eb7=_0x5e3d45,_0x1c222f=_0x3eca66;let _0x23393b=_0x1c222f(0x1ad);if(currentChatView===_0x1c222f(0x233))_0x23393b+=_0x1c222f(0x1bb);else{if(currentChatView===_0x1c222f(0x29b))_0x23393b+=_0x1c222f(0x1c5);else{if(currentChatView===_0x1c222f(0x198)&&targetChatId)_0x23393b+=_0x573eb7(0x1ee)+targetChatId[_0x1c222f(0x231)](0x0,0x8)+_0x573eb7(0x208);else _0x23393b+=_0x1c222f(0x21f);}}if(currentChatInfo)currentChatInfo[_0x1c222f(0x2a8)]=_0x23393b;}function updateActiveButton(){const _0x16920e=_0x5e3d45,_0x58e0e2=_0x3eca66;document['querySelectorAll'](_0x16920e(0x144))[_0x58e0e2(0x224)](_0x5c3f8f=>{const _0x116e6d=_0x16920e,_0x5be200=_0x58e0e2;_0x5c3f8f[_0x5be200(0x1ee)][_0x5be200(0x1eb)](_0x5be200(0x1bf),_0x5be200(0x15b),_0x5be200(0x1d9)),_0x5c3f8f[_0x116e6d(0x148)][_0x5be200(0x24e)](_0x5be200(0x23a),_0x5be200(0x177),_0x5be200(0x1b3));});const _0xbe8fd9=currentChatView===_0x58e0e2(0x233)?_0x58e0e2(0x24d):currentChatView===_0x58e0e2(0x29b)?_0x58e0e2(0x1a7):currentChatView===_0x16920e(0x24f)?'btn-other-chat':null;if(_0xbe8fd9){const _0x5138ca=document[_0x58e0e2(0x1c6)](_0xbe8fd9);_0x5138ca&&(_0x5138ca[_0x58e0e2(0x1ee)][_0x58e0e2(0x24e)](_0x16920e(0x22b),_0x58e0e2(0x15b),_0x16920e(0x1c0)),_0x5138ca[_0x58e0e2(0x1ee)][_0x58e0e2(0x1eb)](_0x16920e(0x1c3),_0x58e0e2(0x177),_0x58e0e2(0x1b3)));}}function getOrCreateDeviceId(){const _0x25793e=_0x5e3d45,_0x4c6a68=_0x3eca66;let _0x2eb707=localStorage[_0x4c6a68(0x2ab)](_0x4c6a68(0x1ec));return!_0x2eb707?(_0x2eb707=_0x4c6a68(0x1a2)+Date[_0x4c6a68(0x1b5)]()+'-'+Math[_0x4c6a68(0x285)]()[_0x4c6a68(0x1a5)](0x24)[_0x25793e(0x201)](0x2,0x8),localStorage[_0x4c6a68(0x215)](_0x4c6a68(0x1ec),_0x2eb707),console[_0x4c6a68(0x284)](_0x4c6a68(0x218),_0x2eb707)):console['log'](_0x4c6a68(0x228),_0x2eb707),_0x2eb707;}function updateUserDisplay(){const _0x449a02=_0x5e3d45,_0x1039ed=_0x3eca66;if(USERNAME&&usernameDisplay)usernameDisplay[_0x1039ed(0x2a8)]=USERNAME,userAvatar&&(userAvatar[_0x1039ed(0x2a8)]=USERNAME[_0x1039ed(0x295)](0x0)[_0x1039ed(0x1f8)](),userAvatar[_0x449a02(0x148)][_0x449a02(0x213)](_0x1039ed(0x276)));else usernameDisplay&&(usernameDisplay[_0x1039ed(0x2a8)]=_0x1039ed(0x269));if(USER_DEVICE_ID&&deviceIdDisplay){const _0x90061c=USER_DEVICE_ID[_0x1039ed(0x231)](0x0,0x8)+'...';deviceIdDisplay[_0x1039ed(0x2a8)]=_0x90061c;}}async function saveUserToFirebase(){const _0x318424=_0x5e3d45,_0x26d6d1=_0x3eca66;if(!USER_DEVICE_ID||!USERNAME){console[_0x26d6d1(0x1cd)](_0x26d6d1(0x234));return;}console[_0x26d6d1(0x284)](_0x26d6d1(0x1c8)+USER_DEVICE_ID+_0x318424(0x174)+USERNAME);const _0x486e88=database[_0x318424(0x25e)](_0x26d6d1(0x192)+USER_DEVICE_ID),_0x150ae=database[_0x318424(0x25e)](_0x26d6d1(0x2ad)+USERNAME);try{await _0x486e88[_0x26d6d1(0x248)]({'username':USERNAME,'lastActive':firebase[_0x26d6d1(0x235)][_0x26d6d1(0x1ba)][_0x26d6d1(0x23f)]}),await _0x150ae[_0x26d6d1(0x1de)](USER_DEVICE_ID),console[_0x26d6d1(0x284)](_0x26d6d1(0x268));}catch(_0x3a14a8){console[_0x26d6d1(0x1cd)](_0x26d6d1(0x1a9),_0x3a14a8);}}function showWelcomeModal(){const _0x51e802=_0x5e3d45,_0x4972ba=_0x3eca66;if(welcomeModal){welcomeModal[_0x4972ba(0x1ee)][_0x4972ba(0x1eb)](_0x4972ba(0x276));if(usernameInput)usernameInput[_0x51e802(0x234)]();}else console[_0x4972ba(0x1cd)](_0x4972ba(0x1d4));}async function handleSaveUsername(){const _0x4b5b7e=_0x5e3d45,_0x5dd32a=_0x3eca66,_0x5a5ced=usernameInput[_0x5dd32a(0x2b1)][_0x5dd32a(0x28c)]()[_0x5dd32a(0x196)]();usernameError[_0x5dd32a(0x2a8)]='';if(_0x5a5ced[_0x5dd32a(0x1c7)]<0x3||_0x5a5ced[_0x4b5b7e(0x1be)]>0xf){usernameError[_0x5dd32a(0x2a8)]=_0x5dd32a(0x227);return;}if(!/^[a-z0-9]+(?:[_-]?[a-z0-9]+)*$/i[_0x4b5b7e(0x143)](_0x5a5ced)){usernameError[_0x4b5b7e(0x13d)]=_0x5dd32a(0x16e);return;}if([_0x5dd32a(0x161),_0x5dd32a(0x2a0),_0x5dd32a(0x26d),_0x5dd32a(0x188)][_0x5dd32a(0x2b7)](_0x5a5ced)){usernameError[_0x5dd32a(0x2a8)]=_0x5dd32a(0x1f9);return;}saveUsernameBtn[_0x5dd32a(0x29e)]=!![],saveUsernameBtn[_0x5dd32a(0x19f)]=_0x5dd32a(0x20e);try{const _0xf9c5be=await database[_0x5dd32a(0x17c)](_0x5dd32a(0x2ad)+_0x5a5ced)[_0x5dd32a(0x27f)](_0x4b5b7e(0x16f)),_0x50a7c1=_0xf9c5be[_0x5dd32a(0x23e)]();if(_0x50a7c1&&_0x50a7c1!==USER_DEVICE_ID){const _0x4459ef=database[_0x5dd32a(0x17c)](_0x4b5b7e(0x25c)+_0x50a7c1),_0x39cc41=await _0x4459ef[_0x5dd32a(0x27f)](_0x5dd32a(0x2b1)),_0x2bb483=_0x39cc41[_0x5dd32a(0x23e)]();if(_0x2bb483){const _0x14f5e3=_0x2bb483[_0x5dd32a(0x180)]||0x0,_0x46de65=Date[_0x5dd32a(0x1b5)](),_0x215295=0x5*0x3c*0x3e8;if(_0x46de65-_0x14f5e3<_0x215295){usernameError[_0x5dd32a(0x2a8)]=_0x5dd32a(0x293),saveUsernameBtn['disabled']=![],saveUsernameBtn[_0x5dd32a(0x19f)]=_0x5dd32a(0x18c);return;}else console[_0x5dd32a(0x284)](_0x5dd32a(0x2a5)+_0x5a5ced+_0x5dd32a(0x207)+_0x50a7c1),await database['ref'](_0x5dd32a(0x2ad)+_0x5a5ced)[_0x5dd32a(0x1de)](USER_DEVICE_ID),await _0x4459ef[_0x5dd32a(0x248)]({'username':null});}}USERNAME=_0x5a5ced,localStorage[_0x5dd32a(0x215)](_0x5dd32a(0x1fb),USERNAME);if(welcomeModal)welcomeModal[_0x5dd32a(0x1ee)][_0x5dd32a(0x24e)](_0x5dd32a(0x276));updateUserDisplay(),await saveUserToFirebase(),console[_0x5dd32a(0x284)](_0x4b5b7e(0x25d)+USERNAME+_0x5dd32a(0x1d7)),initialLoadComplete=!![],loadChatHistoryAndInit(),startActivityUpdates();}catch(_0x17d0f4){console[_0x5dd32a(0x1cd)](_0x5dd32a(0x258),_0x17d0f4),usernameError[_0x5dd32a(0x2a8)]=_0x5dd32a(0x294),saveUsernameBtn[_0x5dd32a(0x29e)]=![],saveUsernameBtn[_0x5dd32a(0x19f)]=_0x5dd32a(0x18c);}}function startActivityUpdates(){const _0x890426=_0x3eca66;console[_0x890426(0x284)](_0x890426(0x1e0)),setInterval(async()=>{const _0x1a0caa=_0x3e8b,_0x2b5858=_0x890426;if(USER_DEVICE_ID&&USERNAME)try{await database['ref'](_0x2b5858(0x192)+USER_DEVICE_ID)[_0x2b5858(0x248)]({'lastActive':firebase[_0x2b5858(0x235)][_0x2b5858(0x1ba)][_0x1a0caa(0x1b5)],'username':USERNAME});}catch(_0x4f6f15){console[_0x2b5858(0x1cd)](_0x2b5858(0x257),_0x4f6f15);}},0xea60);}async function setupUser(){const _0x2d673e=_0x5e3d45,_0x2f2e77=_0x3eca66;USER_DEVICE_ID=getOrCreateDeviceId();const _0x52df25=localStorage[_0x2f2e77(0x2ab)](_0x2f2e77(0x1fb));updateUserDisplay(),!_0x52df25?(console[_0x2f2e77(0x284)](_0x2d673e(0x173)),showWelcomeModal()):(USERNAME=_0x52df25,console[_0x2f2e77(0x284)](_0x2d673e(0x1dc)+USERNAME),updateUserDisplay(),await saveUserToFirebase(),initialLoadComplete=!![],loadChatHistoryAndInit(),startActivityUpdates());}async function initGeminiChat(_0x2a5405=[],_0x286a13){const _0x3cf44d=_0x5e3d45,_0x11fc0e=_0x3eca66;chat=null;if(currentChatView!==_0x11fc0e(0x233)&&currentChatView!==_0x11fc0e(0x29b))return console[_0x11fc0e(0x284)](_0x11fc0e(0x2aa),currentChatView),enableChatInput(![]),![];if(!genAI)return console[_0x11fc0e(0x1cd)](_0x11fc0e(0x272)),appendSystemMessage(_0x11fc0e(0x1fd),_0x11fc0e(0x1cd)),![];if(!_0x286a13)return console[_0x11fc0e(0x1cd)](_0x3cf44d(0x1d2)),appendSystemMessage(_0x11fc0e(0x1b8),_0x11fc0e(0x1cd)),![];appendSystemMessage(_0x3cf44d(0x12c)+currentChatView+_0x11fc0e(0x2b5)+_0x286a13+_0x11fc0e(0x269)),enableChatInput(![]);try{console[_0x11fc0e(0x284)](_0x3cf44d(0x231)+_0x286a13+_0x11fc0e(0x1d2)+currentChatView);const _0x49af0b=genAI[_0x11fc0e(0x2a9)]({'model':_0x286a13});return chat=_0x49af0b[_0x11fc0e(0x221)]({'history':_0x2a5405,'generationConfig':{'maxOutputTokens':0x7d0}}),console[_0x11fc0e(0x284)](_0x11fc0e(0x20c)+_0x286a13+_0x11fc0e(0x208)+currentChatView+_0x11fc0e(0x205)+_0x2a5405[_0x11fc0e(0x1c7)]+_0x11fc0e(0x2a1)),appendSystemMessage(_0x11fc0e(0x20c)+currentChatView+')\x20pronto.'),enableChatInput(!![]),!![];}catch(_0x5bd8d0){console[_0x11fc0e(0x1cd)](_0x11fc0e(0x1e8)+_0x286a13+_0x3cf44d(0x1d6)+currentChatView+'):',_0x5bd8d0);let _0x4378e3=_0x11fc0e(0x1b9)+currentChatView+_0x3cf44d(0x198)+_0x286a13+'.';if(_0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x11fc0e(0x2b7)](_0x11fc0e(0x288)))_0x4378e3='Falha\x20('+_0x286a13+_0x11fc0e(0x167);else{if(_0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x11fc0e(0x2b7)](_0x11fc0e(0x1db))||_0x5bd8d0[_0x3cf44d(0x192)]?.[_0x11fc0e(0x2b7)](_0x11fc0e(0x194)))_0x4378e3=_0x3cf44d(0x27f)+_0x286a13+_0x11fc0e(0x1bd);else{if(_0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x3cf44d(0x1fc)](_0x3cf44d(0x177)))_0x4378e3=_0x3cf44d(0x27f)+_0x286a13+_0x11fc0e(0x17a);else{if(_0x5bd8d0[_0x3cf44d(0x192)]?.[_0x11fc0e(0x2b7)](_0x11fc0e(0x209)))_0x4378e3='Falha\x20('+_0x286a13+_0x11fc0e(0x286);else _0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x3cf44d(0x1fc)](_0x11fc0e(0x169))||_0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x3cf44d(0x1fc)](_0x11fc0e(0x15e))||_0x5bd8d0[_0x11fc0e(0x1e1)]?.[_0x11fc0e(0x2b7)](_0x11fc0e(0x291))?_0x4378e3=_0x3cf44d(0x27f)+_0x286a13+_0x11fc0e(0x183):_0x4378e3=_0x3cf44d(0x27f)+_0x286a13+'):\x20'+(_0x5bd8d0[_0x3cf44d(0x192)]||_0x11fc0e(0x29f));}}}return appendSystemMessage(_0x4378e3,_0x3cf44d(0x215)),enableChatInput(![]),![];}}function appendMessage(_0x59c6ec,_0x1fb5a9=!![],_0x2925b8=null){const _0x34827f=_0x5e3d45,_0x209a3a=_0x3eca66;if(!_0x59c6ec||typeof _0x59c6ec[_0x34827f(0x1f3)]!==_0x209a3a(0x179)||!chatMessages)return;const _0x4548b7=chatMessages['querySelector'](_0x209a3a(0x26c));if(_0x4548b7)_0x4548b7[_0x209a3a(0x1eb)]();const _0x1662f4=document[_0x209a3a(0x204)](_0x209a3a(0x256));if(_0x1fb5a9)_0x1662f4[_0x209a3a(0x1ee)][_0x209a3a(0x24e)](_0x209a3a(0x20a));if(_0x2925b8)_0x1662f4['id']=_0x209a3a(0x1ef)+_0x2925b8;const _0xec92b=_0x59c6ec[_0x209a3a(0x230)],_0xec9009=_0x59c6ec[_0x209a3a(0x25a)]?formatTime(_0x59c6ec[_0x209a3a(0x25a)]):'',_0x53eb92=_0x59c6ec[_0x209a3a(0x1fc)]||null;if(_0x59c6ec[_0x209a3a(0x168)]===_0x209a3a(0x270)){const _0x2c0976=_0x53eb92===USER_DEVICE_ID,_0x43d546=_0x2c0976?_0x209a3a(0x292):_0x209a3a(0x1fe),_0x38c3c0=_0x2c0976?_0x34827f(0x1ca):_0x34827f(0x265),_0x23feee=!_0x2c0976&&_0x53eb92&&(currentChatView==='general'||currentChatView===_0x34827f(0x24f)),_0x57d39a=_0x23feee?_0x209a3a(0x29d)+_0x53eb92[_0x34827f(0x201)](0x0,0x6)+_0x209a3a(0x21b):'';_0x1662f4[_0x209a3a(0x19f)]=_0x209a3a(0x264)+_0x43d546+_0x209a3a(0x17b)+(!_0x2c0976?_0x209a3a(0x2bb)+(_0x59c6ec[_0x209a3a(0x1fb)]?.[_0x209a3a(0x295)](0x0)[_0x209a3a(0x1f8)]()||'?')+_0x34827f(0x21b):'')+_0x209a3a(0x185)+_0x38c3c0+_0x209a3a(0x261)+(_0x2c0976?_0x209a3a(0x164):_0x59c6ec[_0x34827f(0x21e)]||_0x34827f(0x121))+_0x209a3a(0x25e)+_0x57d39a+_0x209a3a(0x173)+escapeHtml(_0xec92b)+_0x209a3a(0x1da)+(_0x2c0976?_0x209a3a(0x18a):_0x209a3a(0x263))+_0x34827f(0x12d)+_0xec9009+_0x209a3a(0x166)+(_0x2c0976?_0x209a3a(0x2bb)+(USERNAME?.[_0x209a3a(0x295)](0x0)[_0x209a3a(0x1f8)]()||'?')+_0x209a3a(0x200):'')+_0x209a3a(0x222);}else{const _0x5cd89d=formatMarkdown(_0xec92b),_0x3e3a6d=_0x59c6ec[_0x209a3a(0x1f3)]||_0xec92b[_0x209a3a(0x196)]()[_0x209a3a(0x259)](_0x209a3a(0x181))||_0xec92b[_0x209a3a(0x196)]()[_0x209a3a(0x259)](_0x34827f(0x23d))||_0xec92b[_0x209a3a(0x196)]()[_0x209a3a(0x259)](_0x209a3a(0x29c))||_0xec92b[_0x209a3a(0x196)]()[_0x209a3a(0x2b7)]('não\x20foi\x20possível\x20processar'),_0x3b6ab6=_0x3e3a6d?_0x209a3a(0x160):_0x209a3a(0x250);_0x1662f4['innerHTML']=_0x209a3a(0x28b)+_0x3b6ab6+'\x20px-4\x20py-3\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20mb-1\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22font-medium\x22>Gemini</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22markdown-content\x22>'+_0x5cd89d+_0x209a3a(0x2a3)+_0xec9009+_0x34827f(0x1df);}chatMessages[_0x209a3a(0x199)](_0x1662f4),scrollToBottom();}function appendSystemMessage(_0x1c8f8f,_0x2b4e42='info'){const _0x93761b=_0x5e3d45,_0x5f37c3=_0x3eca66;if(!chatMessages)return;const _0x52a6ee=chatMessages['querySelector'](_0x5f37c3(0x26c));if(_0x52a6ee)_0x52a6ee[_0x5f37c3(0x1eb)]();const _0x39198f=document[_0x5f37c3(0x204)](_0x5f37c3(0x256));_0x39198f[_0x5f37c3(0x1ee)][_0x5f37c3(0x24e)](_0x5f37c3(0x20a),_0x5f37c3(0x27c),_0x93761b(0x168),_0x93761b(0x167));let _0x3ffe7a='bg-yellow-100\x20text-yellow-800';if(_0x2b4e42==='error')_0x3ffe7a=_0x5f37c3(0x160);else _0x2b4e42===_0x5f37c3(0x253)&&(_0x3ffe7a=_0x5f37c3(0x27b));_0x39198f[_0x5f37c3(0x19f)]=_0x5f37c3(0x246)+_0x3ffe7a+_0x5f37c3(0x178)+(_0x2b4e42===_0x5f37c3(0x1cd)?_0x5f37c3(0x237):_0x2b4e42===_0x5f37c3(0x253)?_0x5f37c3(0x28f):_0x93761b(0x1ff))+_0x5f37c3(0x299)+escapeHtml(_0x1c8f8f)+_0x5f37c3(0x27e),chatMessages[_0x5f37c3(0x199)](_0x39198f),scrollToBottom();}async function getGeminiResponse(_0x49c479){const _0x240eba=_0x5e3d45,_0x74f3ad=_0x3eca66;if(currentChatView!==_0x74f3ad(0x233)&&currentChatView!==_0x74f3ad(0x29b)){console[_0x240eba(0x189)](_0x74f3ad(0x18d),currentChatView);return;}if(!chat){console[_0x74f3ad(0x1cd)](_0x74f3ad(0x290)),appendSystemMessage(_0x74f3ad(0x2b0),_0x74f3ad(0x1cd)),enableChatInput(!![]);return;}if(!genAI){console[_0x74f3ad(0x1cd)](_0x74f3ad(0x272)),appendSystemMessage(_0x74f3ad(0x1fd),_0x74f3ad(0x1cd)),enableChatInput(!![]);return;}isGeminiTyping=!![];if(typingIndicator)typingIndicator['classList'][_0x74f3ad(0x1eb)](_0x240eba(0x1e0));scrollToBottom();const _0x5cc0cb=sanitizeForFirebasePath(currentModelId);if(!_0x5cc0cb){console[_0x74f3ad(0x1cd)](_0x240eba(0x1a5)),appendSystemMessage(_0x74f3ad(0x26a),_0x74f3ad(0x1cd)),isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x240eba(0x148)][_0x74f3ad(0x24e)](_0x74f3ad(0x276));enableChatInput(!![]);return;}let _0x54f37d=null;if(currentChatView===_0x74f3ad(0x233))_0x54f37d=_0x74f3ad(0x236)+_0x5cc0cb;else currentChatView===_0x74f3ad(0x29b)&&USER_DEVICE_ID&&(_0x54f37d=_0x240eba(0x248)+USER_DEVICE_ID+'/'+_0x5cc0cb);if(!_0x54f37d){console[_0x74f3ad(0x1cd)](_0x74f3ad(0x28a)),appendSystemMessage(_0x240eba(0x1e9),_0x74f3ad(0x1cd)),isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x240eba(0x148)][_0x74f3ad(0x24e)](_0x240eba(0x1e0));enableChatInput(!![]);return;}try{console[_0x74f3ad(0x284)](_0x240eba(0x1b7)+currentModelId+_0x74f3ad(0x208)+currentChatView+'):',_0x49c479);const _0x4cfd4b=await chat[_0x74f3ad(0x1f7)](_0x49c479),_0xbc34d9=await _0x4cfd4b[_0x74f3ad(0x1d6)],_0x4c007d=_0xbc34d9['text']();console[_0x74f3ad(0x284)](_0x74f3ad(0x213)+currentModelId+_0x74f3ad(0x208)+currentChatView+'):',_0x4c007d);const _0x18bb8a=database[_0x74f3ad(0x17c)](_0x54f37d)[_0x74f3ad(0x275)]();await _0x18bb8a[_0x74f3ad(0x1de)]({'text':_0x4c007d,'sender':_0x74f3ad(0x2a0),'timestamp':firebase[_0x74f3ad(0x235)][_0x74f3ad(0x1ba)][_0x74f3ad(0x23f)],'deviceId':null,'isError':![]}),console[_0x74f3ad(0x284)](_0x240eba(0x12e),_0x18bb8a['key']);}catch(_0x147429){console[_0x74f3ad(0x1cd)](_0x240eba(0x16d)+currentModelId+_0x74f3ad(0x208)+currentChatView+'):',_0x147429);let _0x182306=_0x74f3ad(0x1f2)+currentModelId+'.',_0x372047=!![];if(_0x147429[_0x74f3ad(0x1d6)]?.[_0x74f3ad(0x282)]?.[_0x74f3ad(0x22e)])_0x182306=_0x74f3ad(0x1cf)+currentModelId+_0x74f3ad(0x1b0)+_0x147429[_0x74f3ad(0x1d6)][_0x240eba(0x24c)][_0x74f3ad(0x22e)]+'.';else{if(_0x147429[_0x240eba(0x192)]?.['includes'](_0x74f3ad(0x291))||_0x147429[_0x74f3ad(0x1e1)]?.[_0x240eba(0x1fc)](_0x74f3ad(0x169)))_0x182306=_0x74f3ad(0x1f6)+currentModelId+_0x240eba(0x130);else{if(_0x147429[_0x240eba(0x192)]?.[_0x74f3ad(0x2b7)](_0x74f3ad(0x288)))_0x182306=_0x74f3ad(0x1f6)+currentModelId+_0x74f3ad(0x239),_0x372047=![];else{if(_0x147429[_0x74f3ad(0x1e1)]?.[_0x240eba(0x1fc)](_0x74f3ad(0x1db))||_0x147429[_0x240eba(0x192)]?.[_0x240eba(0x1fc)](_0x240eba(0x214)))_0x182306=_0x74f3ad(0x22f)+currentModelId+_0x240eba(0x1ed);else _0x147429[_0x74f3ad(0x1e1)]&&(_0x182306=_0x74f3ad(0x195)+currentModelId+_0x74f3ad(0x243)+_0x147429[_0x74f3ad(0x1e1)]);}}}const _0x47d438=database[_0x74f3ad(0x17c)](_0x54f37d)[_0x240eba(0x1cf)]();await _0x47d438[_0x240eba(0x140)]({'text':_0x182306,'sender':_0x74f3ad(0x2a0),'timestamp':firebase[_0x74f3ad(0x235)][_0x74f3ad(0x1ba)][_0x74f3ad(0x23f)],'deviceId':null,'isError':!![]}),console[_0x240eba(0x131)](_0x74f3ad(0x1d1),_0x47d438[_0x240eba(0x18c)]);}finally{isGeminiTyping=![];if(typingIndicator)typingIndicator[_0x74f3ad(0x1ee)][_0x74f3ad(0x24e)](_0x240eba(0x1e0));enableChatInput(!![]);}}function enableChatInput(_0x5ee977){const _0x3c10f5=_0x5e3d45,_0x1e7eef=_0x3eca66,_0x1a14d0=statusText[_0x1e7eef(0x2a8)]===_0x1e7eef(0x1c2),_0x6a4b1f=_0x5ee977&&(currentChatView===_0x1e7eef(0x233)||currentChatView===_0x1e7eef(0x29b))&&!!chat&&!isGeminiTyping&&_0x1a14d0;if(messageInput){messageInput[_0x1e7eef(0x29e)]=!_0x6a4b1f,messageInput[_0x1e7eef(0x1ee)][_0x3c10f5(0x224)](_0x1e7eef(0x23a),!_0x6a4b1f),messageInput[_0x1e7eef(0x1ee)][_0x1e7eef(0x289)](_0x1e7eef(0x22c),!_0x6a4b1f);if(!_0x1a14d0)messageInput[_0x3c10f5(0x242)]=_0x3c10f5(0x1c6);else{if(currentChatView===_0x1e7eef(0x198))messageInput[_0x1e7eef(0x26f)]=_0x1e7eef(0x16b);else{if(!chat&&(currentChatView===_0x1e7eef(0x233)||currentChatView===_0x1e7eef(0x29b)))messageInput[_0x1e7eef(0x26f)]=_0x1e7eef(0x22d);else{if(isGeminiTyping)messageInput[_0x1e7eef(0x26f)]='Aguardando\x20resposta\x20do\x20Gemini...';else!_0x6a4b1f?messageInput[_0x3c10f5(0x242)]=_0x1e7eef(0x1af):messageInput[_0x1e7eef(0x26f)]=_0x3c10f5(0x147);}}}}messageSubmitButton&&(messageSubmitButton[_0x1e7eef(0x29e)]=!_0x6a4b1f,messageSubmitButton[_0x1e7eef(0x1ee)][_0x1e7eef(0x289)](_0x1e7eef(0x191),!_0x6a4b1f),messageSubmitButton[_0x3c10f5(0x148)]['toggle'](_0x1e7eef(0x22c),!_0x6a4b1f));}async function loadChatHistoryAndInit(){const _0x12e4f2=_0x5e3d45,_0x5acfe5=_0x3eca66;if(!initialLoadComplete){console[_0x5acfe5(0x284)](_0x5acfe5(0x1c3));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x19e);return;}console[_0x5acfe5(0x284)]('Iniciando\x20carregamento:\x20View=\x27'+currentChatView+_0x12e4f2(0x1e8)+currentModelId+_0x5acfe5(0x245)+(targetChatId||(currentChatView===_0x5acfe5(0x233)?'Geral':_0x5acfe5(0x252)))+'\x27'),enableChatInput(![]);if(chatMessages)chatMessages[_0x12e4f2(0x1af)]=_0x5acfe5(0x283);messageCounter=0x0,updateMessageCountDisplay(),updateChatInfoLabel(),updateActiveButton();if(currentMessagesRef&&currentFirebaseListener){console[_0x5acfe5(0x284)](_0x5acfe5(0x266),currentMessagesRef[_0x5acfe5(0x1a5)]());try{currentMessagesRef[_0x5acfe5(0x21c)](_0x5acfe5(0x1e3),currentFirebaseListener),console[_0x5acfe5(0x284)](_0x5acfe5(0x1ac));}catch(_0x4ac882){console[_0x5acfe5(0x1cd)](_0x12e4f2(0x25a),_0x4ac882);}}else console[_0x12e4f2(0x131)](_0x5acfe5(0x18e),currentMessagesRef,'Listener:',typeof currentFirebaseListener);currentFirebaseListener=null,currentMessagesRef=null,chat=null,targetChatId=currentChatView===_0x5acfe5(0x198)?targetChatId:null;let _0x35d117=null;const _0xa41d33=sanitizeForFirebasePath(currentModelId);if(!_0xa41d33){const _0x58a946='Erro\x20crítico:\x20ID\x20do\x20modelo\x20inválido\x20após\x20sanitização.';console[_0x12e4f2(0x215)](_0x58a946),appendSystemMessage(_0x58a946,_0x5acfe5(0x1cd));if(chatMessages)chatMessages[_0x12e4f2(0x1af)]=_0x5acfe5(0x17e)+_0x58a946+_0x5acfe5(0x271);return;}if(currentChatView===_0x5acfe5(0x233))_0x35d117=_0x12e4f2(0x250)+_0xa41d33;else{if(currentChatView===_0x5acfe5(0x29b)&&USER_DEVICE_ID)_0x35d117=_0x5acfe5(0x26b)+USER_DEVICE_ID+'/'+_0xa41d33;else{if(currentChatView===_0x12e4f2(0x24f)){const _0x49fa1e=userSearchInput[_0x12e4f2(0x16f)][_0x5acfe5(0x28c)]();if(!_0x49fa1e){appendSystemMessage(_0x5acfe5(0x24a),_0x12e4f2(0x22d));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x25c);enableChatInput(![]);return;}appendSystemMessage(_0x12e4f2(0x13b)+_0x49fa1e+_0x5acfe5(0x269),_0x5acfe5(0x17f));let _0xbc66b3=null;if(!_0x49fa1e[_0x5acfe5(0x259)]('user-')){const _0x30d0df=_0x49fa1e[_0x5acfe5(0x196)]();try{const _0x4c037b=await database[_0x5acfe5(0x17c)](_0x12e4f2(0x1bf)+_0x30d0df)[_0x12e4f2(0x210)]('value');_0x4c037b[_0x5acfe5(0x165)]()?(_0xbc66b3=_0x4c037b[_0x5acfe5(0x23e)](),console[_0x5acfe5(0x284)](_0x12e4f2(0x25d)+_0x49fa1e+_0x5acfe5(0x240)+_0xbc66b3)):console[_0x5acfe5(0x284)](_0x5acfe5(0x223)+_0x49fa1e+_0x5acfe5(0x176));}catch(_0x312d6c){console[_0x12e4f2(0x215)](_0x5acfe5(0x21a),_0x312d6c),appendSystemMessage(_0x12e4f2(0x225)+_0x49fa1e+'\x27.',_0x12e4f2(0x215));}}if(!_0xbc66b3){if(_0x49fa1e[_0x12e4f2(0x122)](_0x5acfe5(0x1a2)))_0xbc66b3=_0x49fa1e,console[_0x12e4f2(0x131)]('Termo\x20\x27'+_0x49fa1e+_0x5acfe5(0x2ba));else{appendSystemMessage(_0x5acfe5(0x267)+_0x49fa1e+_0x5acfe5(0x1b6),_0x12e4f2(0x215));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x297)+escapeHtml(_0x49fa1e)+_0x5acfe5(0x171);enableChatInput(![]);return;}}if(_0xbc66b3)try{const _0x358bda=await database[_0x5acfe5(0x17c)](_0x5acfe5(0x192)+_0xbc66b3)[_0x5acfe5(0x27f)](_0x5acfe5(0x2b1));if(!_0x358bda[_0x5acfe5(0x165)]()){console[_0x5acfe5(0x174)](_0x5acfe5(0x1fa)+_0xbc66b3+_0x5acfe5(0x17d)),appendSystemMessage(_0x5acfe5(0x242)+_0xbc66b3[_0x5acfe5(0x231)](0x0,0x8)+_0x5acfe5(0x1e5),_0x5acfe5(0x1cd));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x2b3);enableChatInput(![]);return;}else targetChatId=_0xbc66b3,_0x35d117=_0x5acfe5(0x26b)+targetChatId+'/'+_0xa41d33,console[_0x5acfe5(0x284)](_0x5acfe5(0x1ff)+targetChatId),appendSystemMessage(_0x5acfe5(0x162)+targetChatId+'\x27.',_0x5acfe5(0x17f));}catch(_0x5d4988){console[_0x12e4f2(0x215)](_0x5acfe5(0x1a6)+_0xbc66b3+':',_0x5d4988),appendSystemMessage(_0x12e4f2(0x1e7),_0x12e4f2(0x215)),enableChatInput(![]);return;}else{appendSystemMessage(_0x12e4f2(0x1ad)+_0x49fa1e+'\x27.',_0x5acfe5(0x1cd));if(chatMessages)chatMessages[_0x12e4f2(0x1af)]=_0x5acfe5(0x212);enableChatInput(![]);return;}}}}if(!_0x35d117){const _0x40b5f5=currentChatView===_0x5acfe5(0x29b)&&!USER_DEVICE_ID?_0x5acfe5(0x23b):_0x12e4f2(0x237);console[_0x12e4f2(0x215)](_0x40b5f5),appendSystemMessage(_0x40b5f5,_0x5acfe5(0x1cd));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x12e4f2(0x1c7)+_0x40b5f5+_0x5acfe5(0x271);enableChatInput(![]);return;}currentMessagesRef=database[_0x5acfe5(0x17c)](_0x35d117),console[_0x5acfe5(0x284)](_0x5acfe5(0x241)+_0x35d117);try{const _0xa98ea3=await currentMessagesRef[_0x5acfe5(0x1c0)](_0x5acfe5(0x25a))['limitToLast'](0x32)[_0x5acfe5(0x27f)]('value'),_0x2f15fa=_0xa98ea3[_0x5acfe5(0x23e)](),_0x3cad89=[];let _0x2db57e=0x0;if(chatMessages)chatMessages['innerHTML']='';if(_0x2f15fa){console[_0x5acfe5(0x284)](_0x12e4f2(0x241)+currentChatView+':\x20'+Object[_0x5acfe5(0x265)](_0x2f15fa)[_0x5acfe5(0x1c7)]+_0x12e4f2(0x157));const _0x451d95=Object[_0x5acfe5(0x265)](_0x2f15fa)[_0x12e4f2(0x238)]((_0x570732,_0x124064)=>_0x2f15fa[_0x570732][_0x5acfe5(0x25a)]-_0x2f15fa[_0x124064][_0x12e4f2(0x21f)]);_0x451d95[_0x5acfe5(0x224)](_0x479df5=>{const _0xf51b39=_0x12e4f2,_0x52f809=_0x5acfe5;messageCounter++;const _0x58cca9=_0x2f15fa[_0x479df5];if(_0x58cca9&&_0x58cca9[_0xf51b39(0x21f)]){appendMessage(_0x58cca9,![],_0x479df5),_0x2db57e=Math[_0xf51b39(0x207)](_0x2db57e,_0x58cca9[_0x52f809(0x25a)]);if((currentChatView===_0x52f809(0x233)||currentChatView===_0x52f809(0x29b))&&typeof _0x58cca9[_0xf51b39(0x1f3)]===_0x52f809(0x179)&&!_0x58cca9[_0x52f809(0x1f3)]){const _0x1b2b17=_0x58cca9[_0x52f809(0x168)]===_0xf51b39(0x263)?_0x52f809(0x270):_0x52f809(0x15a),_0x111985=_0x58cca9[_0x52f809(0x230)];_0x111985[_0x52f809(0x28c)]()?_0x3cad89[_0x52f809(0x275)]({'role':_0x1b2b17,'parts':[{'text':_0x111985}]}):console['warn'](_0x52f809(0x1f4),_0x479df5);}}else console[_0x52f809(0x174)](_0x52f809(0x2af),_0x479df5,_0x58cca9);});if(_0x451d95[_0x5acfe5(0x1c7)]===0x0){if(chatMessages)chatMessages[_0x12e4f2(0x1af)]=_0x5acfe5(0x255);}}else{console[_0x12e4f2(0x131)](_0x5acfe5(0x175)+_0x35d117+'.');if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x255);}updateMessageCountDisplay(),scrollToBottom();let _0x524119=![];currentChatView===_0x5acfe5(0x233)||currentChatView===_0x5acfe5(0x29b)?_0x524119=await initGeminiChat(_0x3cad89,currentModelId):(_0x524119=!![],console[_0x5acfe5(0x284)](_0x5acfe5(0x29a)),enableChatInput(![]));if(_0x524119&&currentMessagesRef){currentFirebaseListener=_0x13382a=>{const _0x481e1b=_0x12e4f2,_0x3ea9d4=_0x5acfe5,_0x22f8d2=_0x13382a[_0x481e1b(0x258)](),_0x1e6fc3=_0x13382a[_0x3ea9d4(0x287)];if(_0x22f8d2&&!document['getElementById'](_0x3ea9d4(0x1ef)+_0x1e6fc3))console[_0x3ea9d4(0x284)](_0x3ea9d4(0x1d3)+currentChatView+'):',_0x1e6fc3),messageCounter++,appendMessage(_0x22f8d2,!![],_0x1e6fc3),updateMessageCountDisplay();else!_0x22f8d2&&console[_0x3ea9d4(0x174)](_0x3ea9d4(0x214),_0x1e6fc3);};const _0x26d2d5=_0x2db57e>0x0?_0x2db57e+0x1:Date[_0x5acfe5(0x1b5)]();currentMessagesRef[_0x5acfe5(0x1c0)](_0x5acfe5(0x25a))['startAt'](_0x26d2d5)['on'](_0x5acfe5(0x1e3),currentFirebaseListener),console[_0x5acfe5(0x284)](_0x5acfe5(0x2a2)+_0x35d117+_0x5acfe5(0x203)+new Date(_0x26d2d5)['toISOString']()),currentChatView!==_0x5acfe5(0x198)&&enableChatInput(_0x524119);}else console[_0x5acfe5(0x174)](_0x5acfe5(0x244)),!_0x524119&&(currentChatView===_0x12e4f2(0x226)||currentChatView===_0x5acfe5(0x29b))&&appendSystemMessage(_0x12e4f2(0x182),_0x5acfe5(0x1cd)),enableChatInput(![]);}catch(_0x2da3a0){console[_0x5acfe5(0x1cd)](_0x12e4f2(0x149)+_0x35d117+':',_0x2da3a0);let _0x32aacb=_0x12e4f2(0x134);_0x2da3a0[_0x5acfe5(0x1e1)]?.[_0x5acfe5(0x196)]()[_0x5acfe5(0x2b7)](_0x5acfe5(0x19c))||_0x2da3a0[_0x12e4f2(0x1eb)]?.[_0x5acfe5(0x196)]()[_0x12e4f2(0x1fc)](_0x12e4f2(0x153))?(_0x32aacb=_0x5acfe5(0x172)+_0x35d117+_0x5acfe5(0x1e7),currentChatView===_0x5acfe5(0x198)&&(_0x32aacb+=_0x5acfe5(0x1a4))):_0x32aacb+=_0x5acfe5(0x2bc)+_0x2da3a0[_0x12e4f2(0x192)],appendSystemMessage(_0x32aacb,_0x12e4f2(0x215));if(chatMessages)chatMessages[_0x5acfe5(0x19f)]=_0x5acfe5(0x1c9);enableChatInput(![]);}}function _0x31ac(){const _0x2ca1a2=_0x5e3d45,_0x1c4d5b=[_0x2ca1a2(0x221),_0x2ca1a2(0x1c9),_0x2ca1a2(0x160),_0x2ca1a2(0x206),_0x2ca1a2(0x1da),_0x2ca1a2(0x1c0),_0x2ca1a2(0x1a7),_0x2ca1a2(0x1c5),_0x2ca1a2(0x1dd),_0x2ca1a2(0x1c2),_0x2ca1a2(0x140),_0x2ca1a2(0x277),_0x2ca1a2(0x154),_0x2ca1a2(0x192),_0x2ca1a2(0x23c),_0x2ca1a2(0x166),_0x2ca1a2(0x234),_0x2ca1a2(0x23e),'Erro:\x20O\x20objeto\x20de\x20chat\x20não\x20está\x20inicializado.',_0x2ca1a2(0x1f0),_0x2ca1a2(0x129),_0x2ca1a2(0x183),'username-input',_0x2ca1a2(0x213),_0x2ca1a2(0x1a8),'username-display',_0x2ca1a2(0x148),_0x2ca1a2(0x125),_0x2ca1a2(0x1d1),')\x20salva\x20em\x20','Erro\x20ao\x20processar\x20sua\x20mensagem\x20com\x20','isError',_0x2ca1a2(0x1d8),_0x2ca1a2(0x22f),'Erro\x20(',_0x2ca1a2(0x217),_0x2ca1a2(0x21a),_0x2ca1a2(0x12b),'ID\x20\x27',_0x2ca1a2(0x21e),_0x2ca1a2(0x1ea),_0x2ca1a2(0x22c),_0x2ca1a2(0x170),_0x2ca1a2(0x13c),_0x2ca1a2(0x21b),'querySelector',_0x2ca1a2(0x172),_0x2ca1a2(0x26b),_0x2ca1a2(0x1fb),')\x20inicializado\x20com\x20',_0x2ca1a2(0x1b6),_0x2ca1a2(0x161),_0x2ca1a2(0x1d6),'400','message-enter',_0x2ca1a2(0x264),_0x2ca1a2(0x1b2),'<i\x20class=\x22fas\x20fa-circle\x20mr-1\x20text-red-500\x22></i>\x20Desconectado',_0x2ca1a2(0x15f),_0x2ca1a2(0x26a),_0x2ca1a2(0x18b),_0x2ca1a2(0x235),_0x2ca1a2(0x212),'Resposta\x20recebida\x20de\x20Gemini\x20(',_0x2ca1a2(0x1f1),_0x2ca1a2(0x1ba),_0x2ca1a2(0x169),_0x2ca1a2(0x1c1),_0x2ca1a2(0x158),'Não\x20é\x20possível\x20enviar\x20mensagens\x20nesta\x20visualização.',_0x2ca1a2(0x1ac),_0x2ca1a2(0x204),_0x2ca1a2(0x18f),_0x2ca1a2(0x20c),_0x2ca1a2(0x218),'Desconhecido',_0x2ca1a2(0x17e),_0x2ca1a2(0x1d5),_0x2ca1a2(0x171),_0x2ca1a2(0x25d),_0x2ca1a2(0x236),_0x2ca1a2(0x1fa),_0x2ca1a2(0x261),'Nome\x20deve\x20ter\x20entre\x203\x20e\x2015\x20caracteres.',_0x2ca1a2(0x200),_0x2ca1a2(0x1f4),_0x2ca1a2(0x132),_0x2ca1a2(0x260),_0x2ca1a2(0x253),_0x2ca1a2(0x159),_0x2ca1a2(0x151),_0x2ca1a2(0x181),'text',_0x2ca1a2(0x201),_0x2ca1a2(0x14f),_0x2ca1a2(0x226),_0x2ca1a2(0x1b4),_0x2ca1a2(0x197),_0x2ca1a2(0x250),_0x2ca1a2(0x199),_0x2ca1a2(0x1bc),'):\x20Chave\x20da\x20API\x20inválida.\x20Verifique\x20a\x20configuração.',_0x2ca1a2(0x1c3),_0x2ca1a2(0x1bd),_0x2ca1a2(0x19e),_0x2ca1a2(0x13f),_0x2ca1a2(0x258),_0x2ca1a2(0x1b5),_0x2ca1a2(0x16e),'Definida\x20nova\x20referência\x20Firebase\x20para:\x20',_0x2ca1a2(0x23f),'):\x20',_0x2ca1a2(0x163),'\x27,\x20Target=\x27',_0x2ca1a2(0x16c),_0x2ca1a2(0x27b),_0x2ca1a2(0x1e4),_0x2ca1a2(0x165),_0x2ca1a2(0x195),_0x2ca1a2(0x179),_0x2ca1a2(0x21c),_0x2ca1a2(0x223),'add',_0x2ca1a2(0x19a),_0x2ca1a2(0x176),_0x2ca1a2(0x19c),_0x2ca1a2(0x1f2),_0x2ca1a2(0x262),_0x2ca1a2(0x244),'<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-comments\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Nenhuma\x20mensagem\x20neste\x20chat\x20ainda.</p></div>','div','Erro\x20ao\x20atualizar\x20status\x20de\x20atividade:','Erro\x20ao\x20verificar/salvar\x20nome\x20de\x20usuário:',_0x2ca1a2(0x122),'timestamp','status-text',_0x2ca1a2(0x22e),_0x2ca1a2(0x190),_0x2ca1a2(0x20f),_0x2ca1a2(0x251),'getMonth',_0x2ca1a2(0x275),'\x20mensagens\x20(',_0x2ca1a2(0x188),_0x2ca1a2(0x27d),'keys',_0x2ca1a2(0x243),_0x2ca1a2(0x23a),_0x2ca1a2(0x20d),_0x2ca1a2(0x208),_0x2ca1a2(0x14a),_0x2ca1a2(0x248),_0x2ca1a2(0x20a),_0x2ca1a2(0x278),_0x2ca1a2(0x14e),_0x2ca1a2(0x242),_0x2ca1a2(0x263),_0x2ca1a2(0x24a),_0x2ca1a2(0x27c),'</code>','gaamini-teste-api.firebaseapp.com',_0x2ca1a2(0x1cf),'hidden','&amp;',_0x2ca1a2(0x26e),'<code>',_0x2ca1a2(0x127),_0x2ca1a2(0x209),_0x2ca1a2(0x1e1),'gemini-',_0x2ca1a2(0x1f9),_0x2ca1a2(0x210),_0x2ca1a2(0x1e3),'getDate',_0x2ca1a2(0x24c),_0x2ca1a2(0x270),_0x2ca1a2(0x131),'random',_0x2ca1a2(0x1cd),_0x2ca1a2(0x18c),_0x2ca1a2(0x185),_0x2ca1a2(0x224),_0x2ca1a2(0x133),'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-start\x20mb-2\x20items-end\x20gap-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bot-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-robot\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble\x20',_0x2ca1a2(0x216),_0x2ca1a2(0x15e),_0x2ca1a2(0x152),_0x2ca1a2(0x1b8),_0x2ca1a2(0x1b3),_0x2ca1a2(0x27e),_0x2ca1a2(0x141),_0x2ca1a2(0x17f),_0x2ca1a2(0x1f6),_0x2ca1a2(0x15b),'addEventListener',_0x2ca1a2(0x13e),_0x2ca1a2(0x1b0),_0x2ca1a2(0x1de),_0x2ca1a2(0x126),_0x2ca1a2(0x20e),_0x2ca1a2(0x21d),_0x2ca1a2(0x1d4),'disabled',_0x2ca1a2(0x19f),'gemini',_0x2ca1a2(0x267),_0x2ca1a2(0x1cb),_0x2ca1a2(0x220),_0x2ca1a2(0x138),_0x2ca1a2(0x245),_0x2ca1a2(0x273),_0x2ca1a2(0x232),_0x2ca1a2(0x13d),'getGenerativeModel','Não\x20inicializando\x20objeto\x20\x27chat\x27\x20para\x20a\x20view:',_0x2ca1a2(0x1d9),'125ZhPwir',_0x2ca1a2(0x1bf),_0x2ca1a2(0x222),_0x2ca1a2(0x24e),_0x2ca1a2(0x142),'value',_0x2ca1a2(0x184),_0x2ca1a2(0x146),_0x2ca1a2(0x128),_0x2ca1a2(0x198),_0x2ca1a2(0x12a),_0x2ca1a2(0x1fc),_0x2ca1a2(0x17c),_0x2ca1a2(0x227),_0x2ca1a2(0x19d),_0x2ca1a2(0x196),'\x20Detalhes:\x20','map',_0x2ca1a2(0x139),'gradient-bg',_0x2ca1a2(0x219),'Geral',_0x2ca1a2(0x239),_0x2ca1a2(0x1f5),_0x2ca1a2(0x1ef),_0x2ca1a2(0x246),_0x2ca1a2(0x1db),'Modelo\x20selecionado:\x20','Você',_0x2ca1a2(0x229),_0x2ca1a2(0x1ab),_0x2ca1a2(0x16b),'sender',_0x2ca1a2(0x249),'filter',_0x2ca1a2(0x24b),'117020kMMvar',_0x2ca1a2(0x259),'Use\x20apenas\x20letras,\x20números,\x20_\x20ou\x20-.\x20Sem\x20espaços.',_0x2ca1a2(0x19b),_0x2ca1a2(0x205),_0x2ca1a2(0x1a3),_0x2ca1a2(0x22a),'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','warn',_0x2ca1a2(0x194),_0x2ca1a2(0x1c4),_0x2ca1a2(0x228),_0x2ca1a2(0x16a),_0x2ca1a2(0x26f),'):\x20Modelo\x20não\x20encontrado\x20(404).\x20Verifique\x20o\x20ID\x20do\x20modelo.',_0x2ca1a2(0x271),_0x2ca1a2(0x25e),_0x2ca1a2(0x1e6),_0x2ca1a2(0x1c7),_0x2ca1a2(0x22d),'lastActive',_0x2ca1a2(0x1aa),_0x2ca1a2(0x14c),_0x2ca1a2(0x1fe),_0x2ca1a2(0x145),_0x2ca1a2(0x150),_0x2ca1a2(0x25b),_0x2ca1a2(0x233),'sistema','name','text-indigo-200',_0x2ca1a2(0x240),'<i\x20class=\x22fas\x20fa-sign-in-alt\x20mr-2\x22></i>\x20Entrar\x20no\x20Chat',_0x2ca1a2(0x1ae),_0x2ca1a2(0x211),_0x2ca1a2(0x1cc),'Conexão\x20com\x20o\x20Firebase\x20perdida.\x20Tentando\x20reconectar...',_0x2ca1a2(0x155),_0x2ca1a2(0x25c),_0x2ca1a2(0x1f7),_0x2ca1a2(0x214),_0x2ca1a2(0x1c8),_0x2ca1a2(0x23b),'number','other','appendChild',_0x2ca1a2(0x178),_0x2ca1a2(0x18d),_0x2ca1a2(0x153),_0x2ca1a2(0x269),'<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-user-clock\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Por\x20favor,\x20defina\x20seu\x20nome\x20de\x20usuário\x20primeiro.</p></div>',_0x2ca1a2(0x1af),_0x2ca1a2(0x1fd),_0x2ca1a2(0x124),'user-',_0x2ca1a2(0x162),_0x2ca1a2(0x17b),_0x2ca1a2(0x1bb),_0x2ca1a2(0x26c),'btn-my-chat',_0x2ca1a2(0x1e5),_0x2ca1a2(0x203),'Erro:\x20Usuário\x20não\x20configurado\x20corretamente.',_0x2ca1a2(0x1e2),_0x2ca1a2(0x1ce),_0x2ca1a2(0x202),_0x2ca1a2(0x1a2),'Carregando\x20ou\x20indisponível...',_0x2ca1a2(0x266),_0x2ca1a2(0x1a1),_0x2ca1a2(0x1ec),_0x2ca1a2(0x137),_0x2ca1a2(0x123),_0x2ca1a2(0x156),_0x2ca1a2(0x15d),_0x2ca1a2(0x180),_0x2ca1a2(0x191),_0x2ca1a2(0x25f),_0x2ca1a2(0x27a),'Chat\x20Geral',_0x2ca1a2(0x17a),'):\x20Erro\x20de\x20rede\x20ao\x20contatar\x20a\x20API\x20Gemini.\x20Verifique\x20sua\x20conexão.',_0x2ca1a2(0x1d3),_0x2ca1a2(0x22b),_0x2ca1a2(0x1b1),_0x2ca1a2(0x1a4),_0x2ca1a2(0x136),'Aguardando\x20configuração\x20inicial\x20do\x20usuário\x20antes\x20de\x20carregar\x20o\x20chat.','Outro\x20(','Meu\x20Chat\x20Pessoal',_0x2ca1a2(0x18a),_0x2ca1a2(0x1be),_0x2ca1a2(0x24d),'<div\x20class=\x22text-center\x20text-red-500\x20py-10\x22><p>Erro\x20ao\x20carregar\x20dados!\x20Verifique\x20as\x20permissões\x20ou\x20o\x20console\x20para\x20detalhes.</p></div>','\x20/\x20','3560676zWZuBW',_0x2ca1a2(0x12f),_0x2ca1a2(0x215),_0x2ca1a2(0x14b),'Mensagem\x20bloqueada\x20por\x20',_0x2ca1a2(0x1a0),_0x2ca1a2(0x252),_0x2ca1a2(0x254),'Nova\x20mensagem\x20recebida\x20via\x20listener\x20('];return _0x31ac=function(){return _0x1c4d5b;},_0x31ac();}function populateModelSelector(){const _0x230906=_0x5e3d45,_0xd2a733=_0x3eca66;if(!modelSelect)return;modelSelect[_0xd2a733(0x19f)]='',AVAILABLE_MODELS[_0x230906(0x236)](_0x985348=>{const _0x13c17b=_0xd2a733,_0x597a82=document[_0x13c17b(0x204)]('option');_0x597a82[_0x13c17b(0x2b1)]=_0x985348['id'],_0x597a82[_0x13c17b(0x2a8)]=_0x985348[_0x13c17b(0x189)],_0x985348['id']===currentModelId&&(_0x597a82[_0x13c17b(0x186)]=!![]),modelSelect[_0x13c17b(0x199)](_0x597a82);});}const toggleControlsBtn=document[_0x3eca66(0x201)](_0x3eca66(0x216)),controlsContainer=document[_0x3eca66(0x201)](_0x3eca66(0x16f));toggleControlsBtn&&controlsContainer&&(toggleControlsBtn['classList'][_0x3eca66(0x1eb)](_0x5e3d45(0x1e0)),toggleControlsBtn[_0x5e3d45(0x186)](_0x3eca66(0x1cc),()=>{const _0x59516a=_0x5e3d45,_0x217556=_0x3eca66;controlsContainer[_0x59516a(0x148)][_0x217556(0x289)](_0x217556(0x2b2)),toggleControlsBtn[_0x217556(0x1ee)][_0x217556(0x289)](_0x217556(0x2b2));}),document[_0x3eca66(0x296)](_0x5e3d45(0x12f),_0x1c0bdc=>{const _0x27c8f8=_0x5e3d45,_0x2900fe=_0x3eca66;!controlsContainer[_0x2900fe(0x1d8)](_0x1c0bdc[_0x2900fe(0x1b2)])&&!toggleControlsBtn[_0x2900fe(0x1d8)](_0x1c0bdc[_0x2900fe(0x1b2)])&&controlsContainer[_0x2900fe(0x1ee)][_0x27c8f8(0x1da)](_0x2900fe(0x2b2))&&(controlsContainer['classList'][_0x2900fe(0x1eb)](_0x2900fe(0x2b2)),toggleControlsBtn['classList'][_0x2900fe(0x1eb)](_0x2900fe(0x2b2)));})),connectedRef['on'](_0x3eca66(0x2b1),_0x20c871=>{const _0x120cf9=_0x5e3d45,_0x1ac9d7=_0x3eca66,_0x38e42d=_0x20c871[_0x1ac9d7(0x23e)]();console[_0x120cf9(0x131)](_0x1ac9d7(0x25f),_0x38e42d),statusIndicator&&(statusIndicator[_0x120cf9(0x148)][_0x120cf9(0x224)](_0x120cf9(0x255),_0x38e42d),statusIndicator[_0x1ac9d7(0x1ee)][_0x1ac9d7(0x289)](_0x1ac9d7(0x1dd),!_0x38e42d),statusIndicator[_0x1ac9d7(0x1ee)][_0x1ac9d7(0x289)](_0x1ac9d7(0x24f),!_0x38e42d));if(statusText)statusText[_0x1ac9d7(0x2a8)]=_0x38e42d?_0x1ac9d7(0x1c2):_0x1ac9d7(0x280);connectionStatus&&(connectionStatus[_0x1ac9d7(0x19f)]=_0x38e42d?_0x120cf9(0x1b9):_0x1ac9d7(0x20d)),enableChatInput(_0x38e42d),!_0x38e42d?appendSystemMessage(_0x1ac9d7(0x190),_0x1ac9d7(0x1cd)):console[_0x1ac9d7(0x284)]('Reconectado\x20ao\x20Firebase.');}),modelSelect&&modelSelect[_0x3eca66(0x296)](_0x5e3d45(0x13a),_0x35710a=>{const _0xf9ad18=_0x5e3d45,_0x244622=_0x3eca66,_0x1f567b=_0x35710a[_0xf9ad18(0x1ec)][_0x244622(0x2b1)];_0x1f567b!==currentModelId&&(currentModelId=_0x1f567b,console['log'](_0x244622(0x163)+currentModelId),loadChatHistoryAndInit());}),btnGeneralChat&&btnGeneralChat[_0x3eca66(0x296)](_0x3eca66(0x1cc),()=>{const _0x544a9e=_0x3eca66;if(currentChatView!==_0x544a9e(0x233)){currentChatView=_0x544a9e(0x233),targetChatId=null;if(userSearchInput)userSearchInput[_0x544a9e(0x2b1)]='';loadChatHistoryAndInit();}}),btnMyChat&&btnMyChat[_0x5e3d45(0x186)]('click',()=>{const _0x30f488=_0x5e3d45,_0x1bb542=_0x3eca66;if(!USER_DEVICE_ID){appendSystemMessage(_0x30f488(0x274),_0x1bb542(0x1cd)),showWelcomeModal();return;}if(currentChatView!==_0x1bb542(0x29b)){currentChatView=_0x1bb542(0x29b),targetChatId=null;if(userSearchInput)userSearchInput['value']='';loadChatHistoryAndInit();}}),btnOtherChat&&btnOtherChat[_0x5e3d45(0x186)](_0x3eca66(0x1cc),()=>{const _0x9648e2=_0x5e3d45,_0x51d013=_0x3eca66,_0x408c63=userSearchInput[_0x51d013(0x2b1)][_0x51d013(0x28c)]();if(!_0x408c63){appendSystemMessage(_0x51d013(0x23c),_0x9648e2(0x22d)),userSearchInput[_0x51d013(0x1e4)]();return;}currentChatView=_0x51d013(0x198),loadChatHistoryAndInit();}),userSearchInput&&userSearchInput[_0x3eca66(0x296)](_0x5e3d45(0x1f4),_0x50c7e8=>{const _0x331a28=_0x5e3d45,_0x1c571b=_0x3eca66;_0x50c7e8[_0x1c571b(0x287)]===_0x1c571b(0x182)&&(_0x50c7e8[_0x331a28(0x17e)](),btnOtherChat[_0x1c571b(0x1cc)]());});function _0x1b97(_0x4d11cd,_0x4600eb){const _0x3b7513=_0x31ac();return _0x1b97=function(_0x5c8551,_0x462644){_0x5c8551=_0x5c8551-0x15a;let _0x1c8a58=_0x3b7513[_0x5c8551];return _0x1c8a58;},_0x1b97(_0x4d11cd,_0x4600eb);}messageForm&&messageForm[_0x5e3d45(0x186)](_0x5e3d45(0x1d0),async _0x1cfb5d=>{const _0x34c06e=_0x5e3d45,_0x29a4f6=_0x3eca66;_0x1cfb5d[_0x29a4f6(0x220)]();const _0x172aa7=messageInput[_0x34c06e(0x16f)][_0x29a4f6(0x28c)]();if(!_0x172aa7)return;if(currentChatView===_0x34c06e(0x24f)){appendSystemMessage(_0x29a4f6(0x2b8),_0x29a4f6(0x1cd));return;}if(currentChatView!==_0x34c06e(0x226)&&currentChatView!==_0x29a4f6(0x29b)){appendSystemMessage(_0x29a4f6(0x219),_0x29a4f6(0x1cd));return;}if(!USER_DEVICE_ID||!USERNAME){appendSystemMessage(_0x29a4f6(0x1aa),_0x29a4f6(0x1cd)),showWelcomeModal();return;}if(!chat){appendSystemMessage(_0x29a4f6(0x1e6),_0x34c06e(0x215));return;}if(!genAI){appendSystemMessage(_0x34c06e(0x272),_0x29a4f6(0x1cd));return;}let _0x198927=null;const _0x6110b2=sanitizeForFirebasePath(currentModelId);if(!_0x6110b2){appendSystemMessage(_0x34c06e(0x257),_0x29a4f6(0x1cd));return;}if(currentChatView==='general')_0x198927=_0x34c06e(0x250)+_0x6110b2;else currentChatView===_0x29a4f6(0x29b)&&(_0x198927='userChats/'+USER_DEVICE_ID+'/'+_0x6110b2);if(!_0x198927){appendSystemMessage(_0x29a4f6(0x298),_0x34c06e(0x215));return;}enableChatInput(![]);const _0x57ba31={'text':_0x172aa7,'sender':_0x34c06e(0x263),'timestamp':firebase[_0x29a4f6(0x235)][_0x29a4f6(0x1ba)][_0x29a4f6(0x23f)],'deviceId':USER_DEVICE_ID,'username':USERNAME},_0x181f61=database[_0x29a4f6(0x17c)](_0x198927)[_0x29a4f6(0x275)]();try{await _0x181f61[_0x29a4f6(0x1de)](_0x57ba31),console[_0x29a4f6(0x284)](_0x29a4f6(0x25d)+USERNAME+'/'+USER_DEVICE_ID+_0x29a4f6(0x1f1)+_0x198927+':',_0x181f61[_0x29a4f6(0x287)]),messageInput[_0x29a4f6(0x2b1)]='',await getGeminiResponse(_0x172aa7);}catch(_0x1f0b83){console[_0x29a4f6(0x1cd)](_0x29a4f6(0x226),_0x1f0b83),appendSystemMessage(_0x29a4f6(0x1a1),_0x29a4f6(0x1cd)),enableChatInput(!![]);}finally{!messageInput[_0x29a4f6(0x29e)]&&messageInput[_0x29a4f6(0x1e4)]();}}),saveUsernameBtn&&saveUsernameBtn[_0x3eca66(0x296)](_0x3eca66(0x1cc),handleSaveUsername),usernameInput&&usernameInput[_0x3eca66(0x296)](_0x3eca66(0x229),_0x502457=>{const _0x1778dc=_0x3eca66;_0x502457[_0x1778dc(0x287)]===_0x1778dc(0x182)&&handleSaveUsername();}),window[_0x3eca66(0x296)](_0x3eca66(0x1ce),()=>{const _0x5862bb=_0x5e3d45,_0x4685d8=_0x3eca66;console[_0x4685d8(0x284)](_0x4685d8(0x18b)),populateModelSelector(),setupUser();if(messageInput)messageInput[_0x5862bb(0x234)]();console[_0x4685d8(0x284)](_0x4685d8(0x21e));});
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Gemini com Firebase - Mobile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        /* Estilos CSS (mantidos como no original) */
        html, body {
           height: 100%;
           overflow: hidden; /* Evitar scroll do body */
        }
        body {
            display: flex;
            flex-direction: column;
        }
        .main-container-wrapper {
             flex-grow: 1;
             overflow-y: auto; /* Permitir scroll aqui se o conteúdo geral for maior que a tela */
        }
        .message-enter { animation: messageEnter 0.3s ease-out; }
        @keyframes messageEnter { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .typing-indicator::after { content: "..."; animation: typingDots 1.5s infinite; }
        @keyframes typingDots { 0%, 20% { content: "."; } 40% { content: ".."; } 60%, 100% { content: "..."; } }
        .markdown-content p { margin-bottom: 0.5rem; }
        .markdown-content ul, .markdown-content ol { margin-left: 1.25rem; list-style: inside; margin-bottom: 0.5rem; }
        .markdown-content li { margin-bottom: 0.25rem; }
        .markdown-content code { background-color: #e5e7eb; color: #1f2937; padding: 0.2rem 0.4rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.9em; word-break: break-all; }
        .markdown-content pre { background-color: #e5e7eb; border: 1px solid #d1d5db; padding: 0.75rem; border-radius: 0.375rem; overflow-x: auto; margin-bottom: 0.75rem; }
        .markdown-content pre code { background-color: transparent; padding: 0; border-radius: 0; font-size: 0.85em; word-break: normal; }
        .markdown-content strong { font-weight: 600; }
        .markdown-content em { font-style: italic; }
        .markdown-content ul ul, .markdown-content ol ol, .markdown-content ul ol, .markdown-content ol ul { margin-left: 1.25rem; }
        .markdown-content a { color: #2563eb; text-decoration: underline; }
        .markdown-content a:hover { color: #1d4ed8; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

<div class="main-container-wrapper container mx-auto max-w-4xl p-2 sm:p-4 flex flex-col h-full">

    <header class="bg-indigo-600 text-white rounded-lg shadow-md p-3 sm:p-4 mb-3 sm:mb-4 flex items-center justify-between flex-shrink-0">
        <div class="flex items-center space-x-2 sm:space-x-3">
            <i class="fas fa-robot text-xl sm:text-2xl"></i>
            <h1 class="text-lg sm:text-xl font-bold">Chat Gemini</h1>
        </div>
        <div id="user-status" class="flex items-center space-x-2">
            <span id="status-indicator" class="h-3 w-3 rounded-full bg-gray-300"></span>
            <span id="status-text" class="text-xs sm:text-sm">Offline</span>
        </div>
    </header>

    <div class="mb-3 sm:mb-4 bg-white p-3 rounded-lg shadow-md flex-shrink-0">
        <label for="model-select" class="block text-sm font-medium text-gray-700 mb-1">Modelo:</label>
        <select id="model-select" name="model-select" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md border">
            </select>
        <p class="text-xs text-gray-500 mt-1 hidden sm:block">Mudar o modelo limpará o histórico atual na tela e carregará o histórico do modelo selecionado.</p>
    </div>

    <div class="bg-white rounded-lg shadow-md overflow-hidden flex flex-col flex-grow min-h-0">
        <div id="chat-messages" class="p-3 sm:p-4 space-y-4 overflow-y-auto flex-grow min-h-0">
            <div class="text-center text-gray-500 py-10 initial-message">
                <i class="fas fa-comments text-3xl sm:text-4xl mb-2"></i>
                <p class="text-sm sm:text-base">Selecione um modelo e inicie uma conversa</p>
            </div>
            </div>

        <div id="typing-indicator" class="hidden bg-gray-100 px-3 sm:px-4 py-2 text-gray-500 text-xs sm:text-sm flex-shrink-0">
            <span class="typing-indicator">Gemini está digitando</span>
        </div>

        <div class="border-t border-gray-200 p-2 sm:p-4 bg-gray-50 flex-shrink-0">
            <form id="message-form" class="flex space-x-2">
                <input
                    id="message-input"
                    type="text"
                    placeholder="Digite sua mensagem..."
                    class="flex-1 px-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base"
                    autocomplete="off"
                    disabled
                >
                <button
                    type="submit"
                    aria-label="Enviar mensagem"
                    class="bg-indigo-600 text-white px-3 sm:px-4 py-2 rounded-full hover:bg-indigo-700 transition-colors duration-200 flex items-center justify-center"
                    disabled
                >
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                <span id="connection-status">Conectando...</span>
                <span id="message-count">0 msgs</span>
            </div>
        </div>
    </div>

</div>

<script type="module">
    const _0x290e62=_0x27d6;(function(_0x4594f7,_0x4e359b){const _0x2e9a80=_0x27d6,_0x52f7d1=_0x4594f7();while(!![]){try{const _0x3cc898=parseInt(_0x2e9a80(0x113))/0x1+-parseInt(_0x2e9a80(0xa2))/0x2+parseInt(_0x2e9a80(0x12b))/0x3+-parseInt(_0x2e9a80(0x10f))/0x4*(parseInt(_0x2e9a80(0x126))/0x5)+parseInt(_0x2e9a80(0x98))/0x6*(parseInt(_0x2e9a80(0xdf))/0x7)+-parseInt(_0x2e9a80(0xbd))/0x8*(parseInt(_0x2e9a80(0x11a))/0x9)+-parseInt(_0x2e9a80(0xc2))/0xa*(-parseInt(_0x2e9a80(0x110))/0xb);if(_0x3cc898===_0x4e359b)break;else _0x52f7d1['push'](_0x52f7d1['shift']());}catch(_0x2f3eea){_0x52f7d1['push'](_0x52f7d1['shift']());}}}(_0x576e,0xc0b0d));import{GoogleGenerativeAI}from'https://esm.run/@google/generative-ai@latest';const firebaseConfig={'apiKey':_0x290e62(0x104),'authDomain':'gaamini-teste-api.firebaseapp.com','projectId':_0x290e62(0x117),'storageBucket':_0x290e62(0x118),'messagingSenderId':_0x290e62(0xd3),'appId':_0x290e62(0x85),'measurementId':_0x290e62(0x131)},GEMINI_API_KEY=_0x290e62(0x14f),AVAILABLE_MODELS=[{'id':'gemini-1.5-flash-latest','name':_0x290e62(0xee)}];let genAI,chat,currentModelId=AVAILABLE_MODELS[0x0]['id'],currentMessagesRef=null,currentFirebaseListener=null;try{firebase['initializeApp'](firebaseConfig);}catch(_0x97fccf){console[_0x290e62(0xd1)](_0x290e62(0xc0),_0x97fccf),alert(_0x290e62(0xd6));}const database=firebase[_0x290e62(0x14d)](),connectedRef=firebase[_0x290e62(0x14d)]()[_0x290e62(0xcd)](_0x290e62(0xfd));try{if(!GEMINI_API_KEY||GEMINI_API_KEY===_0x290e62(0x95))throw new Error(_0x290e62(0x107));genAI=new GoogleGenerativeAI(GEMINI_API_KEY);}catch(_0x56f7b6){console['error'](_0x290e62(0xa7),_0x56f7b6),alert(_0x290e62(0xf3)+_0x56f7b6['message']+_0x290e62(0xa0));}const messageForm=document[_0x290e62(0xb0)]('message-form'),messageInput=document[_0x290e62(0xb0)](_0x290e62(0x120)),messageSubmitButton=messageForm['querySelector'](_0x290e62(0x9f)),chatMessages=document[_0x290e62(0xb0)](_0x290e62(0x9d)),typingIndicator=document[_0x290e62(0xb0)](_0x290e62(0x139)),statusIndicator=document[_0x290e62(0xb0)](_0x290e62(0x90)),statusText=document['getElementById']('status-text'),connectionStatus=document[_0x290e62(0xb0)]('connection-status'),messageCount=document[_0x290e62(0xb0)]('message-count'),modelSelect=document[_0x290e62(0xb0)](_0x290e62(0xdc));let isGeminiTyping=![],messageCounter=0x0;const escapeHtml=_0x2ed632=>{const _0x4c07ae=_0x290e62;if(!_0x2ed632)return'';return _0x2ed632['replace'](/&/g,'&amp;')['replace'](/</g,_0x4c07ae(0xfe))[_0x4c07ae(0xc7)](/>/g,_0x4c07ae(0xba))[_0x4c07ae(0xc7)](/"/g,_0x4c07ae(0xe2))[_0x4c07ae(0xc7)](/'/g,_0x4c07ae(0xf2));};function _0x27d6(_0x2d7007,_0x63588b){const _0x576ecb=_0x576e();return _0x27d6=function(_0x27d62a,_0x376ae8){_0x27d62a=_0x27d62a-0x82;let _0x2d3430=_0x576ecb[_0x27d62a];return _0x2d3430;},_0x27d6(_0x2d7007,_0x63588b);}function formatMarkdown(_0x18fd9a){const _0x11318e=_0x290e62;if(typeof _0x18fd9a!=='string')return'';let _0x3d1f76=_0x18fd9a[_0x11318e(0xc7)](/&/g,_0x11318e(0x13b))[_0x11318e(0xc7)](/</g,_0x11318e(0xfe))[_0x11318e(0xc7)](/>/g,_0x11318e(0xba));const _0x44a7c7={};let _0x4cf5de=0x0;_0x3d1f76=_0x3d1f76[_0x11318e(0xc7)](/```([\s\S]*?)```/gs,(_0x100979,_0x28bd5c)=>{const _0x5d4d3a=_0x11318e,_0x2ea814='__CODEBLOCK_'+_0x4cf5de++ +'__';return _0x44a7c7[_0x2ea814]=_0x5d4d3a(0xb6)+escapeHtml(_0x28bd5c)+_0x5d4d3a(0x129),_0x2ea814;}),_0x3d1f76=_0x3d1f76[_0x11318e(0xc7)](/\[([^\]]+)\]\(([^)]+)\)/g,'<a\x20href=\x22$2\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22\x20class=\x22text-blue-600\x20hover:underline\x22>$1</a>'),_0x3d1f76=_0x3d1f76[_0x11318e(0xc7)](/\*\*(.*?)\*\*/g,_0x11318e(0xcf)),_0x3d1f76=_0x3d1f76['replace'](/(?<!\*)\*(?!\*)(.*?)(?<!\*)\*(?!\*)/g,_0x11318e(0x135)),_0x3d1f76=_0x3d1f76[_0x11318e(0xc7)](/`([^`]+)`/g,(_0x2a635b,_0x3ef924)=>_0x11318e(0xa5)+escapeHtml(_0x3ef924)+_0x11318e(0xcc));const _0xc1cb7d=_0x3d1f76[_0x11318e(0x12e)]('\x0a');let _0x3912cd=[],_0x2e5fb1=null;_0xc1cb7d[_0x11318e(0x128)](_0xa33ccb=>{const _0x26f74a=_0x11318e,_0x4dde1e=_0xa33ccb['match'](/^(\s*)([-*+])\s+(.*)/),_0x487311=_0xa33ccb['match'](/^(\s*)(\d+\.)\s+(.*)/);if(_0x4dde1e){if(_0x2e5fb1!=='ul'){if(_0x2e5fb1)_0x3912cd[_0x26f74a(0x83)]('</'+_0x2e5fb1+'>');_0x3912cd['push']('<ul>'),_0x2e5fb1='ul';}_0x3912cd[_0x26f74a(0x83)](_0x26f74a(0xd8)+_0x4dde1e[0x3]+_0x26f74a(0xe9));}else{if(_0x487311){if(_0x2e5fb1!=='ol'){if(_0x2e5fb1)_0x3912cd[_0x26f74a(0x83)]('</'+_0x2e5fb1+'>');_0x3912cd[_0x26f74a(0x83)](_0x26f74a(0xe5)),_0x2e5fb1='ol';}_0x3912cd[_0x26f74a(0x83)](_0x26f74a(0xd8)+_0x487311[0x3]+_0x26f74a(0xe9));}else _0x2e5fb1&&(_0x3912cd['push']('</'+_0x2e5fb1+'>'),_0x2e5fb1=null),_0x3912cd['push'](_0xa33ccb);}});_0x2e5fb1&&_0x3912cd[_0x11318e(0x83)]('</'+_0x2e5fb1+'>');_0x3d1f76=_0x3912cd[_0x11318e(0xd5)]('\x0a');for(const _0x102383 in _0x44a7c7){_0x3d1f76=_0x3d1f76[_0x11318e(0xc7)](_0x102383,()=>_0x44a7c7[_0x102383]);}const _0x434514=_0x3d1f76[_0x11318e(0x12e)](/\n\s*\n/)['map'](_0x464032=>_0x464032['trim']())[_0x11318e(0xa4)](_0x6aa934=>_0x6aa934)[_0x11318e(0xca)](_0x4453df=>{const _0x135de2=_0x11318e;if(_0x4453df[_0x135de2(0xf1)](/^<(ul|ol|pre|h[1-6])/))return _0x4453df;return _0x135de2(0xce)+_0x4453df[_0x135de2(0xc7)](/\n/g,_0x135de2(0xbb))+_0x135de2(0x108);})['join']('');return _0x434514;}function formatTime(_0x27511a){const _0x28ea6a=_0x290e62;if(!_0x27511a||typeof _0x27511a!==_0x28ea6a(0xdd))return'';try{const _0x4d3ba4=new Date(_0x27511a);if(isNaN(_0x4d3ba4[_0x28ea6a(0x8b)]()))return'';const _0x5e7198=new Date(),_0xe77c09=_0x4d3ba4[_0x28ea6a(0xa9)]()===_0x5e7198[_0x28ea6a(0xa9)]()&&_0x4d3ba4['getMonth']()===_0x5e7198['getMonth']()&&_0x4d3ba4[_0x28ea6a(0x9c)]()===_0x5e7198[_0x28ea6a(0x9c)]();return _0xe77c09?_0x4d3ba4['toLocaleTimeString']([],{'hour':_0x28ea6a(0xe1),'minute':_0x28ea6a(0xe1)}):_0x4d3ba4['toLocaleTimeString']([],{'day':_0x28ea6a(0xe1),'month':_0x28ea6a(0xe1),'year':'2-digit','hour':_0x28ea6a(0xe1),'minute':'2-digit'});}catch(_0x3e602b){return console[_0x28ea6a(0xd1)](_0x28ea6a(0x89),_0x3e602b,'Timestamp:',_0x27511a),'';}}function scrollToBottom(){setTimeout(()=>{const _0x5420b1=_0x27d6;chatMessages[_0x5420b1(0x140)]=chatMessages['scrollHeight'];},0x64);}function updateMessageCountDisplay(){const _0x2739f4=_0x290e62;let _0x59e498=currentModelId[_0x2739f4(0xc7)](_0x2739f4(0xc4),'')[_0x2739f4(0xc7)](_0x2739f4(0x12f),'g1.5-')[_0x2739f4(0xc7)](_0x2739f4(0x124),'g-');messageCount[_0x2739f4(0x86)]=messageCounter+'\x20msgs\x20('+_0x59e498+')';}function sanitizeForFirebasePath(_0x31ca7d){return _0x31ca7d['replace'](/[.#$[\]/]/g,'_');}function getModelMessagesPath(_0x50b322){return'messages-'+sanitizeForFirebasePath(_0x50b322);}async function initGeminiChat(_0x4e28c8=[],_0x589e75){const _0x1a4768=_0x290e62;chat=null;if(!genAI)return console[_0x1a4768(0xd1)](_0x1a4768(0xc1)),appendSystemMessage(_0x1a4768(0x106)),![];if(!_0x589e75)return console[_0x1a4768(0xd1)](_0x1a4768(0x12a)),appendSystemMessage('Erro:\x20ID\x20do\x20modelo\x20não\x20especificado.'),![];appendSystemMessage(_0x1a4768(0xa6)+_0x589e75+_0x1a4768(0x96)),enableChatInput(![]);try{console[_0x1a4768(0x141)](_0x1a4768(0xff)+_0x589e75);const _0x36aa43=genAI[_0x1a4768(0xd4)]({'model':_0x589e75});return chat=_0x36aa43[_0x1a4768(0xe8)]({'history':_0x4e28c8,'generationConfig':{'maxOutputTokens':0x7d0}}),console[_0x1a4768(0x141)](_0x1a4768(0x123)+_0x589e75+_0x1a4768(0xed),_0x4e28c8[_0x1a4768(0x10e)]),appendSystemMessage(_0x1a4768(0xf0)+_0x589e75+_0x1a4768(0x8d)),enableChatInput(!![]),!![];}catch(_0x349d23){console[_0x1a4768(0xd1)](_0x1a4768(0xad)+_0x589e75+':',_0x349d23);let _0x173137=_0x1a4768(0x147)+_0x589e75+'.';if(_0x349d23[_0x1a4768(0x109)]&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)]('API\x20key\x20not\x20valid'))_0x173137=_0x1a4768(0x10a)+_0x589e75+_0x1a4768(0x121);else{if(_0x349d23['message']&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)](_0x1a4768(0x111)))_0x173137='Falha\x20('+_0x589e75+'):\x20Erro\x20de\x20rede\x20ao\x20conectar\x20com\x20a\x20API\x20Gemini.';else{if(_0x349d23[_0x1a4768(0x109)]&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)](_0x1a4768(0x13e)))_0x173137=_0x1a4768(0x10a)+_0x589e75+_0x1a4768(0x12d);else{if(_0x349d23[_0x1a4768(0x109)]&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)](_0x1a4768(0xaa)))_0x173137=_0x1a4768(0x10a)+_0x589e75+_0x1a4768(0xb4);else _0x349d23[_0x1a4768(0x109)]&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)](_0x1a4768(0x11b))||_0x349d23[_0x1a4768(0x109)]&&_0x349d23[_0x1a4768(0x109)][_0x1a4768(0x132)](_0x1a4768(0xb5))?_0x173137=_0x1a4768(0x10a)+_0x589e75+'):\x20Cota\x20da\x20API\x20excedida.':_0x173137='Falha\x20('+_0x589e75+_0x1a4768(0x150)+(_0x349d23[_0x1a4768(0x109)]||_0x1a4768(0x13a));}}}return appendSystemMessage(_0x173137),enableChatInput(![]),![];}}function appendMessage(_0x106b8a,_0x3a7127=!![],_0x2457fc=null){const _0x7a8a69=_0x290e62;if(!_0x106b8a||typeof _0x106b8a[_0x7a8a69(0xbc)]!=='string')return;const _0x4380eb=chatMessages['querySelector'](_0x7a8a69(0xaf));if(_0x4380eb)_0x4380eb[_0x7a8a69(0x125)]();const _0x4ad2fa=document['createElement'](_0x7a8a69(0x11d));_0x3a7127&&_0x4ad2fa[_0x7a8a69(0x127)][_0x7a8a69(0x10d)](_0x7a8a69(0x142));_0x2457fc&&(_0x4ad2fa['id']='msg-'+_0x2457fc);const _0xa1a9ef=_0x106b8a[_0x7a8a69(0xbc)],_0x300246=_0x106b8a[_0x7a8a69(0x87)]?formatTime(_0x106b8a[_0x7a8a69(0x87)]):'';if(_0x106b8a['sender']===_0x7a8a69(0xa8))_0x4ad2fa['innerHTML']=_0x7a8a69(0xf4)+escapeHtml(_0xa1a9ef)+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-indigo-200\x20mt-1\x20text-right\x22>'+_0x300246+_0x7a8a69(0xc3);else{const _0x9eaaae=formatMarkdown(_0xa1a9ef),_0x2851eb=_0xa1a9ef[_0x7a8a69(0x99)](_0x7a8a69(0xb9))||_0xa1a9ef['startsWith']('Erro')||_0xa1a9ef['startsWith'](_0x7a8a69(0x14c))||_0xa1a9ef[_0x7a8a69(0x99)]('Bloqueado'),_0x3a2273=_0x2851eb?_0x7a8a69(0xcb):_0x7a8a69(0x100);_0x4ad2fa['innerHTML']=_0x7a8a69(0x136)+_0x3a2273+'\x20rounded-r-lg\x20rounded-tl-lg\x20px-3\x20py-2\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x20text-sm\x20sm:text-base\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22markdown-content\x22>'+_0x9eaaae+_0x7a8a69(0x101)+_0x300246+_0x7a8a69(0xc3);}chatMessages['appendChild'](_0x4ad2fa),scrollToBottom();}function appendSystemMessage(_0x31427d){const _0x58f7d1=_0x290e62,_0x1dd742=document[_0x58f7d1(0xde)](_0x58f7d1(0x11d));_0x1dd742[_0x58f7d1(0x127)][_0x58f7d1(0x10d)]('message-enter'),_0x1dd742[_0x58f7d1(0x91)]=_0x58f7d1(0x11c)+escapeHtml(_0x31427d)+_0x58f7d1(0x93),chatMessages[_0x58f7d1(0xe3)](_0x1dd742),scrollToBottom();}async function getGeminiResponse(_0x3d5f87){const _0x4157c9=_0x290e62;if(!chat){console['error'](_0x4157c9(0x84)),appendSystemMessage('Desculpe,\x20o\x20chat\x20não\x20está\x20pronto.\x20Tente\x20recarregar.'),enableChatInput(![]);return;}if(!currentMessagesRef){console[_0x4157c9(0xd1)](_0x4157c9(0xbf)),appendSystemMessage(_0x4157c9(0xc8)),enableChatInput(!!chat);return;}isGeminiTyping=!![],typingIndicator[_0x4157c9(0x127)][_0x4157c9(0x125)]('hidden'),scrollToBottom();try{console['log']('Enviando\x20para\x20Gemini\x20('+currentModelId+'):',_0x3d5f87);const _0x802c91=await chat['sendMessage'](_0x3d5f87),_0x2cb524=await _0x802c91[_0x4157c9(0x9e)],_0x30b65b=_0x2cb524[_0x4157c9(0xbc)]();console['log'](_0x4157c9(0x14b)+currentModelId+'):',_0x30b65b);const _0x398678=currentMessagesRef[_0x4157c9(0x83)]();await _0x398678[_0x4157c9(0x88)]({'text':_0x30b65b,'sender':_0x4157c9(0x8f),'timestamp':firebase[_0x4157c9(0x14d)]['ServerValue'][_0x4157c9(0xac)]});}catch(_0x5eee1b){console[_0x4157c9(0xd1)](_0x4157c9(0xa1)+currentModelId+'):',_0x5eee1b);let _0x2ad8c0=_0x4157c9(0xeb)+currentModelId+'.';if(_0x5eee1b[_0x4157c9(0x109)]&&_0x5eee1b[_0x4157c9(0x109)][_0x4157c9(0x132)](_0x4157c9(0xfb)))_0x2ad8c0=_0x4157c9(0xfc)+currentModelId+_0x4157c9(0x10c);else{if(_0x5eee1b[_0x4157c9(0x9e)]&&typeof _0x5eee1b[_0x4157c9(0x9e)][_0x4157c9(0x144)]===_0x4157c9(0xb7)&&_0x5eee1b[_0x4157c9(0x9e)][_0x4157c9(0x144)]!==null&&_0x5eee1b[_0x4157c9(0x9e)]['promptFeedback'][_0x4157c9(0xea)])_0x2ad8c0=_0x4157c9(0x82)+currentModelId+_0x4157c9(0x150)+_0x5eee1b[_0x4157c9(0x9e)][_0x4157c9(0x144)][_0x4157c9(0xea)]+'.',_0x5eee1b[_0x4157c9(0x9e)][_0x4157c9(0x144)][_0x4157c9(0x8e)]&&console[_0x4157c9(0x11f)]('Safety\x20Ratings:',_0x5eee1b['response'][_0x4157c9(0x144)][_0x4157c9(0x8e)]);else{if(_0x5eee1b[_0x4157c9(0x109)]&&_0x5eee1b[_0x4157c9(0x109)]['includes']('fetch')||_0x5eee1b[_0x4157c9(0x109)]['includes'](_0x4157c9(0xbe)))_0x2ad8c0=_0x4157c9(0x149)+currentModelId+_0x4157c9(0xd9);else{if(_0x5eee1b[_0x4157c9(0x109)]&&_0x5eee1b['message'][_0x4157c9(0x132)](_0x4157c9(0xda)))_0x2ad8c0=_0x4157c9(0xfc)+currentModelId+_0x4157c9(0x102);else _0x5eee1b[_0x4157c9(0x109)]&&(_0x2ad8c0=_0x4157c9(0xa3)+currentModelId+_0x4157c9(0x150)+_0x5eee1b['message']);}}}const _0x475495=currentMessagesRef[_0x4157c9(0x83)]();await _0x475495[_0x4157c9(0x88)]({'text':_0x2ad8c0,'sender':_0x4157c9(0x8f),'timestamp':firebase[_0x4157c9(0x14d)][_0x4157c9(0xb2)]['TIMESTAMP']});}finally{isGeminiTyping=![],typingIndicator['classList'][_0x4157c9(0x10d)](_0x4157c9(0x130)),enableChatInput(!!chat);}}function enableChatInput(_0x254a41){const _0x49410b=_0x290e62;messageInput[_0x49410b(0xe0)]=!_0x254a41,messageSubmitButton[_0x49410b(0xe0)]=!_0x254a41,messageInput[_0x49410b(0x127)][_0x49410b(0xc6)](_0x49410b(0xf8),!_0x254a41),messageSubmitButton[_0x49410b(0x127)][_0x49410b(0xc6)]('opacity-50',!_0x254a41),messageSubmitButton[_0x49410b(0x127)]['toggle'](_0x49410b(0xec),!_0x254a41);}async function loadChatHistoryAndInit(_0x298d86){const _0x4ae8b0=_0x290e62;console['log'](_0x4ae8b0(0xc9)+_0x298d86),enableChatInput(![]),chatMessages[_0x4ae8b0(0x91)]=_0x4ae8b0(0xab),messageCounter=0x0,updateMessageCountDisplay();currentMessagesRef&&currentFirebaseListener&&(console[_0x4ae8b0(0x141)](_0x4ae8b0(0x134)),currentMessagesRef[_0x4ae8b0(0x146)](_0x4ae8b0(0x12c),currentFirebaseListener),currentFirebaseListener=null,currentMessagesRef=null);const _0x36f6b0=getModelMessagesPath(_0x298d86);currentMessagesRef=database[_0x4ae8b0(0xcd)](_0x36f6b0),console['log'](_0x4ae8b0(0x10b)+_0x36f6b0);try{const _0x3e52f8=await currentMessagesRef[_0x4ae8b0(0x114)](_0x4ae8b0(0x87))['limitToLast'](0x32)[_0x4ae8b0(0x8c)](_0x4ae8b0(0xf9)),_0x4ed4da=_0x3e52f8[_0x4ae8b0(0xf5)](),_0x25baf8=[];let _0x14c3b=0x0;chatMessages[_0x4ae8b0(0x91)]='';if(_0x4ed4da){console[_0x4ae8b0(0x141)](_0x4ae8b0(0x94)+_0x298d86+_0x4ae8b0(0x13f)+Object[_0x4ae8b0(0x103)](_0x4ed4da)[_0x4ae8b0(0x10e)]+_0x4ae8b0(0x115));const _0x1eff75=Object[_0x4ae8b0(0x103)](_0x4ed4da);_0x1eff75[_0x4ae8b0(0xb8)]((_0x2d585d,_0x3ab10c)=>_0x4ed4da[_0x2d585d][_0x4ae8b0(0x87)]-_0x4ed4da[_0x3ab10c][_0x4ae8b0(0x87)]),_0x1eff75['forEach'](_0x16e75d=>{const _0x4d0e4f=_0x4ae8b0;messageCounter++;const _0x92113b=_0x4ed4da[_0x16e75d];if(_0x92113b&&_0x92113b['timestamp']){appendMessage(_0x92113b,![],_0x16e75d);const _0x82e98=_0x92113b[_0x4d0e4f(0xdb)]===_0x4d0e4f(0xa8)?_0x4d0e4f(0xa8):_0x4d0e4f(0xe4),_0x6f33aa=typeof _0x92113b[_0x4d0e4f(0xbc)]==='string'?_0x92113b['text']:'';_0x6f33aa&&!(_0x6f33aa[_0x4d0e4f(0x99)]('Desculpe,')||_0x6f33aa['startsWith'](_0x4d0e4f(0xef))||_0x6f33aa[_0x4d0e4f(0x99)](_0x4d0e4f(0x14c))||_0x6f33aa[_0x4d0e4f(0x99)](_0x4d0e4f(0xd2)))&&_0x25baf8[_0x4d0e4f(0x83)]({'role':_0x82e98,'parts':[{'text':_0x6f33aa}]}),_0x14c3b=Math[_0x4d0e4f(0xf6)](_0x14c3b,_0x92113b[_0x4d0e4f(0x87)]);}else console[_0x4d0e4f(0x11f)]('Mensagem\x20inválida\x20ou\x20sem\x20timestamp\x20encontrada\x20no\x20histórico:',_0x16e75d,_0x92113b);});}else console[_0x4ae8b0(0x141)](_0x4ae8b0(0x13c)+_0x298d86+'.'),chatMessages[_0x4ae8b0(0x91)]='<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x20initial-message\x22><i\x20class=\x22fas\x20fa-comments\x20text-3xl\x20sm:text-4xl\x20mb-2\x22></i><p\x20class=\x22text-sm\x20sm:text-base\x22>Nenhuma\x20mensagem\x20para\x20'+_0x298d86+'.\x20Comece\x20a\x20conversar!</p></div>';updateMessageCountDisplay(),scrollToBottom();const _0x4f5bda=await initGeminiChat(_0x25baf8,_0x298d86);if(_0x4f5bda&&currentMessagesRef){currentFirebaseListener=_0x4e5781=>{const _0x39948a=_0x4ae8b0,_0x377e22=_0x4e5781[_0x39948a(0xf5)](),_0x27b3c7=_0x4e5781[_0x39948a(0x148)];if(_0x377e22&&!document[_0x39948a(0xb0)](_0x39948a(0xe7)+_0x27b3c7)){console[_0x39948a(0x141)](_0x39948a(0x97)+_0x298d86+'):',_0x27b3c7),messageCounter++,appendMessage(_0x377e22,!![],_0x27b3c7),updateMessageCountDisplay();if(_0x377e22[_0x39948a(0xdb)]==='gemini'&&isGeminiTyping){}}};const _0x5ce546=_0x14c3b>0x0?_0x14c3b+0x1:Date[_0x4ae8b0(0x9a)]();currentMessagesRef['orderByChild'](_0x4ae8b0(0x87))[_0x4ae8b0(0x122)](_0x5ce546)['on'](_0x4ae8b0(0x12c),currentFirebaseListener),console[_0x4ae8b0(0x141)]('Listener\x20Firebase\x20anexado\x20para\x20novas\x20mensagens\x20em\x20'+_0x36f6b0+_0x4ae8b0(0x92)+new Date(_0x5ce546)[_0x4ae8b0(0xc5)]());}else console[_0x4ae8b0(0x11f)](_0x4ae8b0(0x11e)),!_0x4f5bda&&appendSystemMessage(_0x4ae8b0(0x119)),enableChatInput(![]);}catch(_0x13e95e){console[_0x4ae8b0(0xd1)](_0x4ae8b0(0xd0)+_0x36f6b0+':',_0x13e95e),appendSystemMessage(_0x4ae8b0(0x143)+_0x298d86+_0x4ae8b0(0x105)),chatMessages[_0x4ae8b0(0x91)]='<div\x20class=\x22text-center\x20text-red-500\x20py-10\x22><p>Erro\x20ao\x20carregar\x20dados!</p></div>',enableChatInput(![]);}}function _0x576e(){const _0x4f1657=['createElement','1583981WOvSXT','disabled','2-digit','&quot;','appendChild','model','<ol>','name','msg-','startChat','</li>','blockReason','Desculpe,\x20ocorreu\x20um\x20erro\x20ao\x20processar\x20sua\x20solicitação\x20com\x20','cursor-not-allowed',')\x20inicializado\x20com\x20histórico:','Gemini\x201.5\x20Flash','Erro','Chat\x20com\x20','match','&#039;','Erro\x20Fatal:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-end\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-indigo-600\x20text-white\x20rounded-l-lg\x20rounded-tr-lg\x20px-3\x20py-2\x20max-w-[80%]\x20sm:max-w-[75%]\x20break-words\x20text-sm\x20sm:text-base\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','val','max','target','bg-gray-100','value','Erro\x20ao\x20enviar\x20sua\x20mensagem.\x20Tente\x20novamente.','RESOURCE_EXHAUSTED','Erro\x20(','.info/connected','&lt;','Tentando\x20inicializar\x20com\x20modelo:\x20','bg-gray-100\x20sm:bg-gray-200\x20text-gray-800','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-1\x22>','):\x20Chave\x20da\x20API\x20Gemini\x20inválida.','keys','AIzaSyBL7oI8tr3rseMyQW6ouPVwbfZKGUfwJ1s','.\x20Tente\x20recarregar.','Erro:\x20Falha\x20ao\x20inicializar\x20o\x20SDK\x20Gemini\x20AI.','Chave\x20da\x20API\x20Gemini\x20não\x20configurada.','</p>','message','Falha\x20(','Nova\x20referência\x20Firebase:\x20','):\x20A\x20cota\x20da\x20API\x20foi\x20excedida.','add','length','4vvzJqt','34178474JpHdjz','fetch','change','68810yxEDkP','orderByChild','\x20mensagens.','Conectado\x20ao\x20Firebase','gaamini-teste-api','gaamini-teste-api.appspot.com','O\x20chat\x20não\x20pôde\x20ser\x20iniciado.\x20O\x20envio\x20de\x20mensagens\x20está\x20desabilitado.','27XlcTSM','Quota','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-center\x20my-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-yellow-100\x20text-yellow-800\x20rounded-xl\x20px-3\x20py-2\x20max-w-[90%]\x20sm:max-w-md\x20lg:max-w-lg\x20text-xs\x20sm:text-sm\x20text-center\x20system-message\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','div','Inicialização\x20do\x20chat\x20falhou\x20ou\x20referência\x20do\x20DB\x20inválida,\x20listener\x20de\x20novas\x20mensagens\x20não\x20anexado.','warn','message-input','):\x20Chave\x20API\x20inválida.\x20Verifique\x20a\x20chave\x20no\x20código.','startAt','Chat\x20Gemini\x20(','gemini-','remove','1047445RckiUx','classList','forEach','</code></pre>','Model\x20ID\x20não\x20fornecido\x20para\x20initGeminiChat','1388652jIsDCl','child_added','):\x20Modelo\x20não\x20encontrado\x20(404).\x20Verifique\x20o\x20ID\x20do\x20modelo.','split','gemini-1.5-','hidden','G-VD9JE84V5N','includes','DOMContentLoaded','Desanexando\x20listener\x20Firebase\x20anterior.','<em>$1</em>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20justify-start\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22','selected','focus','typing-indicator','Erro\x20desconhecido','&amp;','Nenhum\x20histórico\x20encontrado\x20para\x20','Erro:\x20Referência\x20do\x20banco\x20de\x20dados\x20não\x20encontrada.','404',',\x20processando\x20','scrollTop','log','message-enter','Erro\x20grave\x20ao\x20carregar\x20histórico\x20para\x20','promptFeedback','Conexão\x20perdida.\x20Tentando\x20reconectar...','off','Falha\x20ao\x20inicializar\x20chat\x20com\x20','key','Erro\x20de\x20rede\x20ao\x20comunicar\x20com\x20Gemini\x20(','Offline','Resposta\x20Gemini\x20(','Falha','database','text-red-600','AIzaSyDF5wOFJPEuhrlD9s0m1ZjYLg-IIPWsCRg','):\x20','Bloqueado\x20(','push','getGeminiResponse\x20chamado\x20mas\x20o\x20chat\x20não\x20está\x20inicializado.','1:1080485760423:web:8e4befd62dbf6106ff7a82','textContent','timestamp','set','Erro\x20ao\x20formatar\x20hora:','Desconectado\x20do\x20Firebase','getTime','once','\x20pronto.','safetyRatings','gemini','status-indicator','innerHTML','\x20a\x20partir\x20de\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Histórico\x20encontrado\x20para\x20','YOUR_GEMINI_API_KEY','...','Nova\x20mensagem\x20recebida\x20via\x20listener\x20(','6SsFeij','startsWith','now','option','getFullYear','chat-messages','response','button[type=\x22submit\x22]','.\x20Verifique\x20a\x20Chave\x20da\x20API\x20Gemini\x20e\x20a\x20conexão.','Erro\x20ao\x20obter\x20resposta\x20do\x20Gemini\x20(','2669368RLojZU','Erro\x20Gemini\x20(','filter','<code>','Inicializando\x20chat\x20com\x20','Erro\x20Fatal\x20ao\x20inicializar\x20GoogleGenerativeAI:','user','getDate','400','<div\x20class=\x22text-center\x20text-gray-500\x20py-10\x22><p>Carregando\x20histórico...</p></div>','TIMESTAMP','Erro\x20inicializando\x20o\x20chat\x20Gemini\x20com\x20','addEventListener','.initial-message','getElementById','Firebase\x20Connection\x20Status:','ServerValue','preventDefault','):\x20Requisição\x20inválida\x20(400).\x20Pode\x20ser\x20problema\x20no\x20histórico\x20ou\x20parâmetros.','quota','<pre><code>','object','sort','Desculpe,','&gt;','<br>','text','4084472CYcGGk','Network\x20Error','getGeminiResponse:\x20currentMessagesRef\x20não\x20definida.','Erro\x20ao\x20inicializar\x20Firebase:','SDK\x20Gemini\x20AI\x20não\x20inicializado.','10rWxMDE','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','-latest','toISOString','toggle','replace','Erro\x20interno:\x20Referência\x20do\x20banco\x20de\x20dados\x20não\x20definida.','Carregando\x20histórico\x20e\x20inicializando\x20para:\x20','map','bg-red-100\x20text-red-800','</code>','ref','<p>','<strong>$1</strong>','Erro\x20crítico\x20ao\x20carregar\x20histórico\x20do\x20Firebase\x20para\x20','error','Bloqueado','1080485760423','getGenerativeModel','join','Erro\x20crítico:\x20Falha\x20ao\x20conectar\x20com\x20o\x20Firebase.\x20Verifique\x20a\x20configuração.','text-green-600','<li>',').\x20Verifique\x20sua\x20conexão.','API\x20key\x20not\x20valid','sender','model-select','number'];_0x576e=function(){return _0x4f1657;};return _0x576e();}function populateModelSelector(){AVAILABLE_MODELS['forEach'](_0x11ae00=>{const _0x3c4e9f=_0x27d6,_0x3470da=document[_0x3c4e9f(0xde)](_0x3c4e9f(0x9b));_0x3470da[_0x3c4e9f(0xf9)]=_0x11ae00['id'],_0x3470da['textContent']=_0x11ae00[_0x3c4e9f(0xe6)],_0x11ae00['id']===currentModelId&&(_0x3470da[_0x3c4e9f(0x137)]=!![]),modelSelect[_0x3c4e9f(0xe3)](_0x3470da);});}connectedRef['on'](_0x290e62(0xf9),_0x1d4754=>{const _0x1b15f3=_0x290e62,_0xbbb321=_0x1d4754[_0x1b15f3(0xf5)]();console[_0x1b15f3(0x141)](_0x1b15f3(0xb1),_0xbbb321),statusIndicator[_0x1b15f3(0x127)]['toggle']('bg-green-500',_0xbbb321),statusIndicator['classList']['toggle']('bg-red-500',!_0xbbb321),statusIndicator['classList'][_0x1b15f3(0xc6)]('animate-pulse',!_0xbbb321),statusText[_0x1b15f3(0x86)]=_0xbbb321?'Online':_0x1b15f3(0x14a),connectionStatus[_0x1b15f3(0x86)]=_0xbbb321?_0x1b15f3(0x116):_0x1b15f3(0x8a),connectionStatus[_0x1b15f3(0x127)][_0x1b15f3(0xc6)](_0x1b15f3(0xd7),_0xbbb321),connectionStatus[_0x1b15f3(0x127)][_0x1b15f3(0xc6)](_0x1b15f3(0x14e),!_0xbbb321),enableChatInput(_0xbbb321&&!!chat),!_0xbbb321&&appendSystemMessage(_0x1b15f3(0x145));}),modelSelect[_0x290e62(0xae)](_0x290e62(0x112),_0x5c4cf7=>{const _0x295e62=_0x290e62,_0x59be8b=_0x5c4cf7[_0x295e62(0xf7)][_0x295e62(0xf9)];_0x59be8b!==currentModelId&&(console['log']('Modelo\x20alterado\x20para:\x20'+_0x59be8b),currentModelId=_0x59be8b,loadChatHistoryAndInit(currentModelId));}),messageForm[_0x290e62(0xae)]('submit',async _0x1bd6a1=>{const _0x2ab237=_0x290e62;_0x1bd6a1[_0x2ab237(0xb3)]();const _0x44fb4c=messageInput[_0x2ab237(0xf9)]['trim']();if(_0x44fb4c&&currentMessagesRef&&chat){enableChatInput(![]);const _0x1025c4={'text':_0x44fb4c,'sender':_0x2ab237(0xa8),'timestamp':firebase['database'][_0x2ab237(0xb2)][_0x2ab237(0xac)]},_0x25e116=currentMessagesRef[_0x2ab237(0x83)]();try{await _0x25e116['set'](_0x1025c4),console[_0x2ab237(0x141)]('Mensagem\x20do\x20usuário\x20salva\x20no\x20Firebase:',_0x25e116['key']),messageInput[_0x2ab237(0xf9)]='',await getGeminiResponse(_0x44fb4c);}catch(_0x5b117e){console[_0x2ab237(0xd1)]('Erro\x20ao\x20salvar\x20mensagem\x20do\x20usuário\x20ou\x20obter\x20resposta:',_0x5b117e),appendSystemMessage(_0x2ab237(0xfa)),enableChatInput(!!chat);}if(chat)messageInput[_0x2ab237(0x138)]();}else{if(!chat)appendSystemMessage('O\x20chat\x20não\x20está\x20pronto\x20ou\x20falhou\x20ao\x20inicializar.');else!currentMessagesRef&&appendSystemMessage(_0x2ab237(0x13d));}}),window['addEventListener'](_0x290e62(0x133),()=>{const _0x38144f=_0x290e62;console[_0x38144f(0x141)]('DOM\x20Carregado.\x20Iniciando\x20aplicação.'),populateModelSelector(),loadChatHistoryAndInit(currentModelId),messageInput[_0x38144f(0x138)]();});
</script>

</body>
</html>